{"version":3,"file":"federation-cli.js","sourceRoot":"","sources":["../../src/cli/federation-cli.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n/**\n * Federation Hub CLI - Manage ephemeral agent federation\n * Supports hub server, agent lifecycle, stats, and monitoring\n */\n\nimport { existsSync } from 'fs';\nimport { resolve, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport { spawn, ChildProcess } from 'child_process';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n\nexport interface FederationHubConfig {\n  port?: number;\n  dbPath?: string;\n  maxAgents?: number;\n  syncInterval?: number;\n  verbose?: boolean;\n}\n\nexport interface AgentConfig {\n  agentId?: string;\n  tenantId?: string;\n  lifetime?: number;\n  hubEndpoint?: string;\n  agentType?: string;\n}\n\n/**\n * Federation Hub CLI Manager\n */\nexport class FederationCLI {\n  private hubProcess: ChildProcess | null = null;\n\n  /**\n   * Start federation hub server\n   */\n  async startHub(config: FederationHubConfig = {}): Promise<void> {\n    const port = config.port || parseInt(process.env.FEDERATION_HUB_PORT || '8443');\n    const dbPath = config.dbPath || process.env.FEDERATION_DB_PATH || ':memory:';\n    const maxAgents = config.maxAgents || parseInt(process.env.FEDERATION_MAX_AGENTS || '1000');\n\n    console.log('\\nüåê Starting Federation Hub Server...');\n    console.log('‚ïê'.repeat(60));\n    console.log(`üìç Port: ${port}`);\n    console.log(`üíæ Database: ${dbPath === ':memory:' ? 'In-Memory' : dbPath}`);\n    console.log(`üë• Max Agents: ${maxAgents}`);\n    console.log(`üîí Protocol: WebSocket (QUIC support planned)`);\n    console.log('');\n\n    // Start hub server\n    const hubPath = resolve(__dirname, '../federation/run-hub.js');\n\n    // Check if compiled hub exists\n    if (!existsSync(hubPath)) {\n      console.error(`‚ùå Error: Hub server not found at ${hubPath}`);\n      console.error('   Please build the project first: npm run build');\n      process.exit(1);\n    }\n\n    this.hubProcess = spawn('node', [hubPath], {\n      stdio: 'inherit',\n      env: {\n        ...process.env,\n        FEDERATION_HUB_PORT: port.toString(),\n        FEDERATION_DB_PATH: dbPath,\n        FEDERATION_MAX_AGENTS: maxAgents.toString(),\n        DEBUG: config.verbose ? 'federation:*' : undefined\n      }\n    });\n\n    this.hubProcess.on('exit', (code) => {\n      console.log(`\\nüëã Hub server stopped (exit code: ${code})`);\n      process.exit(code || 0);\n    });\n\n    // Handle signals\n    process.on('SIGINT', () => {\n      console.log('\\n\\n‚è∏Ô∏è  Shutting down hub server...');\n      if (this.hubProcess) {\n        this.hubProcess.kill('SIGINT');\n      }\n    });\n\n    process.on('SIGTERM', () => {\n      if (this.hubProcess) {\n        this.hubProcess.kill('SIGTERM');\n      }\n    });\n\n    console.log('‚úÖ Hub server started successfully!');\n    console.log('\\nAgent Connection:');\n    console.log(`  Endpoint: ws://localhost:${port}`);\n    console.log(`  Protocol: WebSocket (HTTP/2 upgrade)`);\n    console.log('\\nUse Ctrl+C to stop the server\\n');\n\n    // Keep alive\n    await new Promise(() => {});\n  }\n\n  /**\n   * Spawn ephemeral agent\n   */\n  async spawnAgent(config: AgentConfig = {}): Promise<void> {\n    const agentId = config.agentId || `agent-${Date.now()}`;\n    const tenantId = config.tenantId || process.env.FEDERATION_TENANT_ID || 'default';\n    const lifetime = config.lifetime || parseInt(process.env.AGENT_LIFETIME || '300'); // 5 minutes default\n    const hubEndpoint = config.hubEndpoint || process.env.FEDERATION_HUB_ENDPOINT || 'ws://localhost:8443';\n    const agentType = config.agentType || 'worker';\n\n    console.log('\\nü§ñ Spawning Ephemeral Agent...');\n    console.log('‚ïê'.repeat(60));\n    console.log(`üÜî Agent ID: ${agentId}`);\n    console.log(`üè¢ Tenant: ${tenantId}`);\n    console.log(`‚è±Ô∏è  Lifetime: ${lifetime}s`);\n    console.log(`üîó Hub: ${hubEndpoint}`);\n    console.log(`üìã Type: ${agentType}`);\n    console.log('');\n\n    // Spawn agent process\n    const agentPath = resolve(__dirname, '../federation/run-agent.js');\n\n    if (!existsSync(agentPath)) {\n      console.error(`‚ùå Error: Agent runtime not found at ${agentPath}`);\n      console.error('   Please build the project first: npm run build');\n      process.exit(1);\n    }\n\n    const agentProcess = spawn('node', [agentPath], {\n      stdio: 'inherit',\n      env: {\n        ...process.env,\n        AGENT_ID: agentId,\n        TENANT_ID: tenantId,\n        AGENT_LIFETIME: lifetime.toString(),\n        HUB_ENDPOINT: hubEndpoint,\n        AGENT_TYPE: agentType\n      }\n    });\n\n    agentProcess.on('exit', (code) => {\n      console.log(`\\nüìä Agent lifecycle complete (exit code: ${code})`);\n      process.exit(code || 0);\n    });\n\n    process.on('SIGINT', () => {\n      console.log('\\n\\n‚è∏Ô∏è  Terminating agent...');\n      agentProcess.kill('SIGINT');\n    });\n\n    process.on('SIGTERM', () => {\n      agentProcess.kill('SIGTERM');\n    });\n  }\n\n  /**\n   * Show hub statistics\n   */\n  async stats(hubEndpoint?: string): Promise<void> {\n    const endpoint = hubEndpoint || process.env.FEDERATION_HUB_ENDPOINT || 'ws://localhost:8443';\n\n    console.log('\\nüìä Federation Hub Statistics');\n    console.log('‚ïê'.repeat(60));\n    console.log(`üîó Hub: ${endpoint}`);\n    console.log('');\n\n    try {\n      // TODO: Implement WebSocket stats query\n      // For now, show placeholder\n      console.log('‚è≥ Querying hub statistics...\\n');\n      console.log('Note: Stats API not yet implemented.');\n      console.log('The hub server logs real-time statistics to stdout.');\n      console.log('\\nExpected stats:');\n      console.log('  ‚Ä¢ Connected agents count');\n      console.log('  ‚Ä¢ Total episodes stored');\n      console.log('  ‚Ä¢ Active tenants');\n      console.log('  ‚Ä¢ Uptime and performance metrics');\n      console.log('');\n    } catch (error: any) {\n      console.error(`‚ùå Failed to query stats: ${error.message}`);\n      process.exit(1);\n    }\n  }\n\n  /**\n   * Show federation status\n   */\n  async status(): Promise<void> {\n    console.log('\\nüîç Federation System Status');\n    console.log('‚ïê'.repeat(60));\n    console.log('');\n\n    console.log('Components:');\n    console.log('  ‚úÖ FederationHubServer   - WebSocket hub for agent sync');\n    console.log('  ‚úÖ FederationHubClient   - WebSocket client for agents');\n    console.log('  ‚úÖ EphemeralAgent        - Short-lived agent lifecycle');\n    console.log('  ‚úÖ SecurityManager       - JWT authentication & encryption');\n    console.log('  ‚úÖ AgentDB Integration   - Vector memory storage (150x faster)');\n    console.log('');\n\n    console.log('Features:');\n    console.log('  ‚úÖ Tenant Isolation      - Multi-tenant memory separation');\n    console.log('  ‚úÖ Persistent Hub        - SQLite + AgentDB storage');\n    console.log('  ‚úÖ Ephemeral Agents      - :memory: databases (5s-15min lifetime)');\n    console.log('  ‚úÖ Semantic Search       - HNSW vector indexing');\n    console.log('  ‚úÖ Multi-Generation      - Agents learn from past agents');\n    console.log('  ‚è≥ QUIC Transport        - Native QUIC planned (WebSocket fallback)');\n    console.log('');\n\n    console.log('Architecture:');\n    console.log('  ‚Ä¢ Hub: Persistent central database (disk)');\n    console.log('  ‚Ä¢ Agents: Ephemeral local databases (RAM)');\n    console.log('  ‚Ä¢ Sync: Real-time via WebSocket');\n    console.log('  ‚Ä¢ Memory: Outlives agent lifecycle');\n    console.log('');\n\n    console.log('Documentation:');\n    console.log('  üìñ Architecture: docs/architecture/FEDERATED-AGENTDB-EPHEMERAL-AGENTS.md');\n    console.log('  üìñ Data Lifecycle: docs/architecture/FEDERATION-DATA-LIFECYCLE.md');\n    console.log('  üìñ Test Report: docs/architecture/FEDERATION-TEST-REPORT.md');\n    console.log('  üìñ Integration: docs/architecture/AGENTDB-INTEGRATION-COMPLETE.md');\n    console.log('');\n  }\n\n  /**\n   * Run multi-agent collaboration test\n   */\n  async testCollaboration(): Promise<void> {\n    console.log('\\nüß™ Running Multi-Agent Collaboration Test...');\n    console.log('‚ïê'.repeat(60));\n    console.log('');\n\n    const testPath = resolve(__dirname, '../../tests/federation/test-agentdb-collaboration.js');\n\n    if (!existsSync(testPath)) {\n      console.error(`‚ùå Error: Test not found at ${testPath}`);\n      console.error('   Please build the project first: npm run build');\n      process.exit(1);\n    }\n\n    console.log('üìã Test Scenario:');\n    console.log('  ‚Ä¢ 5 collaborative agents (researcher, coder, tester, reviewer, isolated)');\n    console.log('  ‚Ä¢ Real AgentDB integration');\n    console.log('  ‚Ä¢ Cross-agent memory sharing');\n    console.log('  ‚Ä¢ Tenant isolation validation');\n    console.log('');\n\n    const testProcess = spawn('node', [testPath], {\n      stdio: 'inherit'\n    });\n\n    testProcess.on('exit', (code) => {\n      if (code === 0) {\n        console.log('\\n‚úÖ Collaboration test passed!');\n      } else {\n        console.log(`\\n‚ùå Collaboration test failed (exit code: ${code})`);\n      }\n      process.exit(code || 0);\n    });\n\n    process.on('SIGINT', () => {\n      console.log('\\n\\n‚è∏Ô∏è  Terminating test...');\n      testProcess.kill('SIGINT');\n    });\n\n    process.on('SIGTERM', () => {\n      testProcess.kill('SIGTERM');\n    });\n  }\n\n  /**\n   * Print help message\n   */\n  printHelp(): void {\n    console.log(`\nüåê Federation Hub CLI - Ephemeral Agent Management\n\nUSAGE:\n  npx agentic-flow federation <command> [options]\n\nCOMMANDS:\n  start               Start federation hub server\n  spawn               Spawn ephemeral agent\n  stats               Show hub statistics\n  status              Show federation system status\n  test                Run multi-agent collaboration test\n  help                Show this help message\n\nHUB SERVER OPTIONS:\n  --port, -p <port>           Hub server port [default: 8443]\n  --db-path <path>            Database path [default: :memory:]\n  --max-agents <number>       Maximum concurrent agents [default: 1000]\n  --verbose, -v               Enable verbose logging\n\nAGENT OPTIONS:\n  --agent-id <id>             Custom agent ID [default: auto-generated]\n  --tenant <id>               Tenant ID [default: 'default']\n  --lifetime <seconds>        Agent lifetime [default: 300]\n  --hub <endpoint>            Hub WebSocket endpoint [default: ws://localhost:8443]\n  --type <type>               Agent type [default: 'worker']\n\nENVIRONMENT VARIABLES:\n  FEDERATION_HUB_PORT         Hub server port (default: 8443)\n  FEDERATION_DB_PATH          Database path (default: :memory:)\n  FEDERATION_MAX_AGENTS       Max concurrent agents (default: 1000)\n  FEDERATION_TENANT_ID        Default tenant ID\n  FEDERATION_HUB_ENDPOINT     Hub WebSocket endpoint\n  AGENT_LIFETIME              Agent lifetime in seconds (default: 300)\n\nDEBUG OPTIONS (for detailed operation visibility):\n  DEBUG_LEVEL                 Debug verbosity level\n                              ‚Ä¢ SILENT (0) - No output\n                              ‚Ä¢ BASIC (1) - Major events only [default]\n                              ‚Ä¢ DETAILED (2) - Include all operations with timing\n                              ‚Ä¢ VERBOSE (3) - All events + realtime + tasks\n                              ‚Ä¢ TRACE (4) - Everything + internal state changes\n  DEBUG_FORMAT                Output format (human | json | compact) [default: human]\n  DEBUG_OUTPUT                Output destination (console | file | both) [default: console]\n  DEBUG_OUTPUT_FILE           File path for debug output [default: none]\n\nDEBUG EXAMPLES:\n  # Enable detailed debug with timing\n  DEBUG_LEVEL=DETAILED npx agentic-flow federation start\n\n  # Maximum verbosity for troubleshooting\n  DEBUG_LEVEL=TRACE DEBUG_FORMAT=human npx agentic-flow federation spawn\n\n  # Production monitoring with JSON output to file\n  DEBUG_LEVEL=BASIC DEBUG_FORMAT=json DEBUG_OUTPUT=file \\\\\n  DEBUG_OUTPUT_FILE=/var/log/federation.log npx agentic-flow federation start\n\n  # Compact format for log aggregation\n  DEBUG_LEVEL=DETAILED DEBUG_FORMAT=compact DEBUG_OUTPUT=both \\\\\n  DEBUG_OUTPUT_FILE=debug.log npx agentic-flow federation start\n\nEXAMPLES:\n  # Start hub server (in-memory)\n  npx agentic-flow federation start\n\n  # Start hub with persistent storage\n  npx agentic-flow federation start --db-path ./data/hub.db\n\n  # Start hub on custom port\n  npx agentic-flow federation start --port 9443 --verbose\n\n  # Spawn ephemeral agent (5 minute lifetime)\n  npx agentic-flow federation spawn --tenant acme-corp\n\n  # Spawn agent with custom lifetime\n  npx agentic-flow federation spawn --tenant acme-corp --lifetime 600 --type researcher\n\n  # Show hub statistics\n  npx agentic-flow federation stats\n\n  # Show system status\n  npx agentic-flow federation status\n\n  # Run collaboration test\n  npx agentic-flow federation test\n\nARCHITECTURE:\n  Hub: Persistent central database (SQLite + AgentDB)\n    ‚Ä¢ Episode metadata storage\n    ‚Ä¢ Vector memory with HNSW indexing (150x faster)\n    ‚Ä¢ Tenant isolation via sessionId prefixes\n    ‚Ä¢ Change log for synchronization\n\n  Agents: Ephemeral local databases (:memory:)\n    ‚Ä¢ Short-lived (5 seconds to 15 minutes)\n    ‚Ä¢ Pull memories from hub on spawn\n    ‚Ä¢ Push new memories to hub during work\n    ‚Ä¢ Destroyed on cleanup (memory persists in hub)\n\n  Memory Persistence:\n    ‚Ä¢ Hub database outlives all agents\n    ‚Ä¢ New agents can access memories from dead agents\n    ‚Ä¢ Multi-generation learning enabled\n    ‚Ä¢ Semantic search for pattern discovery\n\nBENEFITS:\n  ‚úÖ Memory outlives agents         - Persistent learning across generations\n  ‚úÖ Tenant isolation               - Multi-tenant with zero data leakage\n  ‚úÖ Semantic search                - Find similar patterns via vector similarity\n  ‚úÖ 150x faster search             - HNSW indexing vs brute force\n  ‚úÖ Scalable architecture          - Ready for 100+ concurrent agents\n  ‚úÖ WebSocket protocol             - Real-time synchronization\n  ‚úÖ Zero-trust security            - JWT auth + AES-256 encryption\n\nDOCUMENTATION:\n  üìñ Complete Architecture:\n     docs/architecture/FEDERATED-AGENTDB-EPHEMERAL-AGENTS.md\n\n  üìñ Data Lifecycle Explanation:\n     docs/architecture/FEDERATION-DATA-LIFECYCLE.md\n\n  üìñ Multi-Agent Test Report:\n     docs/architecture/FEDERATION-TEST-REPORT.md\n\n  üìñ AgentDB Integration:\n     docs/architecture/AGENTDB-INTEGRATION-COMPLETE.md\n\n  üìñ GitHub: https://github.com/ruvnet/agentic-flow\n`);\n  }\n}\n\n/**\n * CLI command handler\n */\nexport async function handleFederationCommand(args: string[]): Promise<void> {\n  const command = args[0];\n  const cli = new FederationCLI();\n\n  // Parse options\n  const parseOptions = (args: string[]) => {\n    const options: any = {};\n    for (let i = 0; i < args.length; i++) {\n      if ((args[i] === '--port' || args[i] === '-p') && args[i + 1]) {\n        options.port = parseInt(args[++i]);\n      } else if (args[i] === '--db-path' && args[i + 1]) {\n        options.dbPath = args[++i];\n      } else if (args[i] === '--max-agents' && args[i + 1]) {\n        options.maxAgents = parseInt(args[++i]);\n      } else if (args[i] === '--verbose' || args[i] === '-v') {\n        options.verbose = true;\n      } else if (args[i] === '--agent-id' && args[i + 1]) {\n        options.agentId = args[++i];\n      } else if (args[i] === '--tenant' && args[i + 1]) {\n        options.tenantId = args[++i];\n      } else if (args[i] === '--lifetime' && args[i + 1]) {\n        options.lifetime = parseInt(args[++i]);\n      } else if (args[i] === '--hub' && args[i + 1]) {\n        options.hubEndpoint = args[++i];\n      } else if (args[i] === '--type' && args[i + 1]) {\n        options.agentType = args[++i];\n      }\n    }\n    return options;\n  };\n\n  const options = parseOptions(args.slice(1));\n\n  switch (command) {\n    case undefined:\n    case 'help':\n      cli.printHelp();\n      break;\n\n    case 'start':\n      await cli.startHub(options);\n      break;\n\n    case 'spawn':\n      await cli.spawnAgent(options);\n      break;\n\n    case 'stats':\n      await cli.stats(options.hubEndpoint);\n      break;\n\n    case 'status':\n      await cli.status();\n      break;\n\n    case 'test':\n      await cli.testCollaboration();\n      break;\n\n    default:\n      console.log(`\\n‚ùå Unknown command: ${command}\\n`);\n      console.log('Use \"npx agentic-flow federation help\" for usage information\\n');\n      process.exit(1);\n  }\n}\n\n// If run directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  const args = process.argv.slice(2);\n  handleFederationCommand(args).catch((error) => {\n    console.error('\\n‚ùå Error:', error.message);\n    console.error(error.stack);\n    process.exit(1);\n  });\n}\n"]}