{"version":3,"file":"claude-code-wrapper.js","sourceRoot":"","sources":["../../src/cli/claude-code-wrapper.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n/**\n * Claude Code Wrapper for Agentic Flow\n *\n * Automatically spawns Claude Code with the correct ANTHROPIC_BASE_URL\n * and environment variables based on the provider/args used.\n *\n * Usage:\n *   npx agentic-flow claude-code --provider openrouter \"Write a function\"\n *   npx agentic-flow claude-code --provider gemini \"Create a REST API\"\n *   npx agentic-flow claude-code --provider anthropic \"Help me debug\"\n *\n * Features:\n * - Auto-starts proxy server in background if not running\n * - Sets ANTHROPIC_BASE_URL to proxy endpoint\n * - Configures provider-specific API keys\n * - Supports all Claude Code native arguments\n * - Cleans up proxy on exit (optional)\n */\n\nimport { spawn, ChildProcess } from 'child_process';\nimport { Command } from 'commander';\nimport * as dotenv from 'dotenv';\nimport { resolve, dirname } from 'path';\nimport { fileURLToPath } from 'url';\nimport { logger } from '../utils/logger.js';\n\n// Load environment variables from root .env\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\ndotenv.config({ path: resolve(__dirname, '../../../.env') });\n\ninterface ProxyConfig {\n  provider: 'anthropic' | 'openrouter' | 'requesty' | 'gemini' | 'onnx';\n  port: number;\n  baseUrl: string;\n  model?: string;\n  apiKey: string;\n  requiresProxy: boolean;\n}\n\n/**\n * Get proxy configuration based on provider\n */\nfunction getProxyConfig(provider: string, customPort?: number): ProxyConfig {\n  const port = customPort || 3000;\n  const baseUrl = `http://localhost:${port}`;\n\n  switch (provider.toLowerCase()) {\n    case 'openrouter':\n      return {\n        provider: 'openrouter',\n        port,\n        baseUrl,\n        model: process.env.COMPLETION_MODEL || 'deepseek/deepseek-chat',\n        apiKey: process.env.OPENROUTER_API_KEY || '',\n        requiresProxy: true\n      };\n\n    case 'requesty':\n      return {\n        provider: 'requesty',\n        port,\n        baseUrl,\n        model: process.env.COMPLETION_MODEL || 'deepseek/deepseek-chat',\n        apiKey: process.env.REQUESTY_API_KEY || '',\n        requiresProxy: true\n      };\n\n    case 'gemini':\n      return {\n        provider: 'gemini',\n        port,\n        baseUrl,\n        model: process.env.GEMINI_MODEL || 'gemini-2.0-flash-exp',\n        apiKey: process.env.GOOGLE_GEMINI_API_KEY || '',\n        requiresProxy: true\n      };\n\n    case 'onnx':\n      return {\n        provider: 'onnx',\n        port,\n        baseUrl,\n        model: 'onnx-local',\n        apiKey: 'dummy',\n        requiresProxy: true\n      };\n\n    case 'anthropic':\n    default:\n      return {\n        provider: 'anthropic',\n        port: 0,\n        baseUrl: 'https://api.anthropic.com',\n        apiKey: process.env.ANTHROPIC_API_KEY || '',\n        requiresProxy: false\n      };\n  }\n}\n\n/**\n * Check if proxy server is already running\n */\nasync function isProxyRunning(port: number): Promise<boolean> {\n  try {\n    const response = await fetch(`http://localhost:${port}/health`);\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Start the proxy server in background using the same approach as the agent\n */\nasync function startProxyServer(config: ProxyConfig): Promise<any> {\n  if (!config.requiresProxy) {\n    return null;\n  }\n\n  // Check if already running\n  const running = await isProxyRunning(config.port);\n  if (running) {\n    logger.info(`Proxy already running on port ${config.port}`);\n    return null;\n  }\n\n  logger.info(`Starting ${config.provider} proxy on port ${config.port}...`);\n\n  let proxy: any;\n\n  if (config.provider === 'gemini') {\n    const { AnthropicToGeminiProxy } = await import('../proxy/anthropic-to-gemini.js');\n    proxy = new AnthropicToGeminiProxy({\n      geminiApiKey: config.apiKey,\n      defaultModel: config.model || 'gemini-2.0-flash-exp'\n    });\n  } else if (config.provider === 'onnx') {\n    const { AnthropicToONNXProxy } = await import('../proxy/anthropic-to-onnx.js');\n    proxy = new AnthropicToONNXProxy({\n      port: config.port,\n      modelPath: process.env.ONNX_MODEL_PATH,\n      executionProviders: process.env.ONNX_EXECUTION_PROVIDERS?.split(',') || ['cpu']\n    });\n  } else {\n    // OpenRouter - DeepSeek Chat: cheap ($0.14/M), fast, supports tools, good quality\n    const { AnthropicToOpenRouterProxy } = await import('../proxy/anthropic-to-openrouter.js');\n    proxy = new AnthropicToOpenRouterProxy({\n      openrouterApiKey: config.apiKey,\n      openrouterBaseUrl: process.env.ANTHROPIC_PROXY_BASE_URL,\n      defaultModel: config.model || 'deepseek/deepseek-chat'\n    });\n  }\n\n  // Start proxy\n  proxy.start(config.port);\n\n  console.log(`üîó Proxy Mode: ${config.provider}`);\n  console.log(`üîß Proxy URL: ${config.baseUrl}`);\n  console.log(`ü§ñ Default Model: ${config.model}\\n`);\n\n  // Wait for proxy to be ready\n  await new Promise(resolve => setTimeout(resolve, 1500));\n\n  return proxy;\n}\n\n/**\n * Spawn Claude Code with configured environment\n */\nfunction spawnClaudeCode(config: ProxyConfig, claudeArgs: string[]): ChildProcess {\n  logger.info('Starting Claude Code...');\n  logger.info(`Provider: ${config.provider}`);\n  logger.info(`Base URL: ${config.baseUrl}`);\n  if (config.model) {\n    logger.info(`Model: ${config.model}`);\n  }\n\n  // Build environment variables\n  const env: Record<string, string> = {\n    ...process.env\n  } as Record<string, string>;\n\n  if (config.requiresProxy) {\n    // Using proxy - set base URL and realistic dummy key\n    // Use a properly formatted key that won't trigger Claude's validation warnings\n    env.ANTHROPIC_BASE_URL = config.baseUrl;\n    env.ANTHROPIC_API_KEY = 'sk-ant-api03-proxy-forwarded-to-' + config.provider + '-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';\n\n    // Set provider-specific keys\n    if (config.provider === 'openrouter') {\n      env.OPENROUTER_API_KEY = config.apiKey;\n    } else if (config.provider === 'gemini') {\n      env.GOOGLE_GEMINI_API_KEY = config.apiKey;\n    }\n  } else {\n    // Direct Anthropic\n    env.ANTHROPIC_API_KEY = config.apiKey;\n    if (env.ANTHROPIC_BASE_URL) {\n      delete env.ANTHROPIC_BASE_URL;\n    }\n  }\n\n  logger.debug('Environment variables:', {\n    ANTHROPIC_BASE_URL: env.ANTHROPIC_BASE_URL || '(default)',\n    ANTHROPIC_API_KEY: env.ANTHROPIC_API_KEY?.substring(0, 10) + '...',\n    OPENROUTER_API_KEY: env.OPENROUTER_API_KEY ? '(set)' : '(not set)',\n    GOOGLE_GEMINI_API_KEY: env.GOOGLE_GEMINI_API_KEY ? '(set)' : '(not set)'\n  });\n\n  // Spawn Claude Code\n  const claudeProcess = spawn('claude', claudeArgs, {\n    env: env as NodeJS.ProcessEnv,\n    stdio: 'inherit'\n  });\n\n  return claudeProcess;\n}\n\n/**\n * Main CLI function\n */\nasync function main() {\n  const program = new Command();\n\n  program\n    .name('agentic-flow claude-code')\n    .description('Spawn Claude Code with automatic proxy configuration for alternative AI providers')\n    .usage('[options] [task]')\n    .addHelpText('after', `\nExamples:\n  # Interactive mode - Opens Claude Code UI with proxy\n  $ agentic-flow claude-code --provider openrouter\n  $ agentic-flow claude-code --provider gemini\n\n  # Non-interactive mode - Execute task and exit\n  $ agentic-flow claude-code --provider openrouter \"Write a Python hello world function\"\n  $ agentic-flow claude-code --provider openrouter --model \"mistralai/mistral-small-3.1-24b-instruct\" \"Create REST API\"\n\n  # Using different providers\n  $ agentic-flow claude-code --provider openrouter  # Uses Mistral Small (default, $0.02/M tokens)\n  $ agentic-flow claude-code --provider gemini      # Uses Gemini 2.0 Flash\n  $ agentic-flow claude-code --provider onnx        # Uses local ONNX models (free)\n\n  # With Agent Booster for 57x faster code edits\n  $ agentic-flow claude-code --provider openrouter --agent-booster\n\nRecommended Models:\n  OpenRouter:\n    mistralai/mistral-small-3.1-24b-instruct  (default, $0.02/M, 128k context, optimized for tools)\n    anthropic/claude-3.5-sonnet         ($3/M, highest quality, large context)\n    google/gemini-2.0-flash-exp:free    (FREE tier, rate limited)\n\n  Note: Models with <128k context will fail with tool definitions (Claude sends 35k+ tokens)\n\nEnvironment Variables:\n  OPENROUTER_API_KEY    Required for --provider openrouter\n  GOOGLE_GEMINI_API_KEY Required for --provider gemini\n  ANTHROPIC_API_KEY     Required for --provider anthropic (default)\n  ONNX_MODEL_PATH       Optional for --provider onnx\n\nDocumentation:\n  https://github.com/ruvnet/agentic-flow#claude-code-mode\n  https://ruv.io\n`)\n    .option('--provider <provider>', 'AI provider (anthropic, openrouter, gemini, onnx)', 'anthropic')\n    .option('--port <port>', 'Proxy server port', '3000')\n    .option('--model <model>', 'Specific model to use (e.g., mistralai/mistral-small-3.1-24b-instruct)')\n    .option('--agent-booster', 'Enable Agent Booster MCP tools for 57x faster code edits (default: true)', true)\n    .option('--keep-proxy', 'Keep proxy running after Claude Code exits')\n    .option('--no-auto-start', 'Skip proxy startup (use existing proxy)')\n    .allowUnknownOption(true)\n    .allowExcessArguments(true);\n\n  program.parse(process.argv);\n  const options = program.opts();\n\n  // Get provider configuration\n  const config = getProxyConfig(options.provider, parseInt(options.port));\n\n  // Override model if specified\n  if (options.model) {\n    config.model = options.model;\n  }\n\n  // Validate API keys\n  if (config.requiresProxy && !config.apiKey) {\n    console.error(`‚ùå Error: Missing API key for ${config.provider}`);\n    console.error(`   Please set ${config.provider === 'openrouter' ? 'OPENROUTER_API_KEY' : 'GOOGLE_GEMINI_API_KEY'}`);\n    process.exit(1);\n  }\n\n  if (!config.requiresProxy && !config.apiKey) {\n    console.error('‚ùå Error: Missing ANTHROPIC_API_KEY');\n    process.exit(1);\n  }\n\n  // Get Claude Code arguments (filter out wrapper-specific flags only)\n  const wrapperFlags = new Set(['--provider', '--port', '--model', '--agent-booster', '--keep-proxy', '--no-auto-start']);\n  const wrapperValues = new Set([options.provider, options.port, options.model]);\n\n  const claudeArgs: string[] = [];\n  let skipNext = false;\n\n  for (let i = 2; i < process.argv.length; i++) {\n    const arg = process.argv[i];\n\n    if (skipNext) {\n      skipNext = false;\n      continue;\n    }\n\n    // Check if this is a wrapper flag\n    const isWrapperFlag = Array.from(wrapperFlags).some(flag => arg.startsWith(flag));\n\n    if (isWrapperFlag) {\n      // Skip this flag and its value if it has one\n      if (!arg.includes('=') && i + 1 < process.argv.length && !process.argv[i + 1].startsWith('-')) {\n        skipNext = true;\n      }\n      continue;\n    }\n\n    // Keep all other arguments\n    claudeArgs.push(arg);\n  }\n\n  // Auto-detect non-interactive mode: if there's a task string and no -p flag, add it\n  // Claude expects: claude [prompt] [flags], not claude [flags] [prompt]\n  const hasTaskString = claudeArgs.some(arg => !arg.startsWith('-'));\n  const hasPrintFlag = claudeArgs.includes('-p') || claudeArgs.includes('--print');\n\n  if (hasTaskString && !hasPrintFlag) {\n    // Find the prompt (first non-flag argument)\n    const promptIndex = claudeArgs.findIndex(arg => !arg.startsWith('-'));\n    if (promptIndex !== -1) {\n      // Insert -p after the prompt\n      claudeArgs.splice(promptIndex + 1, 0, '-p');\n    }\n  }\n\n  let proxyServer: any = null;\n\n  try {\n    // Info about Agent Booster MCP tools if enabled\n    if (options.agentBooster) {\n      logger.info('');\n      logger.info('‚ö° Agent Booster enabled (57x faster code edits)');\n      logger.info('   Available tools: agent_booster_edit_file, agent_booster_batch_edit, agent_booster_parse_markdown');\n      logger.info('   Configure MCP: Add \"agentic-flow\" to Claude Desktop config');\n      logger.info('   Learn more: examples/mcp-integration.md');\n      logger.info('');\n    }\n\n    // Start proxy if needed and auto-start is enabled\n    if (options.autoStart) {\n      proxyServer = await startProxyServer(config);\n    }\n\n    // Spawn Claude Code\n    const claudeProcess = spawnClaudeCode(config, claudeArgs);\n\n    // Handle cleanup on exit\n    const cleanup = () => {\n      if (proxyServer && !options.keepProxy) {\n        logger.info('Stopping proxy server...');\n        if (proxyServer.stop) {\n          proxyServer.stop();\n        }\n      }\n    };\n\n    claudeProcess.on('exit', (code) => {\n      cleanup();\n      process.exit(code || 0);\n    });\n\n    process.on('SIGINT', () => {\n      claudeProcess.kill('SIGINT');\n      cleanup();\n    });\n\n    process.on('SIGTERM', () => {\n      claudeProcess.kill('SIGTERM');\n      cleanup();\n    });\n\n  } catch (error: any) {\n    console.error('‚ùå Error:', error.message);\n    if (proxyServer && proxyServer.stop) {\n      proxyServer.stop();\n    }\n    process.exit(1);\n  }\n}\n\n// Run if executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  main().catch((error) => {\n    console.error('‚ùå Fatal error:', error);\n    process.exit(1);\n  });\n}\n"]}