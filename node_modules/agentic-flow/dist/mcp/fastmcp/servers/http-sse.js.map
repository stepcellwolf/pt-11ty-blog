{"version":3,"file":"http-sse.js","sourceRoot":"","sources":["../../../../src/mcp/fastmcp/servers/http-sse.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n// FastMCP server with HTTP/SSE transport - All agentic-flow tools\n// Accessible via HTTP at http://localhost:8080/mcp\n// SSE endpoint at http://localhost:8080/sse\nimport { FastMCP } from 'fastmcp';\nimport { z } from 'zod';\nimport { execSync } from 'child_process';\n\nconsole.error('üöÄ Starting Agentic-Flow MCP Server (HTTP/SSE transport)...');\nconsole.error('üì¶ Loading agentic-flow tools');\n\nconst server = new FastMCP({\n  name: 'agentic-flow-http',\n  version: '1.1.12'\n});\n\n// Tool: Run agentic-flow agent\nserver.addTool({\n  name: 'agentic_flow_agent',\n  description: 'Execute an agentic-flow agent with a specific task. Supports multiple providers (Anthropic, Gemini, OpenRouter, ONNX) and comprehensive configuration options.',\n  parameters: z.object({\n    agent: z.string().describe('Agent type (coder, researcher, analyst, etc.) - Use agentic_flow_list_agents to see all 66+ available agents'),\n    task: z.string().describe('Task description for the agent to execute'),\n\n    // Provider Configuration\n    model: z.string().optional().describe('Model to use (e.g., \"claude-sonnet-4-5-20250929\" for Anthropic, \"meta-llama/llama-3.1-8b-instruct\" for OpenRouter, or \"Xenova/gpt2\" for ONNX local models)'),\n    provider: z.enum(['anthropic', 'openrouter', 'onnx', 'gemini']).optional().describe('LLM provider: \"anthropic\" (default, highest quality, requires ANTHROPIC_API_KEY), \"gemini\" (free tier, requires GOOGLE_GEMINI_API_KEY), \"openrouter\" (99% cost savings, requires OPENROUTER_API_KEY), \"onnx\" (free local inference, no API key needed)'),\n\n    // API Configuration\n    anthropicApiKey: z.string().optional().describe('Anthropic API key (sk-ant-...) - overrides ANTHROPIC_API_KEY environment variable'),\n    openrouterApiKey: z.string().optional().describe('OpenRouter API key (sk-or-...) - overrides OPENROUTER_API_KEY environment variable'),\n\n    // Agent Behavior\n    stream: z.boolean().optional().default(false).describe('Enable streaming output (real-time response chunks)'),\n    temperature: z.number().min(0).max(1).optional().describe('Sampling temperature (0.0-1.0): lower = more focused/deterministic, higher = more creative/random. Default varies by agent.'),\n    maxTokens: z.number().positive().optional().describe('Maximum tokens in response (default: 4096). Controls output length.'),\n\n    // Directory Configuration\n    agentsDir: z.string().optional().describe('Custom agents directory path (default: .claude/agents) - for using custom agent definitions'),\n\n    // Output Options\n    outputFormat: z.enum(['text', 'json', 'markdown']).optional().describe('Output format: \"text\" (default, human-readable), \"json\" (structured data), \"markdown\" (formatted docs)'),\n    verbose: z.boolean().optional().default(false).describe('Enable verbose logging for debugging'),\n\n    // Execution Control\n    timeout: z.number().positive().optional().describe('Execution timeout in milliseconds (default: 300000 = 5 minutes)'),\n    retryOnError: z.boolean().optional().default(false).describe('Automatically retry on transient errors (rate limits, network issues)')\n  }),\n  execute: async ({\n    agent,\n    task,\n    model,\n    provider,\n    anthropicApiKey,\n    openrouterApiKey,\n    stream,\n    temperature,\n    maxTokens,\n    agentsDir,\n    outputFormat,\n    verbose,\n    timeout,\n    retryOnError\n  }) => {\n    try {\n      // Build command with all parameters\n      let cmd = `npx --yes agentic-flow --agent \"${agent}\" --task \"${task}\"`;\n\n      // Provider & Model\n      if (model) cmd += ` --model \"${model}\"`;\n      if (provider) cmd += ` --provider ${provider}`;\n\n      // API Keys (set as env vars)\n      const env = { ...process.env };\n      if (anthropicApiKey) env.ANTHROPIC_API_KEY = anthropicApiKey;\n      if (openrouterApiKey) env.OPENROUTER_API_KEY = openrouterApiKey;\n\n      // Agent Behavior\n      if (stream) cmd += ' --stream';\n      if (temperature !== undefined) cmd += ` --temperature ${temperature}`;\n      if (maxTokens) cmd += ` --max-tokens ${maxTokens}`;\n\n      // Directories\n      if (agentsDir) cmd += ` --agents-dir \"${agentsDir}\"`;\n\n      // Output\n      if (outputFormat) cmd += ` --output ${outputFormat}`;\n      if (verbose) cmd += ' --verbose';\n\n      // Execution\n      if (timeout) cmd += ` --timeout ${timeout}`;\n      if (retryOnError) cmd += ' --retry';\n\n      const result = execSync(cmd, {\n        encoding: 'utf-8',\n        maxBuffer: 10 * 1024 * 1024,\n        timeout: timeout || 300000,\n        env\n      });\n\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: true,\n            agent,\n            provider: provider || 'anthropic',\n            output: result,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            agent,\n            error: error.message,\n            stderr: error.stderr?.toString(),\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\n// Tool: List all agents\nserver.addTool({\n  name: 'agentic_flow_list_agents',\n  description: 'List all available agentic-flow agents (66+ total)',\n  parameters: z.object({\n    format: z.enum(['summary', 'detailed', 'json']).optional().default('summary')\n  }),\n  execute: async ({ format }) => {\n    try {\n      const result = execSync('npx --yes agentic-flow --list', {\n        encoding: 'utf-8',\n        maxBuffer: 5 * 1024 * 1024,\n        timeout: 30000\n      });\n\n      if (format === 'detailed') {\n        return {\n          content: [{\n            type: 'text',\n            text: result\n          }]\n        };\n      }\n\n      // Parse agent list\n      const agents: any[] = [];\n      const lines = result.split('\\n');\n      let currentCategory = '';\n\n      for (const line of lines) {\n        if (line.includes(':') && line.trim().endsWith(':')) {\n          currentCategory = line.replace(':', '').trim();\n        } else if (line.trim().startsWith('‚Ä¢') || /^\\s{2,}\\w/.test(line)) {\n          const match = line.match(/^\\s*[‚Ä¢\\s]*(\\S+)\\s+(.+)$/);\n          if (match) {\n            agents.push({\n              name: match[1],\n              description: match[2].trim(),\n              category: currentCategory\n            });\n          }\n        }\n      }\n\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: true,\n            count: agents.length,\n            agents: format === 'json' ? agents : agents.map(a => a.name),\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            error: error.message,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\n// Tool: Create custom agent\nserver.addTool({\n  name: 'agentic_flow_create_agent',\n  description: 'Create a new custom agent with specified name, description, and system prompt',\n  parameters: z.object({\n    name: z.string().describe('Agent name (will be converted to kebab-case, e.g., my-custom-agent)'),\n    description: z.string().describe('Agent description (what this agent does)'),\n    systemPrompt: z.string().describe('System prompt that defines the agent behavior and personality'),\n    category: z.string().optional().default('custom').describe('Category/folder to organize the agent (default: custom)'),\n    tools: z.array(z.string()).optional().describe('Optional list of tools this agent can use (e.g., [\"web-search\", \"code-execution\"])')\n  }),\n  execute: async ({ name, description, systemPrompt, category, tools }) => {\n    try {\n      const { writeFileSync, existsSync, mkdirSync } = await import('fs');\n      const { join } = await import('path');\n\n      // Convert to kebab-case\n      const agentName = name.toLowerCase().replace(/\\s+/g, '-');\n      const agentsDir = join(process.cwd(), '.claude', 'agents', category || 'custom');\n\n      if (!existsSync(agentsDir)) {\n        mkdirSync(agentsDir, { recursive: true });\n      }\n\n      const markdown = `# ${name}\n\n## Description\n${description}\n\n## System Prompt\n${systemPrompt}\n\n${tools && tools.length > 0 ? `## Tools\\n${tools.map(t => `- ${t}`).join('\\n')}\\n` : ''}\n\n## Usage\n\\`\\`\\`bash\nnpx agentic-flow --agent ${agentName} --task \"Your task\"\n\\`\\`\\`\n\n---\n*Created: ${new Date().toISOString()}*\n`;\n\n      const filePath = join(agentsDir, `${agentName}.md`);\n      if (existsSync(filePath)) {\n        throw new Error(`Agent '${agentName}' already exists at ${filePath}`);\n      }\n\n      writeFileSync(filePath, markdown, 'utf8');\n\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: true,\n            agent: agentName,\n            category: category || 'custom',\n            filePath,\n            message: `Agent '${agentName}' created successfully`,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            error: error.message,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\n// Tool: Get agent info\nserver.addTool({\n  name: 'agentic_flow_agent_info',\n  description: 'Get detailed information about a specific agent including source, description, and system prompt preview',\n  parameters: z.object({\n    name: z.string().describe('Agent name to get information about')\n  }),\n  execute: async ({ name }) => {\n    try {\n      const result = execSync(`npx --yes agentic-flow agent info ${name}`, {\n        encoding: 'utf-8',\n        maxBuffer: 5 * 1024 * 1024,\n        timeout: 30000\n      });\n\n      return {\n        content: [{\n          type: 'text',\n          text: result\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            error: error.message,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\n// Tool: Check for agent conflicts\nserver.addTool({\n  name: 'agentic_flow_check_conflicts',\n  description: 'Check for conflicts between package agents and local custom agents',\n  parameters: z.object({}),\n  execute: async () => {\n    try {\n      const result = execSync('npx --yes agentic-flow agent conflicts', {\n        encoding: 'utf-8',\n        maxBuffer: 5 * 1024 * 1024,\n        timeout: 30000\n      });\n\n      return {\n        content: [{\n          type: 'text',\n          text: result\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            error: error.message,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\n// Tool: Optimize model selection\nserver.addTool({\n  name: 'agentic_flow_optimize_model',\n  description: 'Automatically select the optimal model for an agent and task based on priorities (quality, cost, speed, privacy)',\n  parameters: z.object({\n    agent: z.string().describe('Agent type (e.g., coder, researcher, reviewer)'),\n    task: z.string().describe('Task description'),\n    priority: z.enum(['quality', 'balanced', 'cost', 'speed', 'privacy']).optional().default('balanced')\n      .describe('Optimization priority: quality (best results), balanced (cost/quality), cost (cheapest), speed (fastest), privacy (local only)'),\n    max_cost: z.number().positive().optional().describe('Maximum cost per task in dollars (optional budget cap)')\n  }),\n  execute: async ({ agent, task, priority, max_cost }) => {\n    try {\n      let cmd = `npx --yes agentic-flow --agent ${agent} --task \"${task}\" --optimize --priority ${priority}`;\n      if (max_cost) cmd += ` --max-cost ${max_cost}`;\n\n      const result = execSync(cmd, {\n        encoding: 'utf-8',\n        maxBuffer: 10 * 1024 * 1024,\n        timeout: 60000\n      });\n\n      return {\n        content: [{\n          type: 'text',\n          text: result\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            error: error.message,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n});\n\nconsole.error('‚úÖ Registered 6 tools successfully');\nconsole.error('üåê Starting HTTP/SSE transport...');\n\n// Start with HTTP/SSE transport\nserver.start({\n  transportType: 'httpStream',\n  httpStream: {\n    port: 8080\n  }\n}).then(() => {\n  console.error('‚úÖ Agentic-Flow MCP Server running!');\n  console.error('üì° HTTP endpoint: http://localhost:8080/mcp');\n  console.error('üì° SSE endpoint: http://localhost:8080/sse');\n  console.error('üíä Health check: http://localhost:8080/health');\n}).catch((error) => {\n  console.error('‚ùå Failed to start HTTP/SSE server:', error);\n  process.exit(1);\n});\n"]}