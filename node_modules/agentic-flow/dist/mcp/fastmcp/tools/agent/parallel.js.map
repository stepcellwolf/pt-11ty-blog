{"version":3,"file":"parallel.js","sourceRoot":"","sources":["../../../../../src/mcp/fastmcp/tools/agent/parallel.ts"],"names":[],"mappings":"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","sourcesContent":["import { z } from 'zod';\nimport { ToolDefinition, ToolContext } from '../../types/index.js';\nimport { execSync } from 'child_process';\n\nconst parallelModeSchema = z.object({\n  topic: z.string().optional().describe('Research topic for parallel mode'),\n  diff: z.string().optional().describe('Code diff for review'),\n  dataset: z.string().optional().describe('Dataset hint for analysis'),\n  streaming: z.boolean().optional().default(false).describe('Enable streaming output')\n});\n\nexport const parallelModeTool: ToolDefinition = {\n  name: 'agent_parallel',\n  description: 'Run parallel mode with 3 agents (research, code review, data analysis)',\n  parameters: parallelModeSchema,\n\n  async execute({ topic, diff, dataset, streaming }: z.infer<typeof parallelModeSchema>, { onProgress }: ToolContext) {\n    try {\n      onProgress?.({ progress: 0.1, message: 'Starting parallel agent execution' });\n\n      // Set environment variables\n      const env = {\n        ...process.env,\n        ...(topic && { TOPIC: topic }),\n        ...(diff && { DIFF: diff }),\n        ...(dataset && { DATASET: dataset }),\n        ...(streaming && { ENABLE_STREAMING: 'true' })\n      };\n\n      onProgress?.({ progress: 0.3, message: 'Executing 3 agents in parallel...' });\n\n      // Execute parallel mode\n      const result = execSync('npx agentic-flow', {\n        encoding: 'utf8',\n        maxBuffer: 10 * 1024 * 1024,\n        timeout: 300000,\n        env\n      });\n\n      onProgress?.({ progress: 1.0, message: 'Parallel execution completed' });\n\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: true,\n            mode: 'parallel',\n            agents: ['research', 'code_review', 'data'],\n            config: { topic, diff, dataset, streaming },\n            output: result,\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }]\n      };\n    } catch (error: any) {\n      return {\n        content: [{\n          type: 'text',\n          text: JSON.stringify({\n            success: false,\n            mode: 'parallel',\n            error: error.message,\n            stderr: error.stderr?.toString(),\n            timestamp: new Date().toISOString()\n          }, null, 2)\n        }],\n        isError: true\n      };\n    }\n  }\n};\n"]}