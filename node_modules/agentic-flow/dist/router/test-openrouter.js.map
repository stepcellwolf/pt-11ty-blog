{"version":3,"file":"test-openrouter.js","sourceRoot":"","sources":["../../src/router/test-openrouter.ts"],"names":[],"mappings":"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","sourcesContent":["#!/usr/bin/env node\n// Test script for OpenRouter integration\nimport { ModelRouter } from './router.js';\nimport { ChatParams } from './types.js';\n\nasync function testOpenRouter() {\n  console.log('ðŸ§ª Testing OpenRouter Integration\\n');\n\n  try {\n    // Initialize router\n    console.log('ðŸ“¦ Initializing router...');\n    const router = new ModelRouter();\n\n    const config = router.getConfig();\n    console.log(`âœ… Router initialized with default provider: ${config.defaultProvider}\\n`);\n\n    // Test 1: Simple chat completion\n    console.log('Test 1: Simple Chat Completion');\n    console.log('================================');\n\n    const chatParams: ChatParams = {\n      model: config.providers.anthropic?.models?.default || 'claude-3-5-sonnet-20241022',\n      messages: [\n        {\n          role: 'user',\n          content: 'Say \"Hello from Multi-Model Router!\" and nothing else.'\n        }\n      ],\n      temperature: 0.7,\n      maxTokens: 100\n    };\n\n    console.log(`ðŸ“¤ Sending request to model: ${chatParams.model}`);\n    console.log(`ðŸ“ Prompt: ${chatParams.messages[0].content}\\n`);\n\n    const startTime = Date.now();\n    const response = await router.chat(chatParams);\n    const latency = Date.now() - startTime;\n\n    console.log('ðŸ“¥ Response received:');\n    console.log(`  Provider: ${response.metadata?.provider}`);\n    console.log(`  Model: ${response.model}`);\n    console.log(`  Latency: ${latency}ms`);\n    console.log(`  Stop Reason: ${response.stopReason}`);\n    console.log(`  Usage: ${response.usage?.inputTokens} in / ${response.usage?.outputTokens} out`);\n    console.log(`  Cost: $${response.metadata?.cost?.toFixed(6) || 0}`);\n    console.log(`\\n  Content:`);\n\n    for (const block of response.content) {\n      if (block.type === 'text') {\n        console.log(`    ${block.text}`);\n      }\n    }\n\n    console.log('\\nâœ… Test 1 passed!\\n');\n\n    // Test 2: Different model via OpenRouter\n    console.log('Test 2: Alternative Model');\n    console.log('=========================');\n\n    const altParams: ChatParams = {\n      model: 'claude-3-5-haiku-20241022',\n      messages: [\n        {\n          role: 'user',\n          content: 'Respond with just the word \"SUCCESS\" if you can read this.'\n        }\n      ],\n      temperature: 0.5,\n      maxTokens: 50\n    };\n\n    console.log(`ðŸ“¤ Testing model: ${altParams.model}\\n`);\n\n    const altResponse = await router.chat(altParams);\n\n    console.log('ðŸ“¥ Response:');\n    console.log(`  Model: ${altResponse.model}`);\n    console.log(`  Content: ${altResponse.content[0].type === 'text' ? altResponse.content[0].text : 'N/A'}`);\n\n    console.log('\\nâœ… Test 2 passed!\\n');\n\n    // Test 3: Show metrics\n    console.log('Test 3: Router Metrics');\n    console.log('=====================');\n\n    const metrics = router.getMetrics();\n\n    console.log(`ðŸ“Š Total Requests: ${metrics.totalRequests}`);\n    console.log(`ðŸ’° Total Cost: $${metrics.totalCost.toFixed(6)}`);\n    console.log(`ðŸ“ Total Tokens: ${metrics.totalTokens.input} in / ${metrics.totalTokens.output} out`);\n    console.log('\\nProvider Breakdown:');\n\n    for (const [provider, stats] of Object.entries(metrics.providerBreakdown)) {\n      console.log(`  ${provider}:`);\n      console.log(`    Requests: ${stats.requests}`);\n      console.log(`    Cost: $${stats.cost.toFixed(6)}`);\n      console.log(`    Avg Latency: ${stats.avgLatency.toFixed(0)}ms`);\n    }\n\n    console.log('\\nâœ… Test 3 passed!\\n');\n\n    // Test 4: Rule-based routing (if configured)\n    if (config.routing?.mode === 'rule-based') {\n      console.log('Test 4: Rule-Based Routing');\n      console.log('==========================');\n\n      const ruleParams: ChatParams = {\n        model: config.providers.anthropic?.models?.default || 'claude-3-5-sonnet-20241022',\n        messages: [\n          {\n            role: 'user',\n            content: 'This is a test for rule-based routing'\n          }\n        ]\n      };\n\n      const ruleResponse = await router.chat(ruleParams, 'researcher');\n\n      console.log(`ðŸ“¥ Routed to: ${ruleResponse.metadata?.provider}`);\n      console.log(`ðŸ“ Response: ${ruleResponse.content[0].type === 'text' ? ruleResponse.content[0].text?.substring(0, 100) : 'N/A'}...`);\n\n      console.log('\\nâœ… Test 4 passed!\\n');\n    }\n\n    // Final summary\n    console.log('ðŸŽ‰ All Tests Passed!');\n    console.log('===================');\n    console.log(`âœ… OpenRouter integration working`);\n    console.log(`âœ… Router configuration loaded`);\n    console.log(`âœ… Chat completion successful`);\n    console.log(`âœ… Metrics tracking functional`);\n    console.log(`\\nðŸ“Š Final Metrics:`);\n    console.log(`  Total Requests: ${metrics.totalRequests}`);\n    console.log(`  Total Cost: $${metrics.totalCost.toFixed(6)}`);\n    console.log(`  Providers Used: ${Object.keys(metrics.providerBreakdown).join(', ')}`);\n\n  } catch (error) {\n    console.error('\\nâŒ Test Failed!');\n    console.error('===============');\n    console.error(error);\n    process.exit(1);\n  }\n}\n\n// Run tests\ntestOpenRouter().catch(error => {\n  console.error('Fatal error:', error);\n  process.exit(1);\n});\n"]}