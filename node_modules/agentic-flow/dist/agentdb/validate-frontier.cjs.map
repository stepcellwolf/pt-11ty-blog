{"version":3,"file":"validate-frontier.cjs","sourceRoot":"","sources":["../../src/agentdb/validate-frontier.cjs"],"names":[],"mappings":"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","sourcesContent":["/**\n * Standalone Frontier Features Validation\n *\n * Tests all frontier features without requiring full build infrastructure.\n * Validates:\n * 1. CausalMemoryGraph - causal edges, experiments, uplift calculation\n * 2. ExplainableRecall - certificates, Merkle proofs, provenance\n * 3. CausalRecall - utility-based reranking\n * 4. NightlyLearner - automated causal discovery\n */\n\nconst Database = require('better-sqlite3');\nconst fs = require('fs');\nconst path = require('path');\nconst crypto = require('crypto');\n\n// Color codes for output\nconst colors = {\n  reset: '\\x1b[0m',\n  green: '\\x1b[32m',\n  red: '\\x1b[31m',\n  yellow: '\\x1b[33m',\n  blue: '\\x1b[34m',\n  cyan: '\\x1b[36m'\n};\n\nfunction log(message, color = 'reset') {\n  console.log(`${colors[color]}${message}${colors.reset}`);\n}\n\nfunction assert(condition, message) {\n  if (!condition) {\n    throw new Error(`Assertion failed: ${message}`);\n  }\n}\n\nclass FrontierValidator {\n  constructor() {\n    // Create in-memory database\n    this.db = new Database(':memory:');\n\n    // Load schemas\n    this.loadSchemas();\n\n    this.testsRun = 0;\n    this.testsPassed = 0;\n    this.testsFailed = 0;\n  }\n\n  loadSchemas() {\n    log('\\nğŸ“¦ Loading database schemas...', 'cyan');\n\n    // Load core schema\n    const coreSchema = fs.readFileSync(\n      path.join(__dirname, 'schemas/schema.sql'),\n      'utf-8'\n    );\n    this.db.exec(coreSchema);\n\n    // Load frontier schema\n    const frontierSchema = fs.readFileSync(\n      path.join(__dirname, 'schemas/frontier-schema.sql'),\n      'utf-8'\n    );\n    this.db.exec(frontierSchema);\n\n    log('âœ“ Schemas loaded successfully', 'green');\n  }\n\n  runTest(name, testFn) {\n    this.testsRun++;\n    try {\n      log(`\\nğŸ§ª ${name}`, 'blue');\n      testFn();\n      this.testsPassed++;\n      log('  âœ… PASSED', 'green');\n    } catch (error) {\n      this.testsFailed++;\n      log(`  âŒ FAILED: ${error.message}`, 'red');\n      console.error(error);\n    }\n  }\n\n  // ========================================================================\n  // CausalMemoryGraph Tests\n  // ========================================================================\n\n  testCausalEdgeInsertion() {\n    this.runTest('Causal Edge Insertion', () => {\n      // Insert test episodes\n      const stmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success)\n        VALUES (?, ?, ?, ?)\n      `);\n\n      stmt.run('session1', 'task1', 0.8, 1);\n      stmt.run('session1', 'task2', 0.9, 1);\n\n      // Insert causal edge\n      const edgeStmt = this.db.prepare(`\n        INSERT INTO causal_edges (\n          from_memory_id, from_memory_type, to_memory_id, to_memory_type,\n          similarity, uplift, confidence, sample_size, mechanism\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `);\n\n      const result = edgeStmt.run(1, 'episode', 2, 'episode', 0.85, 0.15, 0.9, 100, 'test mechanism');\n      const edgeId = result.lastInsertRowid;\n\n      assert(edgeId > 0, 'Edge should be inserted');\n\n      // Verify\n      const edge = this.db.prepare('SELECT * FROM causal_edges WHERE id = ?').get(edgeId);\n      assert(edge.from_memory_id === 1, 'From ID should match');\n      assert(edge.to_memory_id === 2, 'To ID should match');\n      assert(edge.similarity === 0.85, 'Similarity should match');\n      assert(edge.uplift === 0.15, 'Uplift should match');\n      assert(edge.confidence === 0.9, 'Confidence should match');\n    });\n  }\n\n  testABExperiment() {\n    this.runTest('A/B Experiment and Uplift Calculation', () => {\n      // Insert episodes for experiment\n      const epStmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success)\n        VALUES (?, ?, ?, ?)\n      `);\n\n      for (let i = 1; i <= 10; i++) {\n        epStmt.run(`session${i}`, `task${i}`, 0.7 + Math.random() * 0.2, 1);\n      }\n\n      // Create experiment\n      const expStmt = this.db.prepare(`\n        INSERT INTO causal_experiments (\n          name, hypothesis, treatment_id, treatment_type, start_time, sample_size, status\n        ) VALUES (?, ?, ?, ?, ?, ?, ?)\n      `);\n\n      const expResult = expStmt.run(\n        'Test Experiment',\n        'Treatment improves outcome',\n        1,\n        'episode',\n        Date.now(),\n        0,\n        'running'\n      );\n\n      const expId = expResult.lastInsertRowid;\n      assert(expId > 0, 'Experiment should be created');\n\n      // Record observations\n      const obsStmt = this.db.prepare(`\n        INSERT INTO causal_observations (\n          experiment_id, episode_id, is_treatment, outcome_value, outcome_type\n        ) VALUES (?, ?, ?, ?, ?)\n      `);\n\n      // Treatment group (higher rewards)\n      for (let i = 0; i < 50; i++) {\n        obsStmt.run(expId, (i % 10) + 1, 1, 0.75 + Math.random() * 0.1, 'reward');\n      }\n\n      // Control group (lower rewards)\n      for (let i = 0; i < 50; i++) {\n        obsStmt.run(expId, (i % 10) + 1, 0, 0.55 + Math.random() * 0.1, 'reward');\n      }\n\n      // Check observations recorded\n      const obs = this.db.prepare('SELECT COUNT(*) as count FROM causal_observations WHERE experiment_id = ?').get(expId);\n      assert(obs.count === 100, 'Should have 100 observations');\n\n      // Calculate uplift (simplified inline calculation)\n      const treatmentObs = this.db.prepare(`\n        SELECT outcome_value FROM causal_observations\n        WHERE experiment_id = ? AND is_treatment = 1\n      `).all(expId);\n\n      const controlObs = this.db.prepare(`\n        SELECT outcome_value FROM causal_observations\n        WHERE experiment_id = ? AND is_treatment = 0\n      `).all(expId);\n\n      const treatmentMean = treatmentObs.reduce((sum, o) => sum + o.outcome_value, 0) / treatmentObs.length;\n      const controlMean = controlObs.reduce((sum, o) => sum + o.outcome_value, 0) / controlObs.length;\n      const uplift = treatmentMean - controlMean;\n\n      assert(uplift > 0.1, 'Uplift should be positive and significant');\n      log(`    Uplift: ${uplift.toFixed(3)}, Treatment: ${treatmentMean.toFixed(3)}, Control: ${controlMean.toFixed(3)}`, 'cyan');\n    });\n  }\n\n  testCausalQuery() {\n    this.runTest('Causal Effect Query', () => {\n      // Insert test data\n      const epStmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success)\n        VALUES (?, ?, ?, ?)\n      `);\n\n      for (let i = 1; i <= 5; i++) {\n        epStmt.run(`session${i}`, `task${i}`, 0.8, 1);\n      }\n\n      // Insert causal edges\n      const edgeStmt = this.db.prepare(`\n        INSERT INTO causal_edges (\n          from_memory_id, from_memory_type, to_memory_id, to_memory_type,\n          similarity, uplift, confidence\n        ) VALUES (?, ?, ?, ?, ?, ?, ?)\n      `);\n\n      edgeStmt.run(1, 'episode', 2, 'episode', 0.8, 0.2, 0.9);\n      edgeStmt.run(1, 'episode', 3, 'episode', 0.75, 0.15, 0.85);\n      edgeStmt.run(1, 'episode', 4, 'episode', 0.7, 0.05, 0.95); // Low uplift\n      edgeStmt.run(1, 'episode', 5, 'episode', 0.85, 0.25, 0.5); // Low confidence\n\n      // Query with filters\n      const effects = this.db.prepare(`\n        SELECT * FROM causal_edges\n        WHERE from_memory_id = ?\n          AND confidence >= ?\n          AND ABS(uplift) >= ?\n        ORDER BY ABS(uplift) * confidence DESC\n      `).all(1, 0.8, 0.1);\n\n      assert(effects.length === 2, 'Should find 2 high-confidence, high-uplift edges');\n      assert(effects[0].to_memory_id === 2, 'Highest impact should be first');\n    });\n  }\n\n  // ========================================================================\n  // ExplainableRecall Tests\n  // ========================================================================\n\n  testCertificateCreation() {\n    this.runTest('Certificate Creation and Storage', () => {\n      // Insert test episodes\n      const epStmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success)\n        VALUES (?, ?, ?, ?)\n      `);\n\n      for (let i = 1; i <= 5; i++) {\n        epStmt.run(`session${i}`, `task${i}`, 0.8, 1);\n      }\n\n      // Create certificate\n      const certId = crypto.randomUUID();\n      const chunkIds = ['1', '2', '3', '4'];\n      const minimalWhy = ['1', '2']; // Minimal hitting set\n      const merkleRoot = crypto.createHash('sha256').update('test').digest('hex');\n\n      const certStmt = this.db.prepare(`\n        INSERT INTO recall_certificates (\n          id, query_id, query_text, chunk_ids, chunk_types,\n          minimal_why, redundancy_ratio, completeness_score,\n          merkle_root, source_hashes, access_level, latency_ms\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `);\n\n      certStmt.run(\n        certId,\n        'q1',\n        'Test query',\n        JSON.stringify(chunkIds),\n        JSON.stringify(['episode', 'episode', 'episode', 'episode']),\n        JSON.stringify(minimalWhy),\n        chunkIds.length / minimalWhy.length, // redundancy ratio = 2\n        1.0, // completeness\n        merkleRoot,\n        JSON.stringify([merkleRoot, merkleRoot, merkleRoot, merkleRoot]),\n        'internal',\n        10\n      );\n\n      // Verify\n      const cert = this.db.prepare('SELECT * FROM recall_certificates WHERE id = ?').get(certId);\n      assert(cert !== null, 'Certificate should exist');\n      assert(cert.query_id === 'q1', 'Query ID should match');\n      assert(JSON.parse(cert.chunk_ids).length === 4, 'Should have 4 chunks');\n      assert(JSON.parse(cert.minimal_why).length === 2, 'Minimal set should be 2');\n      assert(cert.redundancy_ratio === 2, 'Redundancy ratio should be 2');\n      assert(cert.completeness_score === 1.0, 'Completeness should be 1.0');\n      assert(cert.merkle_root === merkleRoot, 'Merkle root should match');\n    });\n  }\n\n  testMerkleProofGeneration() {\n    this.runTest('Merkle Proof Generation and Verification', () => {\n      // Create Merkle tree\n      const leaves = ['chunk1', 'chunk2', 'chunk3', 'chunk4'].map(\n        content => crypto.createHash('sha256').update(content).digest('hex')\n      );\n\n      // Build tree (simplified 2-level tree)\n      const level1 = [];\n      for (let i = 0; i < leaves.length; i += 2) {\n        const combined = leaves[i] + (leaves[i + 1] || leaves[i]);\n        level1.push(crypto.createHash('sha256').update(combined).digest('hex'));\n      }\n\n      const root = crypto.createHash('sha256')\n        .update(level1[0] + (level1[1] || level1[0]))\n        .digest('hex');\n\n      assert(root.length === 64, 'Merkle root should be 64 hex characters');\n      assert(/^[0-9a-f]{64}$/.test(root), 'Merkle root should be valid SHA-256 hash');\n\n      log(`    Merkle root: ${root.substring(0, 16)}...`, 'cyan');\n    });\n  }\n\n  testProvenanceTracking() {\n    this.runTest('Provenance Source Tracking', () => {\n      // Insert test episodes\n      const epStmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success)\n        VALUES (?, ?, ?, ?)\n      `);\n\n      for (let i = 1; i <= 3; i++) {\n        epStmt.run(`session${i}`, `task${i}`, 0.8, 1);\n      }\n\n      // Create provenance sources\n      const provStmt = this.db.prepare(`\n        INSERT INTO provenance_sources (\n          source_type, source_id, content_hash, creator\n        ) VALUES (?, ?, ?, ?)\n      `);\n\n      const hash1 = crypto.createHash('sha256').update('content1').digest('hex');\n      const hash2 = crypto.createHash('sha256').update('content2').digest('hex');\n\n      const result1 = provStmt.run('episode', 1, hash1, 'test_user');\n      const result2 = provStmt.run('episode', 2, hash2, 'test_user');\n\n      assert(result1.lastInsertRowid > 0, 'First provenance should be inserted');\n      assert(result2.lastInsertRowid > 0, 'Second provenance should be inserted');\n\n      // Query lineage\n      const lineage = this.db.prepare(`\n        SELECT * FROM provenance_sources\n        WHERE content_hash = ?\n      `).get(hash1);\n\n      assert(lineage !== null, 'Lineage should exist');\n      assert(lineage.source_type === 'episode', 'Source type should match');\n      assert(lineage.creator === 'test_user', 'Creator should match');\n    });\n  }\n\n  testJustificationPaths() {\n    this.runTest('Justification Paths', () => {\n      // Create certificate first\n      const certId = crypto.randomUUID();\n      this.db.prepare(`\n        INSERT INTO recall_certificates (\n          id, query_id, query_text, chunk_ids, chunk_types,\n          minimal_why, redundancy_ratio, completeness_score,\n          merkle_root, source_hashes, access_level\n        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `).run(\n        certId, 'q2', 'Test query',\n        JSON.stringify(['1', '2']),\n        JSON.stringify(['episode', 'episode']),\n        JSON.stringify(['1']),\n        2, 1.0, 'hash', JSON.stringify(['hash1', 'hash2']), 'internal'\n      );\n\n      // Add justification paths\n      const justStmt = this.db.prepare(`\n        INSERT INTO justification_paths (\n          certificate_id, chunk_id, chunk_type, reason, necessity_score, path_elements\n        ) VALUES (?, ?, ?, ?, ?, ?)\n      `);\n\n      justStmt.run(certId, '1', 'episode', 'semantic_match', 0.9, JSON.stringify(['query', 'chunk1']));\n      justStmt.run(certId, '2', 'episode', 'causal_link', 0.7, JSON.stringify(['query', 'chunk1', 'chunk2']));\n\n      // Query justifications\n      const justifications = this.db.prepare(`\n        SELECT * FROM justification_paths\n        WHERE certificate_id = ?\n      `).all(certId);\n\n      assert(justifications.length === 2, 'Should have 2 justification paths');\n      assert(justifications[0].reason === 'semantic_match', 'First reason should match');\n      assert(justifications[1].reason === 'causal_link', 'Second reason should match');\n    });\n  }\n\n  // ========================================================================\n  // Integration Tests\n  // ========================================================================\n\n  testCausalRecallIntegration() {\n    this.runTest('Causal Recall Integration', () => {\n      // Insert episodes with embeddings\n      const epStmt = this.db.prepare(`\n        INSERT INTO episodes (session_id, task, reward, success, latency_ms)\n        VALUES (?, ?, ?, ?, ?)\n      `);\n\n      for (let i = 1; i <= 10; i++) {\n        epStmt.run(`session${i}`, `task${i}`, 0.7 + i * 0.02, 1, 50 + i * 5);\n      }\n\n      // Add embeddings\n      const embStmt = this.db.prepare(`\n        INSERT INTO episode_embeddings (episode_id, embedding)\n        VALUES (?, ?)\n      `);\n\n      for (let i = 1; i <= 10; i++) {\n        // Create mock embedding\n        const embedding = new Float32Array(384);\n        for (let j = 0; j < 384; j++) {\n          embedding[j] = Math.random();\n        }\n        embStmt.run(i, JSON.stringify(Array.from(embedding)));\n      }\n\n      // Add causal edges\n      const edgeStmt = this.db.prepare(`\n        INSERT INTO causal_edges (\n          from_memory_id, from_memory_type, to_memory_id, to_memory_type,\n          similarity, uplift, confidence\n        ) VALUES (?, ?, ?, ?, ?, ?, ?)\n      `);\n\n      edgeStmt.run(1, 'episode', 2, 'episode', 0.8, 0.15, 0.9);\n      edgeStmt.run(2, 'episode', 3, 'episode', 0.75, 0.2, 0.85);\n\n      // Verify integration\n      const episodes = this.db.prepare('SELECT COUNT(*) as count FROM episodes').get();\n      const embeddings = this.db.prepare('SELECT COUNT(*) as count FROM episode_embeddings').get();\n      const edges = this.db.prepare('SELECT COUNT(*) as count FROM causal_edges').get();\n\n      assert(episodes.count === 10, 'Should have 10 episodes');\n      assert(embeddings.count === 10, 'Should have 10 embeddings');\n      assert(edges.count === 2, 'Should have 2 causal edges');\n\n      log(`    Episodes: ${episodes.count}, Embeddings: ${embeddings.count}, Edges: ${edges.count}`, 'cyan');\n    });\n  }\n\n  testDatabasePerformance() {\n    this.runTest('Database Performance', () => {\n      // Insert many episodes for performance test\n      const start = Date.now();\n\n      this.db.transaction(() => {\n        const stmt = this.db.prepare(`\n          INSERT INTO episodes (session_id, task, reward, success)\n          VALUES (?, ?, ?, ?)\n        `);\n\n        for (let i = 1; i <= 1000; i++) {\n          stmt.run(`session${i}`, `task${i}`, Math.random(), 1);\n        }\n      })();\n\n      const insertTime = Date.now() - start;\n\n      // Query performance\n      const queryStart = Date.now();\n      const results = this.db.prepare('SELECT * FROM episodes WHERE reward > 0.5 LIMIT 100').all();\n      const queryTime = Date.now() - queryStart;\n\n      assert(results.length > 0, 'Should find episodes with reward > 0.5');\n      assert(insertTime < 1000, 'Bulk insert should be fast (< 1s for 1000 records)');\n      assert(queryTime < 50, 'Query should be fast (< 50ms)');\n\n      log(`    Insert 1000: ${insertTime}ms, Query: ${queryTime}ms`, 'cyan');\n    });\n  }\n\n  // ========================================================================\n  // Summary\n  // ========================================================================\n\n  runAll() {\n    log('\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'cyan');\n    log('  AgentDB Frontier Features Validation', 'cyan');\n    log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'cyan');\n\n    // CausalMemoryGraph tests\n    log('\\nğŸ“Š Testing CausalMemoryGraph', 'yellow');\n    this.testCausalEdgeInsertion();\n    this.testABExperiment();\n    this.testCausalQuery();\n\n    // ExplainableRecall tests\n    log('\\nğŸ” Testing ExplainableRecall', 'yellow');\n    this.testCertificateCreation();\n    this.testMerkleProofGeneration();\n    this.testProvenanceTracking();\n    this.testJustificationPaths();\n\n    // Integration tests\n    log('\\nğŸ”— Testing Integration', 'yellow');\n    this.testCausalRecallIntegration();\n    this.testDatabasePerformance();\n\n    // Print summary\n    log('\\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'cyan');\n    log('  Summary', 'cyan');\n    log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•', 'cyan');\n    log(`\\n  Total Tests: ${this.testsRun}`, 'cyan');\n    log(`  Passed: ${this.testsPassed}`, 'green');\n    log(`  Failed: ${this.testsFailed}`, this.testsFailed > 0 ? 'red' : 'cyan');\n\n    const passRate = ((this.testsPassed / this.testsRun) * 100).toFixed(1);\n    log(`  Pass Rate: ${passRate}%`, passRate === '100.0' ? 'green' : 'yellow');\n\n    if (this.testsFailed === 0) {\n      log('\\nâœ… ALL TESTS PASSED - FRONTIER FEATURES VALIDATED', 'green');\n    } else {\n      log(`\\nâŒ ${this.testsFailed} TEST(S) FAILED`, 'red');\n    }\n\n    log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n', 'cyan');\n\n    this.db.close();\n\n    return this.testsFailed === 0 ? 0 : 1;\n  }\n}\n\n// Run validation\nconst validator = new FrontierValidator();\nconst exitCode = validator.runAll();\nprocess.exit(exitCode);\n"]}