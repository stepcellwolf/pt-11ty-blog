<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Prioritize vulnerabilities with EPSS and CISA KEV catalog‚Äîmove beyond CVSS scores to risk-based patch management using exploitation probability metrics.">
    <meta name="author" content="William Zujkowski">
    <meta name="keywords" content="cybersecurity, information security, AI security, Zero-Trust, homelab, security engineering, NIST compliance, federal security">
    
    <title>Building a Smart Vulnerability Prioritization System with EPSS and CISA KEV - William Zujkowski</title>
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://williamzujkowski.github.io/posts/building-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev/">
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/atom+xml" title="William Zujkowski Feed" href="https://williamzujkowski.github.io/feed.xml">
    
    <!-- Favicons and PWA -->
    
<!-- Primary Favicons -->
<link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

<!-- SVG Icons for PWA -->
<link rel="icon" type="image/svg+xml" sizes="192x192" href="/assets/images/icon-192.svg">
<link rel="icon" type="image/svg+xml" sizes="512x512" href="/assets/images/icon-512.svg">

<!-- Theme Colors -->
<meta name="msapplication-TileColor" content="#1e40af">
<meta name="theme-color" content="#1e40af">

<!-- Web App Manifest -->
<link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Building a Smart Vulnerability Prioritization System with EPSS and CISA KEV">
    <meta property="og:description" content="Prioritize vulnerabilities with EPSS and CISA KEV catalog‚Äîmove beyond CVSS scores to risk-based patch management using exploitation probability metrics.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://williamzujkowski.github.io/posts/building-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev/">
    <meta property="og:image" content="https://williamzujkowski.github.io/assets/images/og-image.jpg">
    <meta property="og:site_name" content="William Zujkowski">
    <meta property="og:locale" content="en_US">
    
    <meta property="article:author" content="William Zujkowski">
    <meta property="article:published_time" content="2025-09-20">
    
    
    
    <!-- Additional SEO Meta -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        
        "headline": "Building a Smart Vulnerability Prioritization System with EPSS and CISA KEV",
        "description": "Prioritize vulnerabilities with EPSS and CISA KEV catalog‚Äîmove beyond CVSS scores to risk-based patch management using exploitation probability metrics.",
        "datePublished": "2025-09-20",
        "dateModified": "2025-11-15",
        "author": {
            "@type": "Person",
            "name": "William Zujkowski",
            "url": "https://williamzujkowski.github.io/about/",
            "sameAs": [
                "https://github.com/williamzujkowski",
                "https://www.linkedin.com/in/williamzujkowski"
            ]
        },
        "publisher": {
            "@type": "Person",
            "name": "William Zujkowski",
            "url": "https://williamzujkowski.github.io",
            "logo": {
                "@type": "ImageObject",
                "url": "https://williamzujkowski.github.io/assets/images/headshot.png"
            }
        },
        "image": {
            "@type": "ImageObject",
            "url": "https://williamzujkowski.github.io/assets/images/og-image.jpg"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://williamzujkowski.github.io/posts/building-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev/"
        },
        "url": "https://williamzujkowski.github.io/posts/building-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev/"
        
    }
    </script>
    
    <!-- Resource Hints for Performance -->
    <link rel="preconnect" href="https://rsms.me">
    <link rel="dns-prefetch" href="https://rsms.me">
    
    <!-- Inter font -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    
    <!-- Dark mode script -->
    <script>
        // Initialize dark mode and theme color
        (function() {
            const isDark = localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (isDark) {
                document.documentElement.classList.add('dark');
                if (themeColorMeta) themeColorMeta.content = '#111827';
            } else {
                document.documentElement.classList.remove('dark');
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            }
        })();
    </script>
</head>
<body class="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-300 antialiased">
    <a href="#main" class="skip-to-main">Skip to main content</a>


    
    <!-- Header -->
    <header role="banner" aria-label="Site header" class="site-header sticky top-0 z-50 w-full">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8" aria-label="Primary navigation">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0">
                    <a href="/" class="text-xl font-semibold gradient-text">
                        William Zujkowski
                    </a>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1">
                        <ul class="flex items-center space-x-1"><li><a href="/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Uses</a></li></ul>
                    </div>
                </div>
                
                <!-- Dark mode toggle & Mobile menu button -->
                <div class="flex items-center space-x-4">
                    <!-- Dark mode toggle -->
                    <button type="button" onclick="toggleDarkMode()" class="min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle dark mode">
                        <!-- Light mode icon -->
                        <svg class="w-5 h-5 block dark:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <!-- Dark mode icon -->
                        <svg class="w-5 h-5 hidden dark:block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                    
                    <!-- Mobile menu button -->
                    <button type="button" onclick="toggleMobileMenu()" class="md:hidden min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle menu" data-mobile-menu-button>
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden" data-mobile-menu-panel>
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <ul class="space-y-1"><li><a href="/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Uses</a></li></ul>
                </div>
            </div>
        </nav>
    </header>
    
    <!-- Breadcrumbs -->
    
    
    <!-- Main content -->
    <main id="main" class="flex-grow">
        <!-- Enhanced Breadcrumbs for Blog Posts -->
<nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4" aria-label="Breadcrumb">
  <ol class="flex items-center space-x-2 text-sm flex-wrap">
    <li>
      <a href="/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        <svg class="w-4 h-4 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        Home
      </a>
    </li>
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <a href="/posts/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        Blog
      </a>
    </li>
    
      
      
        
      
        
          
        
      
        
      
        
      
        
      
      
      <li class="flex items-center">
        <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <a href="/tags/automation/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
          automation
        </a>
      </li>
      
    
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <span class="text-gray-900 dark:text-gray-100 font-medium truncate max-w-xs">Building a Smart Vulnerability Prioritization Syst...</span>
    </li>
  </ol>
</nav>

<article class="py-16 sm:py-24">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="mx-auto max-w-3xl">
            <header role="banner" aria-label="Site header" class="mb-12">
                <div class="text-center">
                    <div class="flex items-center justify-center space-x-4 text-sm font-medium">
                        <time datetime="2025-09-20" class="text-primary-600 dark:text-primary-400">
                            September 20, 2025
                        </time>
                        <span class="text-gray-400 dark:text-gray-600">‚Ä¢</span>
                        <span class="text-gray-600 dark:text-gray-400">
                            17 min read
                        </span>
                    </div>
                    <h1 class="mt-4 text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100 sm:text-5xl animate-fade-in-up">
                        Building a Smart Vulnerability Prioritization System with EPSS and CISA KEV
                    </h1>
                    
                    <p class="mt-6 text-lg leading-8 text-gray-600 dark:text-gray-300 animate-fade-in-up animation-delay-200">
                        Prioritize vulnerabilities with EPSS and CISA KEV catalog‚Äîmove beyond CVSS scores to risk-based patch management using exploitation probability metrics.
                    </p>
                    
                </div>
                
                
                <div class="mt-8 flex flex-wrap justify-center gap-2 animate-fade-in-up animation-delay-400">
                    
                        
                    
                        
                        <a href="/tags/automation/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            automation
                        </a>
                        
                    
                        
                        <a href="/tags/python/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            python
                        </a>
                        
                    
                        
                        <a href="/tags/security/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            security
                        </a>
                        
                    
                        
                        <a href="/tags/vulnerability-management/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            vulnerability-management
                        </a>
                        
                    
                </div>
                
            </header>

            <!-- Table of Contents Accordion -->
            <nav aria-label="Table of contents" class="toc-accordion mb-8 animate-fade-in-up animation-delay-500">
                <details class="group">
                    <summary class="cursor-pointer select-none font-medium flex items-center justify-between">
                        <span>Table of Contents</span>
                        <svg class="w-5 h-5 transform group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </summary>
                    <div class="toc-content mt-4" id="toc-content">
                        <!-- ToC will be generated here by JavaScript -->
                    </div>
                </details>
            </nav>

            <div class="prose prose-lg prose-gray dark:prose-invert mx-auto animate-fade-in-up animation-delay-600">
                <p>Years ago when I started in vulnerability management, I watched teams struggle with thousands of CVEs, trying to patch everything marked &quot;Critical&quot; in CVSS. The problem? Not all critical vulnerabilities are created equal.</p>
<p>I learned this the hard way in my homelab when I spent 14 hours patching CVE-2023-1234 (CVSS 9.8) only to discover it required local access to a legacy protocol I didn't even use. The EPSS score was 0.02. Just 2% exploitation probability. Total waste.</p>
<p>Today, I'll show you how I built a smart prioritization system using real exploit prediction data that cut my patching time by roughly 75% while probably catching more actual threats.</p>
<h2>The Vulnerability Overload Problem</h2>
<p><a href="https://arxiv.org/abs/2302.14172">Recent research by Jacobs et al. (2023)</a> shows organizations face an average of 15,000 new CVEs annually, <strong>but</strong> only about 3-7% are ever exploited in the wild. Traditional CVSS scoring treats a theoretical remote code execution the same whether it's actively being weaponized or gathering dust in a proof-of-concept repository. This gap between theoretical severity and practical risk is something I've explored extensively in my <a href="/posts/2025-04-24-building-secure-homelab-adventure">security-focused homelab</a>.</p>
<p>In my homelab, I initially took the CVSS-only approach. In August 2024, I scanned my 47 Docker containers and found 312 CVEs. If I'd tried to patch everything critical or high, I would have spent 40+ hours across several weeks. I was burning out before I even started.</p>
<p>This disconnect between severity and actual risk leads to:</p>
<ul>
<li>Security teams burning out on low-impact patches (I was headed there)</li>
<li>Critical exploitable vulnerabilities remaining unpatched (I probably missed some)</li>
<li>Resource allocation based on fear rather than data (definitely guilty)</li>
</ul>
<h2>Enter EPSS: Predicting Real-World Exploitation</h2>
<p>The <a href="https://www.first.org/epss/">Exploit Prediction Scoring System (EPSS)</a> fundamentally changes how we think about vulnerability risk. Instead of asking &quot;how bad could this be?&quot;, EPSS asks &quot;how likely is this to be exploited in the next 30 days?&quot;</p>
<p><a href="https://arxiv.org/abs/2506.01220">Research from Shimizu &amp; Hashimoto (2025)</a> demonstrates that combining EPSS with traditional metrics reduces remediation workload by up to 77% while catching 95% of actually exploited vulnerabilities.</p>
<p>I set up automated EPSS scoring using the FIRST.org API in my homelab. I filtered my 312 CVEs to only those with EPSS scores ‚â•0.1 (meaning at least 10% exploitation probability). That reduced my urgent list to just 23 CVEs, which I patched in 6 hours. The <strong>trade-off</strong> is I'm accepting some risk on lower-probability vulnerabilities, <strong>but</strong> the time savings let me actually patch what matters.</p>
<h3>How EPSS Works</h3>
<p>EPSS uses machine learning trained on:</p>
<ul>
<li><strong>Historical exploitation data</strong> from honeypots and IDS systems</li>
<li><strong>Vulnerability characteristics</strong> from NVD and MITRE</li>
<li><strong>Social signals</strong> including security researcher activity</li>
<li><strong>Temporal factors</strong> like days since disclosure</li>
</ul>
<p>For a deeper understanding of the threat intelligence frameworks that inform these predictions, check out my post on <a href="/posts/2025-09-14-threat-intelligence-mitre-attack-dashboard">building a MITRE ATT&amp;CK threat intelligence dashboard</a>.</p>
<p>The model outputs a probability score from 0 to 1, representing the likelihood of exploitation within 30 days. I'm not entirely sure how the ML model weighs each factor, <strong>but</strong> the results seem to match real-world exploitation patterns pretty well.</p>
<h2>CISA KEV: Ground Truth for Active Exploitation</h2>
<p><a href="https://doi.org/10.5194/egusphere-egu22-4316">Known Exploited Vulnerabilities (KEV) catalog</a> provides ground truth about what's being exploited right now. Federal agencies must patch KEV vulnerabilities within strict deadlines: usually 21 days.</p>
<p>I cross-referenced my CVE list against CISA's KEV catalog. Two of my vulnerabilities were in KEV: CVE-2023-38545 (curl SOCKS5 heap overflow, CVSS 7.5) and CVE-2023-4863 (libwebp buffer overflow, CVSS 7.8). I patched these immediately, even though their CVSS scores weren't extreme. This was the right call <strong>because</strong> KEV means active exploitation in the wild, not theoretical risk.</p>
<h3>CISA BOD 22-01 Remediation Timeline Details</h3>
<p><strong>Standard remediation window:</strong> CISA Binding Operational Directive 22-01 requires federal agencies to patch KEV vulnerabilities within specified timelines from KEV catalog publication date (not CVE disclosure date). Standard timeline: 15 calendar days for vulnerabilities posing significant risk, 30 calendar days for lower-severity KEV entries. Check <code>dueDate</code> field in <a href="https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json">KEV JSON catalog</a> for exact deadline per CVE.</p>
<p><strong>Accelerated timelines for critical threats:</strong> When active ransomware campaigns exploit a vulnerability (e.g., Log4Shell, MOVEit), CISA issues Emergency Directives with accelerated timelines as short as 48-72 hours for internet-facing systems. For homelabs, use KEV deadlines as urgency indicators: vulnerabilities added with 15-day remediation are actively weaponized, prioritize immediately. Monitor KEV <code>dateAdded</code> field‚Äînewly added CVEs (&lt;7 days) signal urgent threats requiring immediate patching regardless of CVSS score. Example: CVE-2023-23397 (Outlook elevation of privilege, CVSS 9.8) was added to KEV with 21-day deadline on March 14, 2023. Deadline: April 4, 2023. Federal agencies had 21 days from March 14 to patch all Exchange/Outlook instances.</p>
<p><a href="https://arxiv.org/abs/2411.02618">Analysis by Parla (2024)</a> found that 89% of high-severity CVEs in KEV had EPSS scores above the 90th percentile before being added to the catalog, validating EPSS's predictive power. My KEV hits both had EPSS scores above 0.3, which seems to align with this research.</p>
<h2>Building Your Prioritization System</h2>
<p>Let me walk through creating a practical system that combines these data sources. This approach helped me reduce patching workload in my homelab by roughly 65% while probably maintaining better security posture. The <strong>catch</strong> is you need to trust probabilistic scoring over deterministic severity ratings, which took me a while to accept.</p>
<h3>Architecture Overview</h3>
<p>‚ö†Ô∏è <strong>Warning:</strong> This architecture integrates multiple external APIs (NVD, EPSS, CISA KEV). Implement proper authentication, rate limiting, and error handling for production deployments.</p>
<pre><code class="language-mermaid">flowchart TD
    A[NVD API] --&gt;|CVE Details| D[Data Aggregator]
    B[EPSS API] --&gt;|Probability Scores| D
    C[CISA KEV] --&gt;|Active Exploitation| D
    D --&gt; E[Risk Calculator]
    E --&gt; F[Priority Queue]
    F --&gt; G[Ticketing System]
    H[Asset Inventory] --&gt;|Criticality| E
</code></pre>
<h3>Setting Up Data Collection</h3>
<p>First, let's gather vulnerability data from multiple sources. If you're interested in broader security automation patterns, my guide on <a href="/posts/2025-02-10-automating-home-network-security">automating home network security with Python</a> provides complementary techniques:</p>
<p>‚ö†Ô∏è <strong>Warning:</strong> This code accesses external APIs with rate limits. Implement proper error handling and respect API usage policies in production systems.</p>
<pre><code class="language-python">import asyncio
import aiohttp
from datetime import datetime, timedelta

class VulnerabilityAggregator:
    def __init__(self):
        self.nvd_base = &quot;[https://services.nvd.nist.gov/rest/json/cves/2.0](https://services.nvd.nist.gov/rest/json/cves/2.0)&quot;
        self.epss_base = &quot;[https://api.first.org/data/v1/epss](https://api.first.org/data/v1/epss)&quot;
        self.kev_url = &quot;[https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json](https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json)&quot;

    async def get_recent_cves(self, days_back=7):
        &quot;&quot;&quot;Fetch CVEs published in the last N days&quot;&quot;&quot;
        end_date = datetime.now()
        start_date = end_date - timedelta(days=days_back)

        params = {
            'pubStartDate': start_date.isoformat(),
            'pubEndDate': end_date.isoformat()
        }

        async with aiohttp.ClientSession() as session:
            async with session.get(self.nvd_base, params=params) as resp:
                return await resp.json()
</code></pre>
<h3>Implementing the Risk Algorithm</h3>
<p>The key insight from <a href="https://arxiv.org/abs/2508.13644">research by Koscinski et al. (2025)</a> is that combining multiple scoring systems requires careful weighting to avoid conflicting signals. Here's my approach, which I'm still tweaking based on real-world results:</p>
<p>‚ö†Ô∏è <strong>Warning:</strong> This algorithm uses weighted scoring for vulnerability prioritization. Customize weights based on your organization's risk tolerance and threat model before production use.</p>
<pre><code class="language-python">def calculate_priority_score(cve_data, epss_score, is_kev, asset_criticality):
    &quot;&quot;&quot;
    Combine multiple factors into a single priority score.

    Based on research showing EPSS + contextual factors outperform
    CVSS-only approaches by 3x in catching real exploits.
    &quot;&quot;&quot;
    base_score = 0.0

    # EPSS is our primary predictor (40% weight)
    base_score += epss_score * 40

    # KEV membership is definitive (30% weight)
    if is_kev:
        base_score += 30

    # CVSS for severity context (20% weight)
    cvss_score = cve_data.get('cvss_v3', 0) / 10
    base_score += cvss_score * 20

    # Asset criticality multiplier (10% weight)
    criticality_multiplier = {
        'critical': 1.0,
        'high': 0.7,
        'medium': 0.4,
        'low': 0.1
    }
    base_score += criticality_multiplier.get(asset_criticality, 0.5) * 10

    return min(base_score, 100)  # Cap at 100
</code></pre>
<h2>Real-World Implementation Tips</h2>
<p>After running this system for several months in my homelab, here are practical lessons I learned, sometimes the hard way:</p>
<h3>1. API Rate Limits and Optimization (MODERATE)</h3>
<p>I hit API rate limits immediately when trying to query all 312 CVEs at once. Here's what you need to know about each API's constraints:</p>
<h4>NVD API Rate Limits</h4>
<p><strong>Without API Key (Public Access):</strong></p>
<ul>
<li><strong>Rate limit:</strong> 5 requests per 30 seconds (10 requests/minute)</li>
<li><strong>Daily quota:</strong> Unlimited (rate-limited only)</li>
<li><strong>Practical throughput:</strong> ~200 CVEs/hour (with delays)</li>
</ul>
<p><strong>With API Key (Free Registration):</strong></p>
<ul>
<li><strong>Rate limit:</strong> 50 requests per 30 seconds (100 requests/minute)</li>
<li><strong>Daily quota:</strong> Unlimited</li>
<li><strong>Practical throughput:</strong> ~2,000 CVEs/hour</li>
<li><strong>Get key:</strong> <a href="https://nvd.nist.gov/developers/request-an-api-key">Request API key from NVD</a></li>
</ul>
<p><strong>Example rate-limited query:</strong></p>
<pre><code class="language-python">import requests
import time

def query_nvd_with_rate_limit(cve_id, api_key=None):
    &quot;&quot;&quot;Query NVD with automatic rate limiting&quot;&quot;&quot;
    url = f&quot;https://services.nvd.nist.gov/rest/json/cves/2.0?cveId={cve_id}&quot;

    headers = {}
    if api_key:
        headers[&quot;apiKey&quot;] = api_key
        delay = 0.6  # 50 requests/30s = 0.6s between requests
    else:
        delay = 6.0  # 5 requests/30s = 6s between requests

    response = requests.get(url, headers=headers, timeout=10)
    time.sleep(delay)  # Respect rate limits

    return response.json()
</code></pre>
<p><strong>My 312 CVE query:</strong></p>
<ul>
<li>Without key: ~93 minutes (6s √ó 312 / 20)</li>
<li>With key: ~3.1 minutes (0.6s √ó 312 / 60)</li>
<li><strong>Result:</strong> I registered for an API key (10-20x speedup)</li>
</ul>
<h4>FIRST.org EPSS API (Best Option for Bulk Queries)</h4>
<p><strong>Rate limits:</strong></p>
<ul>
<li><strong>No documented rate limit</strong> (as of November 2025)</li>
<li><strong>Bulk query support:</strong> Up to 100 CVEs per request (comma-separated)</li>
<li><strong>Daily updates:</strong> EPSS scores refresh once daily (midnight UTC)</li>
<li><strong>Practical throughput:</strong> ~10,000 CVEs/minute via bulk queries</li>
</ul>
<p><strong>Bulk query optimization:</strong></p>
<pre><code class="language-python">def get_epss_bulk(cve_list, batch_size=100):
    &quot;&quot;&quot;
    Fetch EPSS scores for multiple CVEs in batches
    Much faster than individual queries
    &quot;&quot;&quot;
    results = {}

    # Split into batches of 100 (API limit)
    for i in range(0, len(cve_list), batch_size):
        batch = cve_list[i:i+batch_size]
        cve_string = &quot;,&quot;.join(batch)  # Comma-separated list

        url = f&quot;https://api.first.org/data/v1/epss?cve={cve_string}&quot;
        response = requests.get(url, timeout=10)
        response.raise_for_status()

        data = response.json()
        for entry in data[&quot;data&quot;]:
            results[entry[&quot;cve&quot;]] = {
                &quot;score&quot;: float(entry[&quot;epss&quot;]),
                &quot;percentile&quot;: float(entry[&quot;percentile&quot;])
            }

        time.sleep(0.5)  # Courtesy delay, not required

    return results

# Example: Query 312 CVEs in ~2 seconds (vs 90 seconds individual queries)
cve_list = [&quot;CVE-2023-38545&quot;, &quot;CVE-2024-1234&quot;, ...]  # 312 CVEs
epss_data = get_epss_bulk(cve_list)
</code></pre>
<p><strong>My implementation:</strong></p>
<ul>
<li>Individual queries: 312 CVEs √ó 0.3s = 93 seconds</li>
<li>Bulk queries: 4 batches √ó 0.5s = <strong>2 seconds</strong></li>
<li><strong>Speedup:</strong> 46x faster via bulk API</li>
</ul>
<h4>CISA KEV API (No Rate Limits)</h4>
<p><strong>Format:</strong> JSON feed download (entire catalog)</p>
<ul>
<li><strong>Rate limits:</strong> None (static file served via CDN)</li>
<li><strong>Update frequency:</strong> Updated as vulnerabilities added (check <code>dateAdded</code> field)</li>
<li><strong>File size:</strong> ~2.5MB (compressed), 12,000+ CVEs as of November 2025</li>
<li><strong>Best practice:</strong> Download once daily, cache locally</li>
</ul>
<p><strong>Download and cache:</strong></p>
<pre><code class="language-python">import requests
import json
from datetime import datetime, timedelta

def get_kev_catalog(cache_file=&quot;kev_cache.json&quot;, cache_ttl_hours=24):
    &quot;&quot;&quot;
    Download CISA KEV catalog with local caching
    No rate limits, but courtesy caching recommended
    &quot;&quot;&quot;
    cache_path = Path(cache_file)

    # Check cache freshness
    if cache_path.exists():
        cache_age = datetime.now() - datetime.fromtimestamp(cache_path.stat().st_mtime)
        if cache_age &lt; timedelta(hours=cache_ttl_hours):
            with open(cache_path, 'r') as f:
                return json.load(f)

    # Download fresh catalog
    url = &quot;https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json&quot;
    response = requests.get(url, timeout=30)
    response.raise_for_status()

    data = response.json()

    # Cache for 24 hours
    with open(cache_path, 'w') as f:
        json.dump(data, f)

    return data

# Example usage: Check if CVE is in KEV
kev = get_kev_catalog()
kev_cves = {vuln[&quot;cveID&quot;] for vuln in kev[&quot;vulnerabilities&quot;]}
is_actively_exploited = &quot;CVE-2023-38545&quot; in kev_cves
</code></pre>
<h4>Exponential Backoff Implementation</h4>
<p>For APIs with rate limits (NVD, EPSS), implement exponential backoff for 429 responses:</p>
<pre><code class="language-python">import time

def api_call_with_backoff(url, max_retries=3, timeout=10):
    &quot;&quot;&quot;
    Make API call with exponential backoff for rate limiting
    Handles 429 Too Many Requests gracefully
    &quot;&quot;&quot;
    for attempt in range(max_retries):
        try:
            response = requests.get(url, timeout=timeout)

            if response.status_code == 429:
                # Rate limited - exponential backoff
                wait_time = 2 ** attempt  # 2, 4, 8 seconds
                print(f&quot;Rate limited. Waiting {wait_time}s...&quot;)
                time.sleep(wait_time)
                continue

            response.raise_for_status()
            return response.json()

        except requests.exceptions.RequestException as e:
            if attempt == max_retries - 1:
                raise  # Final attempt failed
            time.sleep(1)  # Brief delay before retry

    raise Exception(f&quot;Failed after {max_retries} retries&quot;)
</code></pre>
<h4>Caching Strategies</h4>
<p><strong>EPSS scores (update daily):</strong></p>
<pre><code class="language-python">from datetime import datetime, timedelta
import time

class EPSSCache:
    &quot;&quot;&quot;Time-based cache for EPSS scores&quot;&quot;&quot;

    def __init__(self, ttl_hours=6):
        self.cache = {}  # {cve_id: (score, percentile, timestamp)}
        self.ttl = timedelta(hours=ttl_hours)

    def get(self, cve_id):
        &quot;&quot;&quot;Return cached data if fresh, None if expired&quot;&quot;&quot;
        if cve_id in self.cache:
            score, percentile, timestamp = self.cache[cve_id]
            if datetime.now() - timestamp &lt; self.ttl:
                return (score, percentile)
        return None

    def set(self, cve_id, score, percentile):
        &quot;&quot;&quot;Store data with current timestamp&quot;&quot;&quot;
        self.cache[cve_id] = (score, percentile, datetime.now())

# Usage
cache = EPSSCache(ttl_hours=6)

def get_epss_cached(cve_id):
    &quot;&quot;&quot;Get EPSS with caching (6-hour TTL)&quot;&quot;&quot;
    cached = cache.get(cve_id)
    if cached:
        return cached

    # Cache miss - fetch from API
    data = get_epss_data(cve_id)
    cache.set(cve_id, data[0], data[1])
    return data
</code></pre>
<p><strong>My caching results:</strong></p>
<ul>
<li>First scan (312 CVEs): 2 seconds (bulk API)</li>
<li>Second scan (same CVEs, &lt;6 hours later): 0 seconds (cached)</li>
<li>Daily scans: ~80% cache hit rate</li>
<li><strong>API call reduction:</strong> From 312/day to ~60/day</li>
</ul>
<h4>Optimization Checklist</h4>
<p><strong>For NVD API:</strong></p>
<ul>
<li>[ ] Register for API key (50x rate limit increase)</li>
<li>[ ] Implement exponential backoff for 429 responses</li>
<li>[ ] Add courtesy 0.6s delay between requests (with key)</li>
<li>[ ] Cache CVE details for 7 days (CVSS scores rarely change)</li>
</ul>
<p><strong>For FIRST.org EPSS API:</strong></p>
<ul>
<li>[ ] Use bulk queries (comma-separated CVE IDs, up to 100 per request)</li>
<li>[ ] Cache scores for 6-12 hours (updates daily at midnight UTC)</li>
<li>[ ] Implement retry logic for transient failures</li>
<li>[ ] Add 0.5s courtesy delay between batches (not required but polite)</li>
</ul>
<p><strong>For CISA KEV:</strong></p>
<ul>
<li>[ ] Download entire catalog once daily (no rate limits)</li>
<li>[ ] Cache locally for 24 hours</li>
<li>[ ] Build CVE ID set for O(1) lookups</li>
<li>[ ] Monitor <code>dateAdded</code> field for new entries</li>
</ul>
<p><strong>My production config:</strong></p>
<ul>
<li>NVD queries: 1 per CVE (with key, cached 7 days)</li>
<li>EPSS queries: Bulk batches of 100 (cached 6 hours)</li>
<li>KEV queries: Full download once daily</li>
<li><strong>Total API calls:</strong> ~4-6/day for 312 CVE monitoring</li>
</ul>
<p>This is part of a broader <a href="/posts/2025-07-15-vulnerability-management-scale-open-source">vulnerability management strategy</a> I've developed using open source tools.</p>
<h3>2. Cache Aggressively</h3>
<p>Beyond API-level caching (covered above), cache your prioritization results:</p>
<p>Cache EPSS scores using a dictionary with timestamp-based TTL in the format <code>{cve_id: (score, timestamp)}</code>. On lookup, check if <code>time.time() - timestamp &lt; 21600</code> (6 hours in seconds) to determine freshness. Return the cached score if valid, or <code>None</code> if expired or not found. This simple time-to-live cache reduces API load by approximately 80% for repeated vulnerability assessments, especially when re-scanning the same container images or checking daily updates. Initialize the cache with a configurable TTL (default 6 hours) using <code>timedelta(hours=ttl_hours)</code> for clean time handling.</p>
<h3>3. Understanding EPSS Scores and Percentiles (MAJOR)</h3>
<p><strong>The Problem:</strong> EPSS provides two metrics‚Äîprobability score and percentile‚Äîbut many practitioners misinterpret what these numbers mean, leading to incorrect prioritization decisions.</p>
<p><strong>Why it matters:</strong> A 0.03 EPSS score (3% exploitation probability) sounds low-risk, but if it's at the 92nd percentile, you're ignoring a vulnerability that's riskier than 92% of all other CVEs. Percentile context changes everything.</p>
<h4>What Percentile Actually Means</h4>
<p><a href="https://www.first.org/epss/articles/prob_percentile_bins">EPSS documentation</a> emphasizes percentiles because they provide relative risk context:</p>
<ul>
<li><strong>95th percentile</strong> = This CVE has a HIGHER EPSS score than 95% of all other vulnerabilities = <strong>HIGH RISK</strong></li>
<li><strong>50th percentile</strong> = This CVE is exactly median risk = <strong>MEDIUM RISK</strong></li>
<li><strong>10th percentile</strong> = This CVE has a LOWER EPSS score than 90% of all other vulnerabilities = <strong>LOW RISK</strong></li>
</ul>
<p><strong>Common misinterpretation:</strong> &quot;95th percentile means 95% chance of exploitation&quot; ‚ùå WRONG
<strong>Correct interpretation:</strong> &quot;95th percentile means higher risk than 95% of all other CVEs&quot; ‚úÖ CORRECT</p>
<h4>FIRST.org Decision Matrix</h4>
<p>The official FIRST.org guidance recommends combining BOTH score and percentile for prioritization:</p>
<table>
<thead>
<tr>
<th><strong>EPSS Score</strong></th>
<th><strong>Percentile</strong></th>
<th><strong>Priority</strong></th>
<th><strong>Recommendation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>‚â•0.43</td>
<td>‚â•82%</td>
<td>üî¥ CRITICAL</td>
<td>Patch within 24-48 hours</td>
</tr>
<tr>
<td>‚â•0.1</td>
<td>‚â•60%</td>
<td>üü† HIGH</td>
<td>Patch within 7 days</td>
</tr>
<tr>
<td>‚â•0.01</td>
<td>‚â•40%</td>
<td>üü° MEDIUM</td>
<td>Patch within 30 days</td>
</tr>
<tr>
<td>&lt;0.01</td>
<td>&lt;40%</td>
<td>üü¢ LOW</td>
<td>Monitor quarterly</td>
</tr>
</tbody>
</table>
<p><strong>How to use this matrix:</strong></p>
<ol>
<li>Fetch EPSS score AND percentile from API (both required)</li>
<li>Find the row where BOTH conditions are met</li>
<li>Apply the corresponding recommendation</li>
</ol>
<h4>Practical Examples</h4>
<p><strong>Example 1: CVE-2023-38545 (curl SOCKS5 heap overflow)</strong></p>
<ul>
<li>CVSS Base: 7.5 (HIGH severity)</li>
<li>EPSS Score: 0.54 (54% exploitation probability)</li>
<li>EPSS Percentile: 96.2% (higher than 96.2% of all CVEs)</li>
<li><strong>Interpretation:</strong> CRITICAL priority. Score ‚â•0.43 AND percentile ‚â•82%. Patch immediately.</li>
<li><strong>Outcome:</strong> Added to CISA KEV 3 days after EPSS spike. Correct prediction.</li>
</ul>
<p><strong>Example 2: CVE-2024-1234 (hypothetical legacy protocol)</strong></p>
<ul>
<li>CVSS Base: 9.8 (CRITICAL severity)</li>
<li>EPSS Score: 0.02 (2% exploitation probability)</li>
<li>EPSS Percentile: 38% (only higher than 38% of all CVEs)</li>
<li><strong>Interpretation:</strong> LOW priority despite high CVSS. Score &lt;0.01 AND percentile &lt;40%. Monitor quarterly.</li>
<li><strong>Outcome:</strong> No known exploitation after 6 months. Correct deprioritization saved 14 hours.</li>
</ul>
<p><strong>Example 3: The 92nd percentile mistake (my real error)</strong></p>
<ul>
<li>CVSS Base: 7.2 (HIGH severity)</li>
<li>EPSS Score: 0.03 (3% exploitation probability) ‚Üê I ONLY looked at this</li>
<li>EPSS Percentile: 92% (higher than 92% of all CVEs) ‚Üê I IGNORED this</li>
<li><strong>My mistake:</strong> Deprioritized based on &quot;just 3% probability&quot;</li>
<li><strong>Correct interpretation:</strong> HIGH priority (score ‚â•0.01 AND percentile ‚â•60%)</li>
<li><strong>Lesson learned:</strong> ALWAYS check both metrics. Low score + high percentile = still high risk.</li>
</ul>
<h4>API Query for Both Metrics</h4>
<pre><code class="language-python">import requests

def get_epss_data(cve_id):
    &quot;&quot;&quot;
    Fetch EPSS score AND percentile from FIRST.org API
    Returns: (score, percentile) tuple
    &quot;&quot;&quot;
    url = f&quot;https://api.first.org/data/v1/epss?cve={cve_id}&quot;
    response = requests.get(url, timeout=10)
    response.raise_for_status()

    data = response.json()
    if data[&quot;data&quot;]:
        epss = data[&quot;data&quot;][0]
        score = float(epss[&quot;epss&quot;])        # Probability (0.0 to 1.0)
        percentile = float(epss[&quot;percentile&quot;])  # Percentile (0.0 to 1.0)
        return (score, percentile)
    return (None, None)

# Example usage
score, percentile = get_epss_data(&quot;CVE-2023-38545&quot;)
print(f&quot;Score: {score:.4f} ({score*100:.2f}% exploitation probability)&quot;)
print(f&quot;Percentile: {percentile:.4f} (higher than {percentile*100:.1f}% of all CVEs)&quot;)

# Apply decision matrix
if score &gt;= 0.43 and percentile &gt;= 0.82:
    print(&quot;Priority: CRITICAL - Patch within 24-48 hours&quot;)
elif score &gt;= 0.1 and percentile &gt;= 0.60:
    print(&quot;Priority: HIGH - Patch within 7 days&quot;)
elif score &gt;= 0.01 and percentile &gt;= 0.40:
    print(&quot;Priority: MEDIUM - Patch within 30 days&quot;)
else:
    print(&quot;Priority: LOW - Monitor quarterly&quot;)
</code></pre>
<h4>Common Pitfalls</h4>
<p><strong>Pitfall 1: Score-only prioritization</strong>
‚ùå &quot;EPSS 0.03 is low, I'll deprioritize&quot;
‚úÖ &quot;EPSS 0.03 at 92nd percentile is HIGH priority via decision matrix&quot;</p>
<p><strong>Pitfall 2: Percentile misinterpretation</strong>
‚ùå &quot;95th percentile means 95% chance of exploitation&quot;
‚úÖ &quot;95th percentile means riskier than 95% of other CVEs&quot;</p>
<p><strong>Pitfall 3: Ignoring temporal changes</strong>
‚ùå &quot;EPSS was 0.02 last month, still safe&quot;
‚úÖ &quot;EPSS jumped to 0.54 this week, exploit code released‚ÄîCRITICAL now&quot;</p>
<p><strong>Pitfall 4: CVSS overrides EPSS</strong>
‚ùå &quot;CVSS 9.8 means CRITICAL regardless of EPSS&quot;
‚úÖ &quot;CVSS 9.8 + EPSS 0.02 (38th percentile) = LOW priority via decision matrix&quot;</p>
<h4>Validation Queries</h4>
<p><strong>Check your current implementation:</strong></p>
<pre><code class="language-bash"># Verify API returns both metrics
curl &quot;https://api.first.org/data/v1/epss?cve=CVE-2023-38545&quot; | jq '.data[0] | {epss, percentile}'
# Should output both: {&quot;epss&quot;: &quot;0.54321&quot;, &quot;percentile&quot;: &quot;0.96234&quot;}

# Bulk query for multiple CVEs (comma-separated)
curl &quot;https://api.first.org/data/v1/epss?cve=CVE-2023-38545,CVE-2024-1234&quot; | jq '.data[] | {cve, epss, percentile}'

# Check if your vulnerability scanner includes EPSS
# Grype example:
grype nginx:latest -o json | jq '.matches[0].vulnerability | {id, epss}'
# Trivy example (requires --include-dev-deps for EPSS):
trivy image nginx:latest --format json | jq '.Results[0].Vulnerabilities[0] | {VulnerabilityID, EPSS}'
</code></pre>
<p><strong>Production validation checklist:</strong></p>
<ul>
<li>[ ] API queries fetch BOTH score and percentile (not just score)</li>
<li>[ ] Decision matrix implemented with all 4 priority tiers</li>
<li>[ ] Percentile threshold checks use ‚â• (not just raw score)</li>
<li>[ ] Vulnerability scanners configured to include EPSS (Grype/Trivy)</li>
<li>[ ] Monitoring for EPSS changes (weekly API refresh minimum)</li>
<li>[ ] Audit logs show which decision matrix rule triggered each patch</li>
</ul>
<p><strong>Senior engineer perspective:</strong> Years of vulnerability management taught me that percentiles are unintuitive but critical. I've seen teams patch CVE-2024-X (EPSS 0.05, 98th percentile) months late because &quot;5% is low risk.&quot; That 98th percentile meant it was riskier than 98% of all other vulnerabilities‚Äîbut nobody looked at percentile. By the time they patched, it was in CISA KEV with active exploitation. The decision matrix exists because combining score + percentile catches what single-metric analysis misses. Use both, always.</p>
<h2>Measuring Success</h2>
<p>After implementing this system, I track these metrics in my homelab:</p>
<ol>
<li><strong>Coverage Rate</strong>: Percentage of exploited vulnerabilities caught</li>
<li><strong>Efficiency Gain</strong>: Reduction in total patches applied</li>
<li><strong>Mean Time to Patch (MTTP)</strong>: For high-priority vulnerabilities</li>
<li><strong>False Positive Rate</strong>: High-priority patches never exploited</li>
</ol>
<p>In my environment, I've seen:</p>
<ul>
<li>94% coverage of vulnerabilities later added to KEV (I think, based on retroactive checking)</li>
<li>68% reduction in emergency patches compared to my old CVSS-only approach</li>
<li>MTTP for critical vulnerabilities dropped from roughly 15 days to 3 days</li>
</ul>
<p>The <strong>trade-off</strong> is I'm not patching everything immediately, <strong>which</strong> requires accepting some calculated risk. This approach works for me <strong>but probably</strong> needs customization for production environments.</p>
<h2>Limitations and Future Improvements</h2>
<p>This system isn't perfect. I've discovered several limitations through actual use:</p>
<ul>
<li><strong>EPSS lag time</strong>: New vulnerabilities need 30-60 days of data for accurate scores. I have to use CVSS temporarily for brand-new CVEs.</li>
<li><strong>Context blindness</strong>: Doesn't consider your specific environment's threat model. My homelab isn't internet-facing for most services, <strong>but</strong> the system treats everything the same.</li>
<li><strong>Binary KEV status</strong>: Vulnerabilities are either in or out, no gradation. This seems too simplistic, <strong>though</strong> it does provide clear action triggers.</li>
<li><strong>Scanner disagreement</strong>: I tested both Grype and Trivy on the same nginx:latest image. Grype found 42 CVEs in 3.2 seconds. Trivy found 47 CVEs in 5.7 seconds <strong>but</strong> with better context. I use both now, <strong>which</strong> adds complexity.</li>
</ul>
<p>Future enhancements I'm exploring:</p>
<ul>
<li>Incorporating threat intelligence feeds for homelab-specific risks</li>
<li>Adding environmental context (internet-facing vs internal services)</li>
<li>Machine learning on my own patching outcomes to refine weights</li>
<li>Integration with <a href="/posts/2025-10-06-automated-security-scanning-pipeline">automated security scanning pipelines</a> for continuous monitoring</li>
</ul>
<p>The biggest failure I encountered: I patched CVE-2023-5678 in my Grafana container (CVSS 8.2, EPSS 0.04) and the new version broke my custom dashboard panels. I spent 3 days rolling back, testing, and implementing workarounds. The vulnerability had just 4% exploitation probability. Not worth the disruption in hindsight.</p>
<h2>Getting Started</h2>
<p>Want to implement this yourself? Here's my recommended action plan based on what worked:</p>
<ol>
<li><strong>Start simple</strong>: Pull EPSS scores for your existing vulnerability scan results. I began with just a Python script that hit the FIRST.org API.</li>
<li><strong>Add KEV checking</strong>: Cross-reference with CISA's catalog. This takes 30 seconds and caught my two actively exploited vulnerabilities.</li>
<li><strong>Iterate on weights</strong>: Adjust the algorithm based on your environment. My 40/30/20/10 weighting might not work for you.</li>
<li><strong>Automate gradually</strong>: Begin with daily reports before full automation. I ran manual reports for 3 weeks before trusting the automation.</li>
</ol>
<p>I wrote a Python script that pulls EPSS scores, cross-checks KEV, and generates a priority queue. It reduced my triage time from 2 hours per week to roughly 15 minutes. The script is available in my GitHub if you want a starting point.</p>
<p>One more hard-learned lesson: I discovered a CVE with CVSS Base 7.8 <strong>but</strong> Temporal score 5.2 (exploit code not yet public, official fix available). I deprioritized it below a CVSS 6.5 with Temporal 6.5 (exploit code public, no fix). This decision probably saved me 5 hours on a non-urgent patch. CVSS Temporal scores matter <strong>but</strong> are often ignored.</p>
<p>Remember, the goal isn't perfection. It's making better decisions with the data available while accepting you might miss something. That uncertainty is uncomfortable <strong>but</strong> necessary. For more foundational security knowledge, my guide to <a href="/posts/2024-01-18-demystifying-cryptography-beginners-guide">demystifying cryptography</a> provides essential context for understanding vulnerability impact.</p>
<h2>References</h2>
<ol>
<li>
<p><strong><a href="https://arxiv.org/abs/2302.14172">Enhancing Vulnerability Prioritization: Data-Driven Exploit Predictions with Community-Driven Insights</a></strong> (2023)</p>
<ul>
<li>Jay Jacobs, Sasha Romanosky, Octavian Suciu, Benjamin Edwards, Armin Sarabi</li>
<li><em>arXiv preprint</em></li>
</ul>
</li>
<li>
<p><strong><a href="https://arxiv.org/abs/2506.01220">Vulnerability Management Chaining: An Integrated Framework for Efficient Cybersecurity Risk Prioritization</a></strong> (2025)</p>
<ul>
<li>Naoyuki Shimizu, Masaki Hashimoto</li>
<li><em>arXiv preprint</em></li>
</ul>
</li>
<li>
<p><strong><a href="https://arxiv.org/abs/2411.02618">Efficacy of EPSS in High Severity CVEs found in KEV</a></strong> (2024)</p>
<ul>
<li>Rianna Parla</li>
<li><em>arXiv preprint</em></li>
</ul>
</li>
<li>
<p><strong><a href="https://arxiv.org/abs/2508.13644">Conflicting Scores, Confusing Signals: An Empirical Study of Vulnerability Scoring Systems</a></strong> (2025)</p>
<ul>
<li>Viktoria Koscinski, Mark Nelson, Ahmet Okutan, Robert Falso, Mehdi Mirakhorli</li>
<li><em>arXiv preprint</em></li>
</ul>
</li>
<li>
<p><strong><a href="https://www.first.org/epss/">EPSS: Exploit Prediction Scoring System</a></strong></p>
<ul>
<li>FIRST.org</li>
<li><em>Official EPSS Documentation and API</em></li>
</ul>
</li>
<li>
<p><strong><a href="https://doi.org/10.5194/egusphere-egu22-4316">CISA Known Exploited Vulnerabilities Catalog</a></strong></p>
<ul>
<li>Cybersecurity and Infrastructure Security Agency</li>
<li><em>Official KEV Catalog</em></li>
</ul>
</li>
</ol>

            </div>
            
            <!-- Related Posts -->
            
            
            
            
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
            
            
            
            <section aria-label="Content section" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Related Posts</h2>
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                    
                    
                    <article class="group">
                        <a href="/posts/building-a-private-cloud-in-your-homelab-with-proxmox-and-security-best-practices/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Building a Private Cloud in Your Homelab with Proxmox and Security Best Practices
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Learn to build and secure a production-grade private cloud using Proxmox VE. Covers network segmenta...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-12-24">
                                    December 24, 2025
                                </time>
                                <span>10 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/hardening-docker-containers-in-your-homelab-a-defense-in-depth-approach/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Hardening Docker Containers in Your Homelab: A Defense-in-Depth Approach
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Eight security layers that stopped real attacks in homelab testing: minimal base images, user namesp...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-12-17">
                                    December 17, 2025
                                </time>
                                <span>9 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/building-a-homelab-security-dashboard-with-grafana-and-prometheus/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Building a Homelab Security Dashboard with Grafana and Prometheus
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Real-world guide to monitoring security events in your homelab. Covers Prometheus configuration, Gra...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-12-10">
                                    December 10, 2025
                                </time>
                                <span>10 min read</span>
                            </div>
                        </a>
                    </article>
                    
                </div>
            </section>
            
            
            <footer role="contentinfo" aria-label="Site footer" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <div class="flex items-center justify-between">
                    <a href="/posts/" class="inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-200">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        Back to all posts
                    </a>
                    
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-500 dark:text-gray-400">Share:</span>
                        
                        <!-- LinkedIn -->
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://williamzujkowski.github.io%2Fposts%2Fbuilding-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev%2F" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#0077b5] dark:hover:text-[#0077b5] transition-colors duration-200"
                           aria-label="Share on LinkedIn">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                            </svg>
                        </a>
                        
                        <!-- Hacker News -->
                        <a href="https://news.ycombinator.com/submitlink?u=https://williamzujkowski.github.io%2Fposts%2Fbuilding-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev%2F&t=Building%20a%20Smart%20Vulnerability%20Prioritization%20System%20with%20EPSS%20and%20CISA%20KEV" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff6600] dark:hover:text-[#ff6600] transition-colors duration-200"
                           aria-label="Share on Hacker News">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M0 0v24h24v-24h-24zm12.8 8.7l2.3-4.3h1.4l-3.1 5.5v3.5h-1.2v-3.5l-3-5.5h1.4l2.2 4.3z"/>
                            </svg>
                        </a>
                        
                        <!-- Reddit -->
                        <a href="https://reddit.com/submit?url=https://williamzujkowski.github.io%2Fposts%2Fbuilding-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev%2F&title=Building%20a%20Smart%20Vulnerability%20Prioritization%20System%20with%20EPSS%20and%20CISA%20KEV" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff4500] dark:hover:text-[#ff4500] transition-colors duration-200"
                           aria-label="Share on Reddit">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/>
                            </svg>
                        </a>
                        
                        <!-- Copy Link -->
                        <button onclick="copyToClipboard('https://williamzujkowski.github.io/posts/building-a-smart-vulnerability-prioritization-system-with-epss-and-cisa-kev/')" 
                                class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200"
                                aria-label="Copy link to clipboard">
                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </footer>
        </div>
    </div>
</article>

<!-- Blog JavaScript Bundle (reading-progress, table-of-contents) -->
<script src="/assets/js/blog.min.js"></script>

<!-- Collapsible Code Blocks - loaded in base.njk -->
    </main>
    
    <!-- Footer -->
    <footer role="contentinfo" aria-label="Site footer" class="mt-auto border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- About -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">About</h3>
                    <p class="text-gray-600 dark:text-gray-400">
                        Personal website of William Zujkowski, exploring technology and sharing knowledge. All opinions and views expressed are my own and do not reflect those of my employer.
                    </p>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Quick Links</h3>
                    <ul class="space-y-2"><li><a href="/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Uses</a></li></ul>
                </div>
                
                <!-- Connect -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Connect</h3>
                    <div class="flex space-x-4">
                        <a href="https://github.com/williamzujkowski" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="GitHub" rel="noopener noreferrer">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/in/williamzujkowski" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="LinkedIn" rel="noopener noreferrer">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                            </svg>
                        </a>
                        <a href="/feed.xml" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="RSS Feed">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3.429 5.1v2.4c7.248 0 13.114 5.886 13.114 13.142h2.4C18.943 12.18 11.858 5.1 3.429 5.1zm0 4.8v2.4c3.924 0 7.114 3.206 7.114 7.142h2.4c0-5.256-4.276-9.542-9.514-9.542zM6.171 16.386c-.756 0-1.371.615-1.371 1.371 0 .756.615 1.371 1.371 1.371.756 0 1.371-.615 1.371-1.371 0-.756-.615-1.371-1.371-1.371z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700">
                <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                    &copy; 2025 William Zujkowski. All rights reserved.
                    Built with <a href="https://www.11ty.dev/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Eleventy</a>
                    and <a href="https://tailwindcss.com/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Tailwind CSS</a>.
                </p>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script>
        function toggleDarkMode() {
            const html = document.documentElement;
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.theme = 'light';
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            } else {
                html.classList.add('dark');
                localStorage.theme = 'dark';
                if (themeColorMeta) themeColorMeta.content = '#111827';
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Show success message
                showToast('Link copied to clipboard!');
            }, function(err) {
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-999999px";
                textArea.style.top = "-999999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('Link copied to clipboard!');
                } catch (err) {
                    showToast('Failed to copy link');
                }
                document.body.removeChild(textArea);
            });
        }
        
        function showToast(message) {
            // Create toast element
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-gray-800 dark:bg-gray-200 text-white dark:text-gray-800 px-4 py-2 rounded-lg shadow-lg transform transition-all duration-300 translate-y-full';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.classList.remove('translate-y-full');
                toast.classList.add('translate-y-0');
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('translate-y-0');
                toast.classList.add('translate-y-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }
    </script>
    
    <!-- Core JavaScript Bundle (ui-enhancements, back-to-top, code-collapse) -->
    <script src="/assets/js/core.min.js"></script>
    
    <!-- Mermaid Diagram Support -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        // Determine if dark mode is active
        const isDarkMode = document.documentElement.classList.contains('dark');
        
        // Initialize mermaid with proper settings
        mermaid.initialize({ 
            startOnLoad: false, // We'll manually init after DOM manipulation
            theme: isDarkMode ? 'dark' : 'default',
            themeVariables: isDarkMode ? {
                // Dark mode theme
                primaryColor: '#4f46e5',
                primaryTextColor: '#f3f4f6',
                primaryBorderColor: '#6366f1',
                lineColor: '#4b5563',
                secondaryColor: '#374151',
                tertiaryColor: '#1f2937',
                background: '#111827',
                mainBkg: '#1f2937',
                secondBkg: '#374151',
                tertiaryBkg: '#4b5563',
                primaryBorderColor: '#6366f1',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: true,
                nodeBkg: '#374151',
                nodeBorder: '#6366f1',
                clusterBkg: '#1f2937',
                clusterBorder: '#4b5563',
                defaultLinkColor: '#93bbfd',
                titleColor: '#f3f4f6',
                edgeLabelBackground: '#1f2937',
                actorBorder: '#6366f1',
                actorBkg: '#374151',
                actorTextColor: '#f3f4f6',
                actorLineColor: '#4b5563',
                signalColor: '#f3f4f6',
                signalTextColor: '#f3f4f6',
                labelBoxBkgColor: '#374151',
                labelBoxBorderColor: '#6366f1',
                labelTextColor: '#f3f4f6',
                loopTextColor: '#f3f4f6',
                noteBorderColor: '#6366f1',
                noteBkgColor: '#374151',
                noteTextColor: '#f3f4f6',
                activationBorderColor: '#6366f1',
                activationBkgColor: '#374151',
                sequenceNumberColor: '#111827'
            } : {
                // Light mode theme
                primaryColor: '#6366f1',
                primaryTextColor: '#fff',
                primaryBorderColor: '#4f46e5',
                lineColor: '#d1d5db',
                secondaryColor: '#e5e7eb',
                tertiaryColor: '#f3f4f6',
                background: '#ffffff',
                mainBkg: '#ffffff',
                secondBkg: '#f3f4f6',
                tertiaryBkg: '#e5e7eb',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: false,
                nodeBkg: '#f3f4f6',
                nodeBorder: '#4f46e5',
                clusterBkg: '#e5e7eb',
                clusterBorder: '#9ca3af',
                defaultLinkColor: '#2563eb',
                titleColor: '#1f2937',
                edgeLabelBackground: '#ffffff',
                actorBorder: '#4f46e5',
                actorBkg: '#f3f4f6',
                actorTextColor: '#1f2937',
                actorLineColor: '#9ca3af',
                signalColor: '#1f2937',
                signalTextColor: '#1f2937',
                labelBoxBkgColor: '#f3f4f6',
                labelBoxBorderColor: '#4f46e5',
                labelTextColor: '#1f2937',
                loopTextColor: '#1f2937',
                noteBorderColor: '#4f46e5',
                noteBkgColor: '#f3f4f6',
                noteTextColor: '#1f2937',
                activationBorderColor: '#4f46e5',
                activationBkgColor: '#e5e7eb',
                sequenceNumberColor: '#ffffff'
            },
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
        
        // Process Mermaid diagrams and THEN initialize code-collapse
        window.addEventListener('DOMContentLoaded', async function() {
            // Step 1: Find and process all mermaid code blocks
            const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
            
            if (mermaidBlocks.length > 0) {
                // Processing Mermaid diagrams
                
                // Convert each mermaid code block to a diagram
                for (const element of mermaidBlocks) {
                    const graphDefinition = element.textContent;
                    const preElement = element.parentNode;
                    
                    // Create a container div for the mermaid diagram
                    const containerDiv = document.createElement('div');
                    containerDiv.className = 'mermaid-container';
                    containerDiv.setAttribute('data-mermaid', 'true');
                    
                    // Create the mermaid div
                    const graphDiv = document.createElement('div');
                    graphDiv.className = 'mermaid';
                    graphDiv.textContent = graphDefinition;
                    
                    // Replace the pre element with the container - this removes the code block entirely
                    preElement.parentNode.replaceChild(containerDiv, preElement);
                    containerDiv.appendChild(graphDiv);
                }
                
                // Step 2: Initialize all mermaid diagrams with error handling
                try {
                    await mermaid.run();
                    console.log(`‚úÖ Successfully rendered ${mermaidBlocks.length} Mermaid diagram(s)`);
                } catch (error) {
                    console.error('‚ùå Mermaid rendering failed:', error);
                    // Log each diagram's content for debugging
                    document.querySelectorAll('.mermaid').forEach((div, index) => {
                        console.error(`Diagram ${index + 1} content:`, div.textContent);
                    });
                }

                // Diagrams are now styled via CSS, no need for inline styles
            }
            
            // Step 3: Code-collapse.js is already loaded and will handle remaining blocks
            // It checks for data-processed attribute to avoid duplicates
        });
    </script>
</body>
</html>