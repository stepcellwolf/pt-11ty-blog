<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Senior Cybersecurity and Privacy Expert specializing in Security and Privacy by Design, Governance, Risk and Compliance, cloud security, and human-centric security systems. Founder of Unicis.Tech, author, researcher, and cybersecurity mentor.">
    <meta name="author" content="Predrag Tasevski">
    <meta name="keywords" content="cybersecurity, privacy by design, governance risk and compliance, GRC, cloud security, cyber defence, data protection, ISO 27001, DPO, risk management, security awareness, AI in security">
    
    <title>Virtual Machine Malware / Malicious Analysis - Predrag Tasevski</title>
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://predragtasevski.com/posts/virtual-machine-malware-malicious-analysis/">
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/atom+xml" title="Predrag Tasevski Feed" href="https://predragtasevski.com/feed.xml">
    
    <!-- Favicons and PWA -->
    
<!-- Primary Favicons -->
<link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

<!-- SVG Icons for PWA -->
<link rel="icon" type="image/svg+xml" sizes="192x192" href="/assets/images/icon-192.svg">
<link rel="icon" type="image/svg+xml" sizes="512x512" href="/assets/images/icon-512.svg">

<!-- Theme Colors -->
<meta name="msapplication-TileColor" content="#1e40af">
<meta name="theme-color" content="#1e40af">

<!-- Web App Manifest -->
<link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Virtual Machine Malware / Malicious Analysis">
    <meta property="og:description" content="Senior Cybersecurity and Privacy Expert specializing in Security and Privacy by Design, Governance, Risk and Compliance, cloud security, and human-centric security systems. Founder of Unicis.Tech, author, researcher, and cybersecurity mentor.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://predragtasevski.com/posts/virtual-machine-malware-malicious-analysis/">
    <meta property="og:image" content="https://predragtasevski.com/assets/images/og-image.jpg">
    <meta property="og:site_name" content="Predrag Tasevski">
    <meta property="og:locale" content="en_US">
    
    <meta property="article:author" content="Predrag Tasevski">
    <meta property="article:published_time" content="2012-03-02">
    
    
    
    <!-- Additional SEO Meta -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">

    
    <script data-goatcounter="https://nextjs-pt-blog.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        
        "headline": "Virtual Machine Malware / Malicious Analysis",
        "description": "",
        "datePublished": "2012-03-02",
        "dateModified": "2026-01-25",
        "author": {
            "@type": "Person",
            "name": "Predrag Tasevski",
            "url": "https://predragtasevski.com/about/",
            "sameAs": [
                "https://github.com/stepcellwolf/",
                "https://www.linkedin.com/in/tpredrag"
            ]
        },
        "publisher": {
            "@type": "Person",
            "name": "Predrag Tasevski",
            "url": "https://predragtasevski.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https://predragtasevski.com/assets/images/headshot.png"
            }
        },
        "image": {
            "@type": "ImageObject",
            "url": "https://predragtasevski.com/assets/images/og-image.jpg"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://predragtasevski.com/posts/virtual-machine-malware-malicious-analysis/"
        },
        "url": "https://predragtasevski.com/posts/virtual-machine-malware-malicious-analysis/"
        
    }
    </script>
    
    <!-- Resource Hints for Performance -->
    <link rel="preconnect" href="https://rsms.me">
    <link rel="dns-prefetch" href="https://rsms.me">
    
    <!-- Inter font -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    
    <!-- Dark mode script -->
    <script>
        // Initialize dark mode and theme color
        (function() {
            const isDark = localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (isDark) {
                document.documentElement.classList.add('dark');
                if (themeColorMeta) themeColorMeta.content = '#111827';
            } else {
                document.documentElement.classList.remove('dark');
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            }
        })();
    </script>
</head>
<body class="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-300 antialiased">
    <a href="#main" class="skip-to-main">Skip to main content</a>


    
    <!-- Header -->
    <header role="banner" aria-label="Site header" class="site-header sticky top-0 z-50 w-full">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8" aria-label="Primary navigation">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0">
                    <a href="/" class="text-xl font-semibold gradient-text">
                        Predrag Tasevski
                    </a>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1">
                        <ul class="flex items-center space-x-1"><li><a href="/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/posts/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Blog</a></li>
<li><a href="/projects/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Projects</a></li>
<li><a href="/publications/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Publications</a></li>
<li><a href="/talks/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Talks</a></li>
<li><a href="/teaching/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Teach</a></li>
<li><a href="/photography/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Photography</a></li>
<li><a href="/about/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/resume/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">CV</a></li>
<li><a href="/stats/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li></ul>
                    </div>
                </div>
                
                <!-- Dark mode toggle & Mobile menu button -->
                <div class="flex items-center space-x-4">
                    <!-- Dark mode toggle -->
                    <button type="button" onclick="toggleDarkMode()" class="min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle dark mode">
                        <!-- Light mode icon -->
                        <svg class="w-5 h-5 block dark:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <!-- Dark mode icon -->
                        <svg class="w-5 h-5 hidden dark:block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                    
                    <!-- Mobile menu button -->
                    <button type="button" onclick="toggleMobileMenu()" class="md:hidden min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle menu" data-mobile-menu-button>
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden" data-mobile-menu-panel>
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <ul class="space-y-1"><li><a href="/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/posts/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Blog</a></li>
<li><a href="/projects/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Projects</a></li>
<li><a href="/publications/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Publications</a></li>
<li><a href="/talks/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Talks</a></li>
<li><a href="/teaching/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Teach</a></li>
<li><a href="/photography/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Photography</a></li>
<li><a href="/about/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/resume/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">CV</a></li>
<li><a href="/stats/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li></ul>
                </div>
            </div>
        </nav>
    </header>
    
    <!-- Breadcrumbs -->
    
    
    <!-- Main content -->
    <main id="main" class="flex-grow">
        <!-- Enhanced Breadcrumbs for Blog Posts -->
<nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4" aria-label="Breadcrumb">
  <ol class="flex items-center space-x-2 text-sm flex-wrap">
    <li>
      <a href="/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        <svg class="w-4 h-4 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        Home
      </a>
    </li>
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <a href="/posts/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        Blog
      </a>
    </li>
    
      
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
      
      <li class="flex items-center">
        <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <a href="/tags/malicious-analysis/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
          malicious analysis
        </a>
      </li>
      
    
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <span class="text-gray-900 dark:text-gray-100 font-medium truncate max-w-xs">Virtual Machine Malware / Malicious Analysis</span>
    </li>
  </ol>
</nav>

<article class="py-16 sm:py-24">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="mx-auto max-w-3xl">
            <header role="banner" aria-label="Site header" class="mb-12">
                <div class="text-center">
                    <div class="flex items-center justify-center space-x-4 text-sm font-medium">
                        <time datetime="2012-03-02" class="text-primary-600 dark:text-primary-400">
                            March 2, 2012
                        </time>
                        <span class="text-gray-400 dark:text-gray-600">•</span>
                        <span class="text-gray-600 dark:text-gray-400">
                            14 min read
                        </span>
                    </div>
                    <h1 class="mt-4 text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100 sm:text-5xl animate-fade-in-up">
                        Virtual Machine Malware / Malicious Analysis
                    </h1>
                    
                </div>
                
                
                <div class="mt-8 flex flex-wrap justify-center gap-2 animate-fade-in-up animation-delay-400">
                    
                        
                    
                        
                        <a href="/tags/malicious-analysis/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            malicious analysis
                        </a>
                        
                    
                        
                        <a href="/tags/malware/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            malware
                        </a>
                        
                    
                        
                        <a href="/tags/malware-analysis/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            malware analysis
                        </a>
                        
                    
                        
                        <a href="/tags/virtual-machine/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            virtual machine
                        </a>
                        
                    
                        
                        <a href="/tags/virtual-machine-analysis/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            virtual machine analysis
                        </a>
                        
                    
                </div>
                
            </header>

            <!-- Table of Contents Accordion -->
            <nav aria-label="Table of contents" class="toc-accordion mb-8 animate-fade-in-up animation-delay-500">
                <details class="group">
                    <summary class="cursor-pointer select-none font-medium flex items-center justify-between">
                        <span>Table of Contents</span>
                        <svg class="w-5 h-5 transform group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </summary>
                    <div class="toc-content mt-4" id="toc-content">
                        <!-- ToC will be generated here by JavaScript -->
                    </div>
                </details>
            </nav>

            <div class="prose prose-lg prose-gray dark:prose-invert mx-auto animate-fade-in-up animation-delay-600">
                <h1>INTRODUCTION</h1>
<p>The main goal of laboratory report is to identify possible infection of
two Windows 7 virtual machine. Virtual machines presented by the
lecture:</p>
<ul>
<li>Win 1</li>
<li>Win 2</li>
</ul>
<p>The assignment is following:</p>
<ul>
<li>Find out what is infecting the machine win1</li>
<li>Understand which way is the current malware dangerous to “your
organisation”</li>
<li>If possible, do clean win1</li>
<li>Is win2 clean or it has problems, too?</li>
<li>If needed, do clean win2</li>
</ul>
<p>Additionally, deliverable questions should be visible:</p>
<ul>
<li>Summary – Your thoughts about the exercise. Please provide a short</li>
<li>Malware that infects machines</li>
<li>Md5 hash – if it possible and if not, please explain, why.</li>
<li>Sha256 has -if it possible and if not, then please explain, why.</li>
<li>A description – in which way that malware is a threat to “You
organization”</li>
<li>Tools You used to find the infection(s)</li>
<li>Tools You used to clean machine(s)</li>
<li>Where You found hints and how exactly You did it (you need to show
Your thought and communication process – please write a summary of
it.)</li>
<li>How would you evaluate your partner.</li>
</ul>
<p>Moreover, we have to consider the malware analysis report reminders,
please refer to [1] or [2].</p>
<p>Furthermore, each virtual machine will be analysed with different tools,
in case to gather more information and solution for disinfecting
process. Structure of the laboratory report is first to present each
virtual machine with details information in section Virtual Machine’s,
Each visualization is examined. Malware and disinfection process are
described. Meanwhile in appendices, we explain what virtual environment
and tools we have used for this written report.</p>
<p>Finally the conclusion made of all analysis will be concise in summary
section.</p>
<h1>VIRTUAL MACHINE’s</h1>
<p>In this section each virtual machines are going to be examine in
sub-sections, analysis and additionally the disinfection solutions,
etc. will be presented. The tools that are used for conducting the
analysis are presented in the Tools section.</p>
<h2>Win1</h2>
<p>Intense detail information are highlighted bellow and MD5 sum for Win1
virtual box machine:</p>
<pre><code>    OS: Ms Windows 7 ProfessionalVersion: 6.1.7601 Service Pack 1 Build 7601System type: 32 bitComputer name: DoeMUsers Names:- Jane Doe- Jhon DoeMD5 Sum: 6313cf7303de37ba62aadf5208b6ea78
</code></pre>
<h3>Analysis</h3>
<p>The analysis starts firstly from the observations, then with an
supporting figures, sample of identification, are there any dependencies
and in closer with summary of the analysis. From analysis with a
different tools we came to conclusion that the above virtual image it is
infected with some malicious code. Were certain tools have provides as
an information that there is background accessing to network. However,
this analysis it is not enough so therefore we will do more inside
investigation to come-out with the hosts or network that the malicious
code is trying to access, or an information that is shared.</p>
<p>To be able to identify the behaviour of a network we have used the
Wireshark tool. Bellow are highlighted the steps: Network adapter type:
NAT, logged in as: John Doe, additionally Wireshark run as
Administrator. Upon the testing, the only user application open on WIN1
is Notepad. No additional network activities from log-in user, also no
network activities from user on Host System. Wireshark, it detected
suspicious traffic:</p>
<ol>
<li>Classification: BAD TCP (according to Wireshark coloring rules),
Destination: 192.168.0.254 / 8.8.4.4 (Googne Public DNS) with
Protocol: DNS; Info: Standard query A <em>mamtumbochka766.ru</em> /
Standard query A <em>followmego12.ru</em> / Standart query A
<em>losokorot7621.ru</em> / standard query A <em>hidemyfass87111.ru</em> /; Reason
for classification as BAD TCP: Header checksum incorrect, maybe
caused by “IP checksum offload”, Message: Bad Cheksum, Severity
level: Error</li>
<li>As a response, WIN1 machine got UDP packet (according to Wireshark
coloring rules); Protocol: DNS; Info: Standard query response, Sever
failure.</li>
<li>Additionally, Wireshark detected another round of BAD TCP packets;
Classification: BAD TCP; Destination: 195.226.218.135; Protocol:
TCP; Port: 50530; Info: HTTP ACK (before that, WIN1 sent ACK
message, got SYN ACK and this packet was an ACK). Where during HTTP
session, WIN1 machine received the following linebased text data:
<em>i5eOnJKV57mp5biuqK+0tri0tbW+uK+0qeDr57mp5b29uL6pr7ypurm5vqng6+e5qeU=</em>;
Then WIN1 received FIN ACK message from server and send ACK and FIN
ACK. Session was finished.</li>
</ol>
<p>The session was repeated once in 3 minutes and received line-based text
data, for all sessions was the same. For illustration please refer to
the following link for more details of pcap life of wireshark:
(https://bit.ly/mDdqAQ).</p>
<p>Additional log files and screen shots are presented bellow during the
analysis with other tools that are listed in the sections of tools.</p>
<p>Illustration 1: TCPView tool, YGLA.ru access to domain</p>
<p>Furthermore, log illustration of hijackThis tool:</p>
<pre><code>    Logfile of Trend Micro HijackThis v2.0.4Scan saved at 20:35:44, on 27.11.2011Platform: Windows 7 SP1 (WinNT 6.00.3505)MSIE: Internet Explorer v8.00 (8.00.7601.17514)Boot mode: NormalRunning processes:C:\Windows\system32\taskhost.exeC:\Windows\system32\Dwm.exeC:\Windows\Explorer.EXEC:\Windows\System32\VBoxTray.exeC:\Windows\system32\SearchProtocolHost.exeC:\Windows\system32\taskmgr.exeC:\Users\Jhon Doe\Desktop\HijackThis.exeR1 - HKCU\Software\Microsoft\Internet Explorer\Main,Search Page = https://go.microsoft.com/fwlink/?LinkId=54896R0 - HKCU\Software\Microsoft\Internet Explorer\Main,Start Page = about:blankR1 - HKLM\Software\Microsoft\Internet Explorer\Main,Default_Page_URL = https://go.microsoft.com/fwlink/?LinkId=69157R1 - HKLM\Software\Microsoft\Internet Explorer\Main,Default_Search_URL = https://go.microsoft.com/fwlink/?LinkId=54896R1 - HKLM\Software\Microsoft\Internet Explorer\Main,Search Page = https://go.microsoft.com/fwlink/?LinkId=54896R0 - HKLM\Software\Microsoft\Internet Explorer\Main,Start Page = https://go.microsoft.com/fwlink/?LinkId=69157R0 - HKLM\Software\Microsoft\Internet Explorer\Search,SearchAssistant =R0 - HKLM\Software\Microsoft\Internet Explorer\Search,CustomizeSearch =R0 - HKCU\Software\Microsoft\Internet Explorer\Toolbar,LinksFolderName =F3 - REG:win.ini: load=C:\Users\JHONDO~1\LOCALS~1\Temp\5b17fff70008a4e8.exeO4 - HKLM\..\Run: [VBoxTray] C:\Windows\system32\VBoxTray.exeO23 - Service: FJOSKX - Sysinternals - www.sysinternals.com -C:\Users\JHONDO~1\AppData\Local\Temp\FJOSKX.exeO23 - Service: Remote Packet Capture Protocol v.0 (experimental) (rpcapd) - CACETechnologies, Inc. - C:\Program Files\WinPcap\rpcapd.exeO23 - Service: SUUKATRPY - Sysinternals - www.sysinternals.com -C:\Users\JHONDO~1\AppData\Local\Temp\SUUKATRPY.exeO23 - Service: VirtualBox Guest Additions Service (VBoxService) - Oracle Corporation -C:\Windows\system32\VBoxService.exe
</code></pre>
<p>Alternatively, we turn to Process Explorer and Process Monitor from
Sysinternals. In spite of comprehensive information and some suspicious
activities, these tools were unable to show direct link to malware. We
analyzed some suspicious DLLs and .exe files, but all of them appeared
to be legitimate Windows files. Also ee turned to Security Task Manager
by Neuber Software where it discovered file <code>061afffa0005f9e5.exe</code> in
<code>C:\Users\JHONDO~1\LOCALS~1\Temp</code> folder. Usually malware runs itself or
is hidden in Temp folder. So weird name and location give us enough
reason to think it’s malware. Additional information provided by
Security Task Manager: Company: Not provided; Type: Program. Hidden;
Starts: when Windows starts and Registry: win.ini.</p>
<p>Meanwhile, for advance analysis we have conduct with clean boot which is
explained into the KB article in the following
<a href="https://support.microsoft.com/kb/929135">link</a>.</p>
<p>Now we run the wireshark analysis network tool, where no more suspicious
network traffic is identified. This means that the malicious code is
running from 3rd party applications and not from Microsoft services or
process.</p>
<p>Likelihood, to be able to identify the malicious code, threads in
virtual machine, we recommend to run an online free virus scanning. Thus
process is done by ESET free online tool scanning, refer to the
following [link](https://www.eset.com/us/online-scanner/](/https://www.eset.com/us/online-scanner/).</p>
<p>The aim of this step is to help to identify if the threads have been
registered in to the virus signature database. If so, this will be a
useful information and will assist to continue with analysis.</p>
<pre><code>    Eset Online scanner, found 20 threads:C:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.2.60\c39bb188f2ac6534e75c6d961b9a78a2 Win32/Spy.SpyEye.BY trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.2.99\92bf8b3eb04be42f6aba05d6b97e8f25 Win32/Spy.SpyEye.BY trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.3.10\21da6142e3cd3979b7ef122ee638c78f a variant of Win32/Kryptik.MKM trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.3.25\7822bbf0c8ea3e9a75a19e954a39d6c9 Win32/Spy.SpyEye.CA trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.3.31\2bed4bbed303c91e2169b2f32db46acb.exe Win32/Spy.SpyEye.CA trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.3.32\1686b7e48871dd715336c732cfc32c1d Win32/Spy.SpyEye.CA trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIZWMML\spyeye-1.3.34\b2c3acf99f68c42626cf345b74095d51 a variant of Win32/Spy.SpyEye.CA trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$R387J1S IRC/SdBot trojan cleaned by deleting - quarantined C:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$R6TYLIY a variant of Win32/Kryptik.KUQ trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$R8Y8LWG Win32/Pepex.E worm cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RD4Q6CZ Win32/AutoRun.IRCBot.FC worm cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RI87EEE Win32/AutoRun.KS worm cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RIJ4S9U a variant of Win32/Kryptik.KUQ trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$ROFILPO probably a variant of Win32/Autorun.MHBFUDT worm cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RQNEZXA Win32/Pepex.F worm cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RU9MNXT IRC/SdBot trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RY4NX2I IRC/SdBot trojan cleaned by deleting - quarantinedC:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1000\$RY6CB6A Win32/AutoRun.KS worm cleaned by deleting - quarantinedC:\Bios.Bin\Bios.Bin.exe a variant of Win32/Injector.FPL trojan cleaned by deleting - quarantinedC:\Users\Public\Videos\Sample Videos\moos.exeIRC/SdBot trojan cleaned by deleting - quarantined
</code></pre>
<p>Each virus definition is presented bellow in the following table with
the description [link]</p>
<table>
<thead>
<tr>
<th>Name of threads</th>
<th>Description links</th>
</tr>
</thead>
<tbody>
<tr>
<td>Win32/Spy.SpyEye.BY</td>
<td>(https://www.eset.eu/encyclopaedia/win32-spy-spyeye-btrojan-pincav-shd-backdoor](https://www.eset.eu/encyclopaedia/win32-spy-spyeye-btrojan-%20pincav-shd-backdoor)</td>
</tr>
<tr>
<td>Win32/Kryptik.MKM</td>
<td>N/A</td>
</tr>
<tr>
<td>Win32/Spy.SpyEye.CA</td>
<td>(https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Trojan%3AWin32%2FSpyeye](https://www.microsoft.com/security/portal/threat/Encyclopedia/%20Entry.aspx?Name=Trojan%3AWin32%2FSpyeye)</td>
</tr>
<tr>
<td>IRC/SdBot</td>
<td>(https://www.symantec.com/security_response/writeup.jsp?docid=2002-051312-3628-99](https://www.symantec.com/security_response/writeup.jsp?%20docid=2002-051312-3628-99)</td>
</tr>
<tr>
<td>Win32/Kryptik.KUQ</td>
<td>(https://www.virustotal.com/file-scan/report.html?id=1025888a8be72a04cf0b576c65a9b2b13a7abaaa6b90124e2c14b095f98edef7-1310416729](/https://www.virustotal.com/file-scan/report.html?%20id=1025888a8be72a04cf0b576c65a9b2b13a7abaaa6b90124%20e2c14b095f98edef7-1310416729)</td>
</tr>
<tr>
<td>Win32/Pepex.E</td>
<td>(https://www.virustotal.com/file-scan/report.html?id=169ff0849ce6e055584d24cabc18637db9ae127c166f430147c457a4f410d9d-1303250955](https://www.virustotal.com/file-scan/report.html?%20id=169ff0849ce6e055584d24cabc18637db9ae127c166f4309%20147c457a4f410d9d-1303250955)</td>
</tr>
<tr>
<td>Win32/AutoRun.IRCBot.FC</td>
<td>(https://www.eset.eu/encyclopaedia/win32-autorun-ircbot-fcnet-worm-mytob-gvm-w32-gen-trojan-qhost-d?lng=en](https://www.eset.eu/encyclopaedia/win32-autorun-ircbot-fcnet-%20worm-mytob-gvm-w32-gen-trojan-qhost-d?lng=en)</td>
</tr>
<tr>
<td>Win32/AutoRun.KS</td>
<td>(https://www.eset.eu/encyclopaedia/win32_autorun_ks_sillyfdc](https://www.eset.eu/encyclopaedia/win32_autorun_ks_sillyfdc%20_worm_fgj_dnn)</td>
</tr>
<tr>
<td><a href="https://www.eset.eu/encyclopaedia/win32_autorun_ks_sillyfdc%20_worm_fgj_dnn">_worm_fgj_dnn</a></td>
<td></td>
</tr>
<tr>
<td>Win32/Injector.FPL</td>
<td>(https://www.virustotal.com/file-scan/report.html?id=51591a4e9aed52a04bbd33c45f7111ae8b3af1051bf39e207940243962e7f25-1303564836](https://www.virustotal.com/file-scan/report.html?%20id=51591a4e9aed52a04bbd33c45f7111ae8b3af1051bf39e25%2007940243962e7f25-1303564836)</td>
</tr>
</tbody>
</table>
<p>From the above table we can come to the conclusive proof that total sum
number of malicious code running in the virtual machine are 20, with an
9 different definitions of trojan, warms, etc. However, most of them
were located in to the Recycle bin folder. Additionally to the analysing
packets with Wireshark showed that Win1 has some malware, which sent and
received some information over network without knowledge of the
user. Destination IP addresses, names and port numbers were suspicious.</p>
<h3>Disinfection</h3>
<p>Indeed, this virtual machine it is infected. Therefore we have to
perform an disinfection process. However, from the above table of the
links it provides an solution and steps that should be followed for
disinfection process. Either with an tool or steps for removing the
malicious code. Also, we can remove the files with some additional tools
that are available for free, for instance Eraser tool. Now that we know
the exact location of each infected file it is much easier and simple to
be able to delete, remove the files from our system. Although we could
use the Eset scanner tool that we have performed previously.
Nevertheless, to be sure and more save way is to do the removing process
manually.</p>
<p>Therefore, recommendation for deleting the malicious code of all time
from virtual machine is eraser tool. You need to configure task and
which folders or files you specify to be removed. After the task was
completed, restart the machine and now the system should be disinfected
and additional we recommend to run the Eset online scanner free tool
one more time, just in case in a meaner of your organization.</p>
<h2>Win2</h2>
<p>Intense detail information are highlighted bellow and MD5 sum for Win2
virtual box machine:</p>
<pre><code>    OS: Ms Windows 7 ProfessionalVersion: 6.1.7601 Service Pack 1 Build 7601System type: 32 bitComputer name: DoeMUsers Names:- Jane Doe- Jhon DoeMD5 Sum: 155a5b9e8b842dff4aa5a7b4361113d3
</code></pre>
<h3>Analysis</h3>
<p>Despite the fact that Process Monitor, TCPView and other Sysinternals
Suite analysis tools did not help us at all (also Wireshark did not
detect any suspicious network activities), at this point, additionally
registry changes were detected with CaptureBat tool, where the log file
will be presented in figure 2. However by running the ESET online free
scanner tool, it did detect in total three threads to our virtual
machine, logs are presented bellow.</p>
<p>Eset Online Scanner, found 3 threads:</p>
<pre><code>    C:\$Recycle.Bin\S-1-5-21-1301155936-2652204530-896827088-1001\$RKV8ZW1.exe Win32/Duqu.A trojanC:\Users\Jane\AppData\Local\Temp\0004fbd1.tmpa variant of Win32/Kryptik.VFI trojanC:\Users\Jane\AppData\Local\Temp\b01dffe3001c4fe2.exe Win32/TrojanDownloader.Agent.QXN trojan
</code></pre>
<p>Threads are located in to the system directory of Jane user name.
Additionally, there is an other malicious code located into the Recycle
bin as we were able to detect into the previous analysis for Win1
virtual machine. In spite of fact that in previously scenario we had
only a threads located into Recycle Bin, at this virtual environment we
have as an local files. Therefore to be able to identify the above file
and there integrity we have to sum the MD5 and SHA256 algorithms. For
this action we are using an online tool winMd5Sum.</p>
<table>
<thead>
<tr>
<th>File name</th>
<th>MD5Sum</th>
<th>SHA256</th>
</tr>
</thead>
<tbody>
<tr>
<td>C:\Users\Jane\AppData\Local\Temp\0004fbd1.tmp</td>
<td>aa17de9a17a58840b8f3b3bd5412daee</td>
<td>6d242dbfec946dcacc90d624defb073cb7d7bcc531c06d566933610fef62f986</td>
</tr>
<tr>
<td>C:\Users\Jane\AppData\Local\Temp\b01dffe3001c4fe2.exe</td>
<td>dc88442c440a5fa5c5fa449a2d0ab1e5</td>
<td>d9a874bf8d9f2f2ca803d38abd677ab51e77008b6cfbab37525dd28df71be107</td>
</tr>
</tbody>
</table>
<p>For advance analysis, we will run the MD5Sum into the
<a href="https://virustotal.com/">virustotal.com</a> search to identify the threads.
Indeed, all of the above have been reported previously as a malware.
Meanwhile, to gather better description of the above malicious codes we
will search the definitions in the Eset database and descriptions
provided in the following table.</p>
<table>
<thead>
<tr>
<th>Thread name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Win32/Duqu.A</td>
<td>(https://blog.eset.com/2011/10/28/win32duqu-analysisthe-rpc-edition](https://blog.eset.com/2011/10/28/win32duqu-analysisthe-%20rpc-edition)</td>
</tr>
<tr>
<td>Win32/Kryptik.VFI</td>
<td>https://vil.nai.com/vil/content/v_683077.htm</td>
</tr>
<tr>
<td>Win32/TrojanDownloader.Agent.QXN</td>
<td>(https://www.pcsafedoctor.com/Trojan/remove-Win32.TrojanDownloader.Agent.QNX.html](https://www.pcsafedoctor.com/Trojan/remove-%20Win32.TrojanDownloader.Agent.QNX.html)</td>
</tr>
</tbody>
</table>
<p>Figure 2 is just a part of the log files that were able to be capture of
the CaptureBAT tool, as we can see form the above that many changes were
effected over the registries. Therefore, we need to run either an
registry system check or as we know the location of the malicious code,
with OllyDbg we can run the files and inspect there behaviour and if
they have any additionally affect over the memory dump, etc. presented
in figure 3.</p>
<p>Illustration 3: OllyDbg analysis, memory dump, system dll access, etc.</p>
<p>Nevertheless, because now we have the locations and the threads
description it is next step to disinfected the system, yet it is still a
big thread for the organization, etc.</p>
<h3>Disinfection</h3>
<p>As on the previously scenario, we recommend either to use the Eset
online free scanner or to use in more convinced way the Eraser tool, for
removing the malicious code from the machine forever. Furthermore, to
just make sure that the above malicious code is removed, disinfected
from our system still recommendations is to run the Eset tool for a
second time, for double check the system.</p>
<p>All the above files and threads could be a very harmful for the
organization and for everyday production work. Therefore, advance
analysis of the system it is always in hands to help us to protect our
data, internet access, etc. of being leaked.</p>
<h2>Tools</h2>
<p>Tools that help for conducting the results are highlighted in this
section. Those are just few of them that are available for this purpose.
Nevertheless, we have use only the listed ones.</p>
<p>Tools and downloadable links:</p>
<ul>
<li><a href="https://www.honeynet.org/node/315">CaptureBAT</a>.</li>
<li>Most of the tools that are used for this laboratory report are
<a href="https://technet.microsoft.com/en-us/sysinternals/bb842062">Sysinternals Suite</a>.</li>
<li>Advance report: <a href="https://free.antivirus.com/hijackthis/">HijaskThis</a>.</li>
<li><a href="https://www.wireshark.org/">Wireshark</a>.</li>
<li><a href="https://www.eset.com/us/online-scanner/">ESET Free Online Scanner</a>.</li>
<li><a href="https://www.heidi.ie/eraser/">Eraser</a>.</li>
<li><a href="https://www.virustotal.com/">Virustotal</a>.</li>
<li><a href="https://neuber.com/taskmanager/index.html">Security Task Manager</a>.</li>
<li><a href="https://www.ollydbg.de/">OllyDbg v1.10</a>.</li>
<li><a href="https://www.nullriver.com/products/winmd5sum">WinMD5Sum</a>.</li>
</ul>
<p>However, there are many other tools that can be used. Recent papers,
tutorials can help us for further action, please refer to [3] [4] [5]
[6].</p>
<h1>SUMMARY</h1>
<p>Nowadays malicious codes, infection of the system is one of the highest
vector of production work everyday of the organizations. Therefore,
different approaches, advance analysis, troubleshooting, etc. has to be
applicable and stated in every organization.</p>
<p>Leaking of data, information, access of network (internal and external)
can be very harmful for organization and even the home usage of
computers. Therefore, this laboratory report main aim is to provide the
reader to be able to conduct advance analysis of system and their
disinfection.</p>
<p>From the two scenarios, virtual machine environments we came to final
consistent conclusion that both of them are infected. Yet different
threads were able to be found in the systems. However analysis is done
by the short time of period. In each scenario in report provides an
solutions how and what kind of actions should be considered for
future disinfection of the system. Moreover, in next lines we are
stating the summary of each infected machine.</p>
<p>Firstly, Win1 was infected with identified 20 threads, with other words
in total of 9 different definitions of trojan, malware, warms code. The
definition of the threads were advance, where from the links provided in
the table above, is stated that the few of them were playing very smart.
By smart, we mean, that if they have noticed that wireshark, tcpviewer
or other tools were running, the malicious code stops responding, so it
was able to cover his identity, information leaks, etc. In addition, the
malicious codes were located in to the Recycle bin folder, where we were
not able to identify there MD5 sum or SHA256. If we want it to proceed
in this step, we had to restore them from the bin folder and then
identify them. Advance we identify the user that has spread the
malicious code, user name: John Doe. Nevertheless, disinfecting process
helped us to remove the code from the system and just in case we have
run in second time the Eset online scanner tool.</p>
<p>Secondly, Win2 was indeed infected too. In spite of the scenario one,
this was less infected. The total sum of the threads were 3. Each of
them were supply by the administrator user account: Jane Doe. The
location of the malicious code is located into the temp folders and one
in a recycle bin directory. From the definitions links from the above
table we can stated that they have try to attempt over the network to
leak informations, registry changes and additional files are added to
the system. However, all of them were harmful for our environment and
therefore and disinfection steps were necessary. Additionally, the
location of the files were accessible therefore we provide an addition
MD5sum and SHA256 for each file, were it help us to identify them in
<a href="https://virustotal.com/">virustotal.com</a>.</p>
<p>Finally, the both virtual box were infected with different malicious
code. Advance disinfection procedures were necessary to troubleshoot and
find the solution to make the hence system for being able to use it in
production. However, the threads were able to share, leak information
and data, in advance were able to change the registry and even the
system files. Therefore, we do recommend advance furthermore actions to
be considered. Meanwhile, the list of the tools that is provided by this
report will help the hence users and analysers to be able to identify
the threads in a system and to perform an disinfection. Additional the
tutorials, stepwise solutions were provided as a reference where can
guide for more advance troubleshooting.</p>
<p>Closing, as there are many different ways, tools, process for analysing
the malicious code behaviours in system this laboratory report is
supplying the reader with advance and stepwise solution for identifying
the infection of the system. The above procedure can be applied into
real time, everyday working machine.</p>
<h1>WORKLOAD</h1>
<p>We analysed both Win1 and Win2 on our computers. Virtualization
environment for both host systems were the same. Each of us analyzed
Win1 and Win2. First we analyzed Win1 and then Win2. So the group
analyzed each of Virtual Machines (Win1 and Win2) two times.</p>
<p>In such way we cross-referenced the analysis results and got more
reliable information about the system and its infection.</p>
<h1>APPENDIXES</h1>
<p>Appendix 1 is configuration of the virtual environment.</p>
<h2>APPENDIX 1</h2>
<p>Virtual environment: Oracle VirtualBox Version 4.1.2 r73507.
Downloadable from the following [link]
(https://www.virtualbox.org/wiki/Downloads)</p>
<h1>Bibliography</h1>
<p>[1] Lenny Zeltser, Reverse-Engineering: Malware Analysis Tools and
Techniques Training, 2011, <a href="https://zeltser.com/reverse-malware/">Link</a>.</p>
<p>[2] Lenny Zeltser, Malware analysis report reminders, 2011,<a href="https://zeltser.com/reversemalware/malware-analysis-report-template.mm">Link</a>.</p>
<p>[3] Lenny Zeltser, Introduction to malware Analysis, 2010, <a href="https://zeltser.com/reverse-malware/introto-malware-analysis.pdf">Link</a>.</p>
<p>[4] Michael Kassner, 10 ways to detect computer malware, 2009, <a href="https://www.techrepublic.com/blog/10things/10-ways-to-detect-computer-malware/970">Link</a>.</p>
<p>[5] Michael Kassner, 10 more ways to detect computer malware, 2009, <a href="https://www.techrepublic.com/blog/10things/10-more-ways-to-detect-computer-malware/1069">link</a>.</p>
<p>[6] Andrew Brandt, Security Tips: Identify Malware Hiding in Windows’
System Folders, 2005, <a href="https://www.pcworld.com/article/120795-3/security_tips_identify_malware_hiding_in_windows_system_folders.html">link</a>.</p>
<p>The above post is written by Predrag Tasevski and Mikheil Basilaia.</p>

            </div>
            
            <!-- Related Posts -->
            
            
            
            
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
            
            
            
            <section aria-label="Content section" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Related Posts</h2>
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                    
                    
                    <article class="group">
                        <a href="/posts/analyses-of-malware-files/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Analyses of Malware Files
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2012-09-30">
                                    September 30, 2012
                                </time>
                                <span>6 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/identify-possible-infection-of-malware-into-the-wireshark-capture-file/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Identify Possible Infection of Malware Into the Wireshark Capture File
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2012-09-01">
                                    September 1, 2012
                                </time>
                                <span>7 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/mobile-malware-analysis/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Mobile Malware Analysis
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2012-01-17">
                                    January 17, 2012
                                </time>
                                <span>3 min read</span>
                            </div>
                        </a>
                    </article>
                    
                </div>
            </section>
            
            
            <footer role="contentinfo" aria-label="Site footer" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <div class="flex items-center justify-between">
                    <a href="/posts/" class="inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-200">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        Back to all posts
                    </a>
                    
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-500 dark:text-gray-400">Share:</span>
                        
                        <!-- LinkedIn -->
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://predragtasevski.com%2Fposts%2Fvirtual-machine-malware-malicious-analysis%2F" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#0077b5] dark:hover:text-[#0077b5] transition-colors duration-200"
                           aria-label="Share on LinkedIn">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                            </svg>
                        </a>
                        
                        <!-- Hacker News -->
                        <a href="https://news.ycombinator.com/submitlink?u=https://predragtasevski.com%2Fposts%2Fvirtual-machine-malware-malicious-analysis%2F&t=Virtual%20Machine%20Malware%20%2F%20Malicious%20Analysis" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff6600] dark:hover:text-[#ff6600] transition-colors duration-200"
                           aria-label="Share on Hacker News">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M0 0v24h24v-24h-24zm12.8 8.7l2.3-4.3h1.4l-3.1 5.5v3.5h-1.2v-3.5l-3-5.5h1.4l2.2 4.3z"/>
                            </svg>
                        </a>
                        
                        <!-- Reddit -->
                        <a href="https://reddit.com/submit?url=https://predragtasevski.com%2Fposts%2Fvirtual-machine-malware-malicious-analysis%2F&title=Virtual%20Machine%20Malware%20%2F%20Malicious%20Analysis" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff4500] dark:hover:text-[#ff4500] transition-colors duration-200"
                           aria-label="Share on Reddit">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/>
                            </svg>
                        </a>
                        
                        <!-- Copy Link -->
                        <button onclick="copyToClipboard('https://predragtasevski.com/posts/virtual-machine-malware-malicious-analysis/')" 
                                class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200"
                                aria-label="Copy link to clipboard">
                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </footer>
        </div>
    </div>
</article>

<!-- Blog JavaScript Bundle (reading-progress, table-of-contents) -->
<script src="/assets/js/blog.min.js"></script>

<!-- Collapsible Code Blocks - loaded in base.njk -->
    </main>
    
    <!-- Footer -->
    <footer role="contentinfo" aria-label="Site footer" class="mt-auto border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- About -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">About</h3>
                    <p class="text-gray-600 dark:text-gray-400">
                        Personal website of Predrag Tasevski, — insights on cybersecurity, open‑source, AI and technology. All views are my own and do not reflect any employer.
                    </p>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Quick Links</h3>
                    <ul class="space-y-2"><li><a href="/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Home</a></li>
<li><a href="/posts/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Blog</a></li>
<li><a href="/projects/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Projects</a></li>
<li><a href="/publications/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Publications</a></li>
<li><a href="/talks/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Talks</a></li>
<li><a href="/teaching/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Teach</a></li>
<li><a href="/photography/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Photography</a></li>
<li><a href="/about/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">About</a></li>
<li><a href="/resume/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">CV</a></li>
<li><a href="/stats/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Stats</a></li></ul>
                </div>
                
                <!-- Connect -->
                <div> 
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Connect</h3> 
                    <div class="flex space-x-4"> 
                        <a class="text-sm text-gray-500 transition hover:text-gray-600 dark:hover:text-gray-400" target="_blank" rel="noopener noreferrer" href="mailto:pece@predragtasevski.com">
                        <span class="sr-only">Mail</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 dark:text-gray-200 h-6 w-6">
                            <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                            <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                        </svg>
                        </a>
                        <a class="text-sm text-gray-500 transition hover:text-gray-600 dark:hover:text-gray-400" target="_blank" rel="noopener noreferrer" href="https://github.com/stepcellwolf/">
                        <span class="sr-only">GitHub</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 h-6 w-6">
                            <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path>
                        </svg>
                        </a>
                        <a class="text-sm text-gray-500 transition hover:text-gray-600 dark:hover:text-gray-400" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/tpredrag">
                        <span class="sr-only">LinkedIn</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 h-6 w-6">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452z"></path>
                        </svg>
                        </a>
                        <a class="text-sm text-gray-500 transition hover:text-gray-600 dark:hover:text-gray-400" target="_blank" rel="noopener noreferrer" href="https://twitter.com/stepcellwolf">
                        <span class="sr-only">Twitter</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 h-6 w-6">
                            <path d="M23.954 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417A9.867 9.867 0 010 19.54a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path>
                        </svg>
                        </a>
                        <a class="text-sm text-gray-500 transition hover:text-gray-600 dark:hover:text-gray-400" target="_blank" rel="noopener noreferrer" href="https://mastodon.social/@stepcellwolf">
                        <span class="sr-only">Mastodon</span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 h-6 w-6">
                            <path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753v-1.809l-.02-.041a20.282 20.282 0 0 1-4.709.545c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 0 1-.319-1.433c1.517.363 3.072.546 4.632.546.376 0 .75 0 1.125-.01 1.57-.044 3.224-.124 4.768-.422z"></path>
                        </svg>
                        </a>
                    </div> 
                 </div> 
                </div> 

                <!-- Copyright & License -->
                <div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"> 
                    <p class="text-center text-sm text-gray-600 dark:text-gray-400"> &copy; 2026 Predrag Tasevski. Content licensed under <a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" target="_blank" rel="noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/">
                    CC BY-NC 4.0</a>. Built with <a href="https://www.11ty.dev/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Eleventy</a> and <a href="https://tailwindcss.com/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Tailwind CSS</a>. <span></p> 
                </div>

                <!-- Privacy Statement -->
                <div class="mb-8 text-sm text-gray-500 dark:text-gray-400">
                    <strong>Privacy statement:</strong> I use <a href="https://www.goatcounter.com/" target="_blank">GoatCounter</a> analytics to collect and report on how my site is used; no advertising or tracking cookies are stored. Data collected does not personally identify visitors.
                </div>
            </div>
                
    </footer>
    
    <!-- Scripts -->
    <script>
        function toggleDarkMode() {
            const html = document.documentElement;
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.theme = 'light';
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            } else {
                html.classList.add('dark');
                localStorage.theme = 'dark';
                if (themeColorMeta) themeColorMeta.content = '#111827';
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Show success message
                showToast('Link copied to clipboard!');
            }, function(err) {
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-999999px";
                textArea.style.top = "-999999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('Link copied to clipboard!');
                } catch (err) {
                    showToast('Failed to copy link');
                }
                document.body.removeChild(textArea);
            });
        }
        
        function showToast(message) {
            // Create toast element
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-gray-800 dark:bg-gray-200 text-white dark:text-gray-800 px-4 py-2 rounded-lg shadow-lg transform transition-all duration-300 translate-y-full';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.classList.remove('translate-y-full');
                toast.classList.add('translate-y-0');
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('translate-y-0');
                toast.classList.add('translate-y-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }
    </script>
    
    <!-- Core JavaScript Bundle (ui-enhancements, back-to-top, code-collapse) -->
    <script src="/assets/js/core.min.js"></script>
    
    <!-- Mermaid Diagram Support -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        // Determine if dark mode is active
        const isDarkMode = document.documentElement.classList.contains('dark');
        
        // Initialize mermaid with proper settings
        mermaid.initialize({ 
            startOnLoad: false, // We'll manually init after DOM manipulation
            theme: isDarkMode ? 'dark' : 'default',
            themeVariables: isDarkMode ? {
                // Dark mode theme
                primaryColor: '#4f46e5',
                primaryTextColor: '#f3f4f6',
                primaryBorderColor: '#6366f1',
                lineColor: '#4b5563',
                secondaryColor: '#374151',
                tertiaryColor: '#1f2937',
                background: '#111827',
                mainBkg: '#1f2937',
                secondBkg: '#374151',
                tertiaryBkg: '#4b5563',
                primaryBorderColor: '#6366f1',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: true,
                nodeBkg: '#374151',
                nodeBorder: '#6366f1',
                clusterBkg: '#1f2937',
                clusterBorder: '#4b5563',
                defaultLinkColor: '#93bbfd',
                titleColor: '#f3f4f6',
                edgeLabelBackground: '#1f2937',
                actorBorder: '#6366f1',
                actorBkg: '#374151',
                actorTextColor: '#f3f4f6',
                actorLineColor: '#4b5563',
                signalColor: '#f3f4f6',
                signalTextColor: '#f3f4f6',
                labelBoxBkgColor: '#374151',
                labelBoxBorderColor: '#6366f1',
                labelTextColor: '#f3f4f6',
                loopTextColor: '#f3f4f6',
                noteBorderColor: '#6366f1',
                noteBkgColor: '#374151',
                noteTextColor: '#f3f4f6',
                activationBorderColor: '#6366f1',
                activationBkgColor: '#374151',
                sequenceNumberColor: '#111827'
            } : {
                // Light mode theme
                primaryColor: '#6366f1',
                primaryTextColor: '#fff',
                primaryBorderColor: '#4f46e5',
                lineColor: '#d1d5db',
                secondaryColor: '#e5e7eb',
                tertiaryColor: '#f3f4f6',
                background: '#ffffff',
                mainBkg: '#ffffff',
                secondBkg: '#f3f4f6',
                tertiaryBkg: '#e5e7eb',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: false,
                nodeBkg: '#f3f4f6',
                nodeBorder: '#4f46e5',
                clusterBkg: '#e5e7eb',
                clusterBorder: '#9ca3af',
                defaultLinkColor: '#2563eb',
                titleColor: '#1f2937',
                edgeLabelBackground: '#ffffff',
                actorBorder: '#4f46e5',
                actorBkg: '#f3f4f6',
                actorTextColor: '#1f2937',
                actorLineColor: '#9ca3af',
                signalColor: '#1f2937',
                signalTextColor: '#1f2937',
                labelBoxBkgColor: '#f3f4f6',
                labelBoxBorderColor: '#4f46e5',
                labelTextColor: '#1f2937',
                loopTextColor: '#1f2937',
                noteBorderColor: '#4f46e5',
                noteBkgColor: '#f3f4f6',
                noteTextColor: '#1f2937',
                activationBorderColor: '#4f46e5',
                activationBkgColor: '#e5e7eb',
                sequenceNumberColor: '#ffffff'
            },
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
        
        // Process Mermaid diagrams and THEN initialize code-collapse
        window.addEventListener('DOMContentLoaded', async function() {
            // Step 1: Find and process all mermaid code blocks
            const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
            
            if (mermaidBlocks.length > 0) {
                // Processing Mermaid diagrams
                
                // Convert each mermaid code block to a diagram
                for (const element of mermaidBlocks) {
                    const graphDefinition = element.textContent;
                    const preElement = element.parentNode;
                    
                    // Create a container div for the mermaid diagram
                    const containerDiv = document.createElement('div');
                    containerDiv.className = 'mermaid-container';
                    containerDiv.setAttribute('data-mermaid', 'true');
                    
                    // Create the mermaid div
                    const graphDiv = document.createElement('div');
                    graphDiv.className = 'mermaid';
                    graphDiv.textContent = graphDefinition;
                    
                    // Replace the pre element with the container - this removes the code block entirely
                    preElement.parentNode.replaceChild(containerDiv, preElement);
                    containerDiv.appendChild(graphDiv);
                }
                
                // Step 2: Initialize all mermaid diagrams with error handling
                try {
                    await mermaid.run();
                    console.log(`✅ Successfully rendered ${mermaidBlocks.length} Mermaid diagram(s)`);
                } catch (error) {
                    console.error('❌ Mermaid rendering failed:', error);
                    // Log each diagram's content for debugging
                    document.querySelectorAll('.mermaid').forEach((div, index) => {
                        console.error(`Diagram ${index + 1} content:`, div.textContent);
                    });
                }

                // Diagrams are now styled via CSS, no need for inline styles
            }
            
            // Step 3: Code-collapse.js is already loaded and will handle remaining blocks
            // It checks for data-processed attribute to avoid duplicates
        });
    </script>
</body>
</html>