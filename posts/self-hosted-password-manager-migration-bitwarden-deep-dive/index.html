<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Migrate to self-hosted Bitwarden—deploy secure vault with backup strategies, SSL certificates, and database encryption for full control.">
    <meta name="author" content="William Zujkowski">
    <meta name="keywords" content="cybersecurity, information security, AI security, Zero-Trust, homelab, security engineering, NIST compliance, federal security">
    
    <title>Self-Hosted Password Manager Migration: Bitwarden Deep Dive - William Zujkowski</title>
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://williamzujkowski.github.io/posts/self-hosted-password-manager-migration-bitwarden-deep-dive/">
    
    <!-- RSS Feed -->
    <link rel="alternate" type="application/atom+xml" title="William Zujkowski Feed" href="https://williamzujkowski.github.io/feed.xml">
    
    <!-- Favicons and PWA -->
    
<!-- Primary Favicons -->
<link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg">

<!-- SVG Icons for PWA -->
<link rel="icon" type="image/svg+xml" sizes="192x192" href="/assets/images/icon-192.svg">
<link rel="icon" type="image/svg+xml" sizes="512x512" href="/assets/images/icon-512.svg">

<!-- Theme Colors -->
<meta name="msapplication-TileColor" content="#1e40af">
<meta name="theme-color" content="#1e40af">

<!-- Web App Manifest -->
<link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Self-Hosted Password Manager Migration: Bitwarden Deep Dive">
    <meta property="og:description" content="Migrate to self-hosted Bitwarden—deploy secure vault with backup strategies, SSL certificates, and database encryption for full control.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://williamzujkowski.github.io/posts/self-hosted-password-manager-migration-bitwarden-deep-dive/">
    <meta property="og:image" content="https://williamzujkowski.github.io/assets/images/og-image.jpg">
    <meta property="og:site_name" content="William Zujkowski">
    <meta property="og:locale" content="en_US">
    
    <meta property="article:author" content="William Zujkowski">
    <meta property="article:published_time" content="2025-09-01">
    
    
    
    <!-- Additional SEO Meta -->
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        
        "headline": "Self-Hosted Password Manager Migration: Bitwarden Deep Dive",
        "description": "Migrate to self-hosted Bitwarden—deploy secure vault with backup strategies, SSL certificates, and database encryption for full control.",
        "datePublished": "2025-09-01",
        "dateModified": "2025-11-15",
        "author": {
            "@type": "Person",
            "name": "William Zujkowski",
            "url": "https://williamzujkowski.github.io/about/",
            "sameAs": [
                "https://github.com/williamzujkowski",
                "https://www.linkedin.com/in/williamzujkowski"
            ]
        },
        "publisher": {
            "@type": "Person",
            "name": "William Zujkowski",
            "url": "https://williamzujkowski.github.io",
            "logo": {
                "@type": "ImageObject",
                "url": "https://williamzujkowski.github.io/assets/images/headshot.png"
            }
        },
        "image": {
            "@type": "ImageObject",
            "url": "https://williamzujkowski.github.io/assets/images/og-image.jpg"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://williamzujkowski.github.io/posts/self-hosted-password-manager-migration-bitwarden-deep-dive/"
        },
        "url": "https://williamzujkowski.github.io/posts/self-hosted-password-manager-migration-bitwarden-deep-dive/"
        
    }
    </script>
    
    <!-- Resource Hints for Performance -->
    <link rel="preconnect" href="https://rsms.me">
    <link rel="dns-prefetch" href="https://rsms.me">
    
    <!-- Inter font -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    
    <!-- Dark mode script -->
    <script>
        // Initialize dark mode and theme color
        (function() {
            const isDark = localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (isDark) {
                document.documentElement.classList.add('dark');
                if (themeColorMeta) themeColorMeta.content = '#111827';
            } else {
                document.documentElement.classList.remove('dark');
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            }
        })();
    </script>
</head>
<body class="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-300 antialiased">
    <a href="#main" class="skip-to-main">Skip to main content</a>


    
    <!-- Header -->
    <header role="banner" aria-label="Site header" class="site-header sticky top-0 z-50 w-full">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8" aria-label="Primary navigation">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0">
                    <a href="/" class="text-xl font-semibold gradient-text">
                        William Zujkowski
                    </a>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1">
                        <ul class="flex items-center space-x-1"><li><a href="/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Uses</a></li></ul>
                    </div>
                </div>
                
                <!-- Dark mode toggle & Mobile menu button -->
                <div class="flex items-center space-x-4">
                    <!-- Dark mode toggle -->
                    <button type="button" onclick="toggleDarkMode()" class="min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle dark mode">
                        <!-- Light mode icon -->
                        <svg class="w-5 h-5 block dark:hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <!-- Dark mode icon -->
                        <svg class="w-5 h-5 hidden dark:block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg>
                    </button>
                    
                    <!-- Mobile menu button -->
                    <button type="button" onclick="toggleMobileMenu()" class="md:hidden min-w-[44px] min-h-[44px] flex items-center justify-center rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200" aria-label="Toggle menu" data-mobile-menu-button>
                        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="hidden md:hidden" data-mobile-menu-panel>
                <div class="px-2 pt-2 pb-3 space-y-1">
                    <ul class="space-y-1"><li><a href="/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="block px-4 py-3 min-h-[44px] rounded-lg text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200">Uses</a></li></ul>
                </div>
            </div>
        </nav>
    </header>
    
    <!-- Breadcrumbs -->
    
    
    <!-- Main content -->
    <main id="main" class="flex-grow">
        <!-- Enhanced Breadcrumbs for Blog Posts -->
<nav class="container mx-auto px-4 sm:px-6 lg:px-8 py-4" aria-label="Breadcrumb">
  <ol class="flex items-center space-x-2 text-sm flex-wrap">
    <li>
      <a href="/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        <svg class="w-4 h-4 inline-block mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        Home
      </a>
    </li>
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <a href="/posts/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
        Blog
      </a>
    </li>
    
      
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
      
      <li class="flex items-center">
        <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <a href="/tags/cryptography/" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors">
          cryptography
        </a>
      </li>
      
    
    <li class="flex items-center">
      <svg class="w-4 h-4 mx-2 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
      <span class="text-gray-900 dark:text-gray-100 font-medium truncate max-w-xs">Self-Hosted Password Manager Migration: Bitwarden...</span>
    </li>
  </ol>
</nav>

<article class="py-16 sm:py-24">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="mx-auto max-w-3xl">
            <header role="banner" aria-label="Site header" class="mb-12">
                <div class="text-center">
                    <div class="flex items-center justify-center space-x-4 text-sm font-medium">
                        <time datetime="2025-09-01" class="text-primary-600 dark:text-primary-400">
                            September 1, 2025
                        </time>
                        <span class="text-gray-400 dark:text-gray-600">•</span>
                        <span class="text-gray-600 dark:text-gray-400">
                            12 min read
                        </span>
                    </div>
                    <h1 class="mt-4 text-4xl font-bold tracking-tight text-gray-900 dark:text-gray-100 sm:text-5xl animate-fade-in-up">
                        Self-Hosted Password Manager Migration: Bitwarden Deep Dive
                    </h1>
                    
                    <p class="mt-6 text-lg leading-8 text-gray-600 dark:text-gray-300 animate-fade-in-up animation-delay-200">
                        Migrate to self-hosted Bitwarden—deploy secure vault with backup strategies, SSL certificates, and database encryption for full control.
                    </p>
                    
                </div>
                
                
                <div class="mt-8 flex flex-wrap justify-center gap-2 animate-fade-in-up animation-delay-400">
                    
                        
                    
                        
                        <a href="/tags/cryptography/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            cryptography
                        </a>
                        
                    
                        
                        <a href="/tags/homelab/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            homelab
                        </a>
                        
                    
                        
                        <a href="/tags/passwords/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            passwords
                        </a>
                        
                    
                        
                        <a href="/tags/privacy/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            privacy
                        </a>
                        
                    
                        
                        <a href="/tags/security/" class="inline-flex items-center rounded-full bg-primary-50 dark:bg-primary-900/20 px-3 py-1 text-sm font-medium text-primary-700 dark:text-primary-300 hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors">
                            security
                        </a>
                        
                    
                </div>
                
            </header>

            <!-- Table of Contents Accordion -->
            <nav aria-label="Table of contents" class="toc-accordion mb-8 animate-fade-in-up animation-delay-500">
                <details class="group">
                    <summary class="cursor-pointer select-none font-medium flex items-center justify-between">
                        <span>Table of Contents</span>
                        <svg class="w-5 h-5 transform group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </summary>
                    <div class="toc-content mt-4" id="toc-content">
                        <!-- ToC will be generated here by JavaScript -->
                    </div>
                </details>
            </nav>

            <div class="prose prose-lg prose-gray dark:prose-invert mx-auto animate-fade-in-up animation-delay-600">
                <h2>The Cloud Password Manager Breach That Changed Everything</h2>
<p><img class="max-w-full h-auto" src="https://images.unsplash.com/photo-1614064641938-3bbee52942c7?w=1920&amp;q=80" alt="Digital lock and security concept" loading="lazy">
<em>Photo by FLY:D on Unsplash</em></p>
<p><strong>BLUF:</strong> Cloud password manager breaches happen every few years. When LastPass disclosed their 2022 incident, I moved 500+ passwords to self-hosted Bitwarden. Two years later, I have better security, zero vendor lock-in, and complete data ownership. Here's how to migrate safely.</p>
<h2>Self-Hosted Password Management Architecture</h2>
<pre><code class="language-mermaid">flowchart TB
    subgraph clientaccess[&quot;Client Access&quot;]
        Web[Web Vault]
        Mobile[Mobile Apps]
        Desktop[Desktop Apps]
        Browser[Browser Extensions]
    end
    subgraph bitwardenserver[&quot;Bitwarden Server&quot;]
        Nginx[Nginx Reverse Proxy]
        Vaultwarden[Vaultwarden Service]
        DB[(SQLite/PostgreSQL)]
    end
    subgraph securitylayer[&quot;Security Layer&quot;]
        Firewall[Firewall Rules]
        WAF[ModSecurity WAF]
        Fail2ban[Fail2ban]
        TLS[TLS 1.3]
    end
    subgraph backuprecovery[&quot;Backup &amp; Recovery&quot;]
        Local[Local Backups]
        Offsite[Offsite Backups]
        Encrypted[Encrypted Storage]
        Versioned[Version Control]
    end

    Web --&gt; Nginx
    Mobile --&gt; Nginx
    Desktop --&gt; Nginx
    Browser --&gt; Nginx

    Nginx --&gt; WAF
    WAF --&gt; Vaultwarden
    Vaultwarden --&gt; DB

    Firewall --&gt; Nginx
    Fail2ban --&gt; Nginx
    TLS --&gt; Nginx

    DB --&gt; Local
    Local --&gt; Encrypted
    Encrypted --&gt; Offsite
    Offsite --&gt; Versioned

    classDef successStyle fill:#4caf50,color:#fff
    classDef warningStyle fill:#ff9800,color:#fff
    classDef criticalStyle fill:#f44336,color:#fff
    class Vaultwarden successStyle
    class WAF warningStyle
    class Encrypted criticalStyle
</code></pre>
<h2>Why Self-Host?</h2>
<p>Self-hosting password management shifts trust from vendors to yourself. The trade-off is operational responsibility. This aligns with <a href="/posts/2024-07-09-zero-trust-architecture-implementation">zero-trust security principles</a> where you verify everything and trust nothing by default.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li><strong>Full control</strong>: Own infrastructure and data (see <a href="/posts/2025-04-24-building-secure-homelab-adventure">secure homelab adventures</a>)</li>
<li><strong>Zero vendor risk</strong>: No third-party breaches</li>
<li><strong>Network privacy</strong>: Passwords never leave your network (see <a href="/posts/2025-10-29-privacy-first-ai-lab-local-llms">privacy-first AI lab</a>)</li>
<li><strong>Custom security</strong>: Tailor to your threat model</li>
<li><strong>Zero cost</strong>: Free for personal use (Vaultwarden)</li>
</ul>
<p><strong>Drawbacks:</strong></p>
<ul>
<li><strong>You're the security team</strong>: Patching, monitoring, incident response</li>
<li><strong>Complexity overhead</strong>: More components to secure</li>
<li><strong>Availability burden</strong>: Downtime affects all devices</li>
<li><strong>Disaster planning required</strong>: Infrastructure loss needs backup strategy</li>
</ul>
<p>Self-hosting makes sense if you have technical skills and reliable infrastructure. Cloud services are better if you lack experience or time for maintenance.</p>
<h2>Choosing Bitwarden vs Vaultwarden</h2>
<p>Two implementations offer different trade-offs:</p>
<p><strong>Bitwarden (Official):</strong></p>
<ul>
<li>Full feature set</li>
<li>Requires .NET runtime</li>
<li>~500MB RAM usage</li>
<li>Official support channels</li>
</ul>
<p><strong>Vaultwarden (Rust rewrite):</strong></p>
<ul>
<li>~10MB RAM (98% reduction)</li>
<li>Single binary deployment</li>
<li>API-compatible with all clients</li>
<li>Community support only</li>
</ul>
<p>I run Vaultwarden for resource efficiency and deployment simplicity. My Proxmox LXC container uses 47MB total with database included.</p>
<h2>Installation and Setup</h2>
<h3>Docker Compose Deployment</h3>
<script src="https://gist.github.com/williamzujkowski/dc0728c2908e4689896f35bec5f3855a.js"></script>
<h3>Deploy the Stack</h3>
<script src="https://gist.github.com/williamzujkowski/b8cb1cd1d6ff8f64425f02ec912a6d1a.js"></script>
<h2>Reverse Proxy Configuration</h2>
<h3>Nginx with TLS</h3>
<script src="https://gist.github.com/williamzujkowski/f11619209152dd8cf3ed558335ac7a3f.js"></script>
<h2>Security Hardening</h2>
<h3>Fail2ban Configuration</h3>
<p>Protect against brute-force attacks:</p>
<script src="https://gist.github.com/williamzujkowski/28d9a26bcff2a02c2d0aabbaf570b409.js"></script>
<p>Restart Fail2ban:</p>
<pre><code class="language-bash">sudo systemctl restart fail2ban
sudo fail2ban-client status vaultwarden
</code></pre>
<h3>Firewall Rules</h3>
<p>For comprehensive firewall configuration and network segmentation strategies, see my guide on <a href="/posts/2024-01-30-securing-cloud-native-frontier">securing cloud-native applications</a>:</p>
<script src="https://gist.github.com/williamzujkowski/0549ee4b142ddff4d684e8ec21fb0317.js"></script>
<h3>Two-Factor Authentication</h3>
<p>Enable 2FA for all accounts through web vault:</p>
<ul>
<li>Navigate: Settings → Security → Two-step Login</li>
<li>Select: Authenticator App (TOTP)</li>
<li>Scan QR code with Aegis/Authy/Google Authenticator</li>
<li>Save recovery code offline (printed, in safe)</li>
</ul>
<p>Recovery codes are critical. Without them, device loss means account lockout.</p>
<h3>TOTP Backup Storage Strategy</h3>
<p><strong>Encrypted TOTP seed storage:</strong> Your authenticator app's TOTP seeds should be backed up separately from Bitwarden. If you lose your phone AND master password simultaneously, recovery codes won't help if they're stored in the vault you can't access.</p>
<p><strong>Recommended approach:</strong> Export TOTP seeds from your authenticator app (Aegis supports encrypted exports, Google Authenticator does not). Encrypt the export with GPG using <code>gpg --symmetric --cipher-algo AES256 totp-seeds.txt &gt; totp-backup.gpg</code>. Store encrypted backups in three locations: fireproof safe (home), bank safety deposit box (offsite), and encrypted cloud storage (Backblaze B2, separate passphrase from Bitwarden). Never store the decryption passphrase with the encrypted file. Test recovery quarterly by decrypting backup and importing to a test device to verify all TOTP codes work.</p>
<h3>Backup Key Management (MODERATE)</h3>
<p><strong>The Problem:</strong> Self-hosted password managers create a single point of failure for ALL your credentials. Lose access to your Bitwarden instance + master password, and every account password is gone. Backup key management isn't optional—it's disaster recovery planning.</p>
<p><strong>Why it matters:</strong> Unlike cloud providers with account recovery workflows, self-hosted means YOU are responsible for ALL recovery scenarios. No support team can help you. Master password loss + no backup export = permanent data loss.</p>
<h4>Recovery Code Storage Best Practices</h4>
<p><strong>2FA recovery codes (30-digit codes from Authenticator setup):</strong></p>
<pre><code class="language-bash"># CRITICAL: Store recovery codes in multiple secure locations
# Location 1: Printed hardcopy in fireproof safe (primary)
# Location 2: Encrypted USB drive in bank safety deposit box (offsite)
# Location 3: Encrypted cloud storage (encrypted with different passphrase)

# Generate encrypted backup of recovery codes
echo &quot;Primary 2FA Recovery: XXXX-XXXX-XXXX-XXXX-XXXX-XXXX&quot; | gpg --symmetric --cipher-algo AES256 &gt; bitwarden-2fa-recovery.gpg

# Store encrypted file in 3 locations
# DO NOT store decryption passphrase with encrypted file
</code></pre>
<p><strong>Storage location requirements:</strong></p>
<ul>
<li>[ ] Physical copy in fireproof/waterproof safe (home)</li>
<li>[ ] Encrypted digital copy offsite (bank safety deposit box)</li>
<li>[ ] Encrypted cloud backup (Backblaze B2, encrypted before upload)</li>
<li>[ ] Decryption passphrase memorized or stored separately</li>
</ul>
<p><strong>Common mistakes:</strong></p>
<ul>
<li>❌ Screenshot saved to cloud photos (plaintext, accessible if cloud compromised)</li>
<li>❌ Stored in Bitwarden itself (can't access if locked out)</li>
<li>❌ Single location only (house fire = total loss)</li>
<li>✅ Multiple locations, different security domains (physical + digital + offsite)</li>
</ul>
<h4>Master Password Loss Scenarios</h4>
<p><strong>Scenario 1: Master password forgotten, 2FA device available</strong></p>
<ul>
<li><strong>Impact:</strong> CANNOT recover master password (zero-knowledge encryption)</li>
<li><strong>Solution:</strong> Use 2FA recovery code to access vault, immediately export all passwords, create new vault with new master password, import passwords, update all recovery codes</li>
<li><strong>Time to recovery:</strong> 2-4 hours (export + reimport + reconfigure)</li>
</ul>
<p><strong>Scenario 2: Master password forgotten, 2FA device lost, have recovery codes</strong></p>
<ul>
<li><strong>Impact:</strong> Can log in with recovery code, but still cannot recover master password</li>
<li><strong>Solution:</strong> Same as Scenario 1 (export + rebuild)</li>
<li><strong>Time to recovery:</strong> 2-4 hours</li>
</ul>
<p><strong>Scenario 3: Master password forgotten, 2FA device lost, NO recovery codes</strong></p>
<ul>
<li><strong>Impact:</strong> TOTAL DATA LOSS (permanent lockout)</li>
<li><strong>Solution:</strong> Restore from backup export file (if you have one)</li>
<li><strong>Time to recovery:</strong> N/A if no backup exists</li>
</ul>
<p><strong>Scenario 4: Server failure, have backup database, forgot master password</strong></p>
<ul>
<li><strong>Impact:</strong> Database encrypted with master password, cannot decrypt</li>
<li><strong>Solution:</strong> None (database is useless without master password)</li>
<li><strong>Prevention:</strong> Regular encrypted exports that you CAN decrypt</li>
</ul>
<h4>Emergency Access Setup</h4>
<p><strong>For family/trusted contacts (Bitwarden Premium feature):</strong></p>
<pre><code class="language-bash"># Configure emergency access for spouse/family member
# Settings → Emergency Access → Invite Emergency Contact

# Emergency contact workflow:
# 1. Contact requests emergency access
# 2. Wait period expires (7-30 days, configurable)
# 3. If you don't reject, they gain access
# 4. They can view/takeover vault depending on permission level
</code></pre>
<p><strong>Emergency access levels:</strong></p>
<ul>
<li><strong>View:</strong> Read-only access to passwords (for account recovery assistance)</li>
<li><strong>Takeover:</strong> Full access, can change master password (for estate planning)</li>
</ul>
<p><strong>Wait period considerations:</strong></p>
<ul>
<li><strong>7 days:</strong> Balance between security and actual emergency (recommended)</li>
<li><strong>30 days:</strong> Maximum security, delays legitimate emergency access</li>
<li><strong>0 days:</strong> Security risk, compromised contact = immediate vault access</li>
</ul>
<h4>Backup Export Encryption</h4>
<p><strong>Database backups vs password exports:</strong></p>
<table>
<thead>
<tr>
<th><strong>Backup Type</strong></th>
<th><strong>Encryption</strong></th>
<th><strong>Master Password Required</strong></th>
<th><strong>Use Case</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Database dump (db.sqlite3)</td>
<td>Encrypted with master password</td>
<td>YES (always)</td>
<td>Disaster recovery with known master password</td>
</tr>
<tr>
<td>JSON export (unencrypted)</td>
<td>NONE</td>
<td>NO</td>
<td>Dangerous, only for migrations</td>
</tr>
<tr>
<td>JSON export (encrypted)</td>
<td>Password-protected file</td>
<td>YES (decryption)</td>
<td>Secure offline backup</td>
</tr>
</tbody>
</table>
<p><strong>Create encrypted export:</strong></p>
<pre><code class="language-bash"># Export from Bitwarden CLI
bw export --format encrypted_json --password &quot;$BACKUP_PASSWORD&quot; &gt; bitwarden-backup-2025-11-12.json.enc

# Encrypt again with GPG for defense-in-depth
gpg --symmetric --cipher-algo AES256 bitwarden-backup-2025-11-12.json.enc

# Verify encrypted file can be decrypted
gpg --decrypt bitwarden-backup-2025-11-12.json.enc.gpg &gt; test-decrypt.json.enc
bw import encrypted_json test-decrypt.json.enc --password &quot;$BACKUP_PASSWORD&quot;

# Store backup password separately from backup file
# Options:
# 1. KeePassXC file on different encrypted USB
# 2. Paper printout in safe (different location from backup)
# 3. Memorized passphrase (minimum 8 words, Diceware recommended)
</code></pre>
<p><strong>Backup storage hierarchy:</strong></p>
<ol>
<li><strong>Local encrypted backup:</strong> NAS with encrypted ZFS pool (daily automated)</li>
<li><strong>Offsite encrypted backup:</strong> Encrypted before uploading to Backblaze B2 (weekly)</li>
<li><strong>Cold storage backup:</strong> Encrypted USB in bank safety deposit box (monthly)</li>
<li><strong>Emergency export:</strong> Encrypted JSON on USB given to emergency contact (quarterly update)</li>
</ol>
<h4>Encryption Key Rotation</h4>
<p><strong>When to rotate master password:</strong></p>
<ul>
<li>[ ] Annually (proactive security hygiene)</li>
<li>[ ] After suspected compromise (immediately)</li>
<li>[ ] After employee/family member loses access (within 24 hours)</li>
<li>[ ] After exporting for migration (export file contains old passwords)</li>
</ul>
<p><strong>Rotation procedure:</strong></p>
<pre><code class="language-bash"># 1. Export current vault (encrypted)
bw export --format encrypted_json --password &quot;$BACKUP_PASSWORD&quot; &gt; pre-rotation-backup.json.enc

# 2. Change master password in web vault
# Settings → Security → Master Password → Change Master Password

# 3. Re-export with new master password encryption
bw export --format encrypted_json --password &quot;$NEW_BACKUP_PASSWORD&quot; &gt; post-rotation-backup.json.enc

# 4. Securely delete old backups (or keep with clear labeling)
shred -vfz -n 10 pre-rotation-backup.json.enc

# 5. Update all recovery codes (2FA reset triggers new codes)
# Settings → Two-step Login → Disable → Re-enable (generates new recovery codes)

# 6. Update emergency access contacts
# Emergency contacts must be re-invited after master password change
</code></pre>
<p><strong>Frequency recommendations:</strong></p>
<ul>
<li><strong>Master password:</strong> Annually or after incident</li>
<li><strong>2FA recovery codes:</strong> After master password change</li>
<li><strong>Backup exports:</strong> Weekly (automated)</li>
<li><strong>Backup password:</strong> Annually (align with master password rotation)</li>
</ul>
<h4>Validation Checklist</h4>
<p>Test your backup recovery capability monthly:</p>
<pre><code class="language-bash"># Monthly validation workflow
# 1. Restore database backup to test instance
docker run -d --name vaultwarden-test \
  -v ./test-backup/:/data/ \
  vaultwarden/server:latest

# 2. Verify login with master password
curl -X POST https://test-vault.local/identity/connect/token \
  -d &quot;grant_type=password&amp;username=test@example.com&amp;password=$MASTER_PASSWORD&quot;

# 3. Test encrypted export decryption
bw import encrypted_json backup.json.enc --password &quot;$BACKUP_PASSWORD&quot;

# 4. Verify 2FA recovery code works
# Log out, log in with recovery code instead of TOTP

# 5. Test emergency access workflow
# Initiate emergency access request, verify notification received

# 6. Document results
echo &quot;$(date): Backup validation PASSED/FAILED&quot; &gt;&gt; backup-validation-log.txt
</code></pre>
<p><strong>Senior engineer perspective:</strong> Years of security work taught me that backup testing is where theory meets reality. I've seen teams lose entire vaults because &quot;we have backups&quot; actually meant &quot;we have encrypted files we can't decrypt because the backup password was stored IN the vault.&quot; Test your full recovery workflow quarterly under simulated emergency conditions: no access to production server, no cached browser sessions, only your printed recovery codes and encrypted backups. If you can't recover from that scenario, your backup strategy is fiction.</p>
<h3>Admin Panel Security (CRITICAL)</h3>
<p><strong>The Problem:</strong> Vaultwarden enables an admin panel at <code>/admin</code> by default. Without proper configuration, anyone who discovers this endpoint can access server settings, disable security features, and view administrative information.</p>
<p><strong>Why it matters:</strong> An exposed admin panel is a critical vulnerability for internet-facing deployments. The risk severity depends on your deployment:</p>
<ul>
<li><strong>Internet-exposed:</strong> CRITICAL (CVE-waiting-to-happen)</li>
<li><strong>Internal-only:</strong> HIGH (lateral movement risk)</li>
<li><strong>Localhost-only:</strong> MEDIUM (requires local access)</li>
</ul>
<p><strong>Required configuration in docker-compose.yml:</strong></p>
<pre><code class="language-yaml">environment:
  - ADMIN_TOKEN=${ADMIN_TOKEN}
  - DISABLE_ADMIN_TOKEN=false  # Optional: Disable after initial setup
  # - ADMIN_TOKEN=&quot;&quot; # Completely disables admin panel (recommended after configuration)
</code></pre>
<p><strong>Generate secure admin token:</strong></p>
<pre><code class="language-bash"># Generate 48-byte random token
openssl rand -base64 48

# Add to .env file (NEVER commit this!)
echo &quot;ADMIN_TOKEN=$(openssl rand -base64 48)&quot; &gt;&gt; .env

# Set restrictive permissions
chmod 600 .env
</code></pre>
<p><strong>Best practices:</strong></p>
<ol>
<li><strong>Initial setup:</strong> Set ADMIN_TOKEN for configuration access</li>
<li><strong>After configuration:</strong> Either disable completely (<code>ADMIN_TOKEN=&quot;&quot;</code>) or restrict by IP</li>
<li><strong>Never:</strong> Leave admin panel accessible without authentication</li>
<li><strong>Production:</strong> Disable panel entirely unless actively debugging</li>
</ol>
<p><strong>IP restriction (if panel needed long-term):</strong></p>
<p>Add to nginx configuration:</p>
<pre><code class="language-nginx">location /admin {
    allow 192.168.1.0/24;  # Your management network
    deny all;
    proxy_pass http://vaultwarden:80;
}
</code></pre>
<p><strong>Verification:</strong></p>
<pre><code class="language-bash"># Test authentication requirement
curl -I https://vault.example.com/admin
# Should return 401 Unauthorized or redirect to login

# Test IP restriction (if configured)
curl -I https://vault.example.com/admin
# From restricted IP: Should return 403 Forbidden
</code></pre>
<p><strong>Senior engineer note:</strong> Years of production experience taught me admin interfaces are often forgotten after initial setup. The security-conscious approach: configure once, disable immediately. Vaultwarden's runtime configuration rarely needs changes. If you do need admin access later, temporarily enable with environment variable, make changes, then disable again.</p>
<h3>YubiKey Integration</h3>
<p>For hardware 2FA:</p>
<ol>
<li>Settings → Security → Two-step Login</li>
<li>Choose YubiKey OTP Security Key</li>
<li>Insert YubiKey and tap when prompted</li>
<li>Register up to 5 keys (have backups!)</li>
</ol>
<h2>Data Migration</h2>
<h3>Exporting from Cloud Password Managers</h3>
<p><strong>From LastPass:</strong></p>
<pre><code>1. Log into LastPass web vault
2. More Options → Advanced → Export
3. Save as CSV
4. Import to Bitwarden: Tools → Import Data
</code></pre>
<p><strong>From 1Password:</strong></p>
<pre><code>1. File → Export → All Items
2. Choose format: 1Password Interchange Format (1PIF)
3. Import to Bitwarden
</code></pre>
<p><strong>From Dashlane:</strong></p>
<pre><code>1. File → Export → Unsecured Archive (CSV)
2. Import to Bitwarden
</code></pre>
<h3>Post-Migration Cleanup</h3>
<pre><code class="language-bash"># Securely delete export files
shred -vfz -n 10 lastpass-export.csv

# Verify all passwords imported
# Check organizations, folders, and items manually

# Update master passwords on all devices
</code></pre>
<h2>Backup Strategy</h2>
<h3>Automated Database Backups</h3>
<script src="https://gist.github.com/williamzujkowski/f007271e97105ae16de1d28a2cfbe9d7.js"></script>
<p>Schedule with cron:</p>
<pre><code class="language-bash"># Run daily at 3 AM
0 3 * * * /usr/local/bin/backup-vaultwarden.sh
</code></pre>
<h3>Testing Backup Restoration</h3>
<script src="https://gist.github.com/williamzujkowski/327bbe4806d93f947478373788a4ede5.js"></script>
<p><strong>Test your backups regularly!</strong> A backup you haven't tested is just wishful thinking.</p>
<h2>Monitoring and Maintenance</h2>
<p>Continuous monitoring is critical for self-hosted infrastructure. Learn more about <a href="/posts/2025-09-14-threat-intelligence-mitre-attack-dashboard">threat intelligence and monitoring</a> to build comprehensive security visibility.</p>
<h3>Health Check Script</h3>
<script src="https://gist.github.com/williamzujkowski/b5fd9b8c6991a5e43587cb78f30ff344.js"></script>
<h3>Prometheus Metrics</h3>
<p>Export metrics for monitoring:</p>
<pre><code class="language-yaml"># Add to docker-compose.yml
  vaultwarden-exporter:
    image: vaultwarden/vaultwarden-exporter:latest
    container_name: vaultwarden-exporter
    restart: unless-stopped
    environment:
      - VAULTWARDEN_URL=http://vaultwarden:80
    ports:
      - &quot;9998:9998&quot;
    networks:
      - bitwarden-net
</code></pre>
<h2>Client Setup</h2>
<h3>Browser Extension</h3>
<ol>
<li>Install Bitwarden extension for your browser</li>
<li>Click extension icon → Settings (gear icon)</li>
<li>Set Server URL: <code>https://vault.example.com</code></li>
<li>Log in with master password + 2FA</li>
</ol>
<h3>Mobile Apps</h3>
<p><strong>iOS:</strong></p>
<ol>
<li>Install Bitwarden from App Store</li>
<li>Settings → Self-hosted</li>
<li>Enter Server URL: <code>https://vault.example.com</code></li>
<li>Log in</li>
</ol>
<p><strong>Android:</strong></p>
<ol>
<li>Install Bitwarden from F-Droid or Play Store</li>
<li>Settings → Self-hosted</li>
<li>Enter Server URL: <code>https://vault.example.com</code></li>
<li>Enable biometric unlock after login</li>
</ol>
<h3>CLI Client</h3>
<script src="https://gist.github.com/williamzujkowski/4b8fc96deb050dd4376e396d71044031.js"></script>
<h2>Disaster Recovery Plan</h2>
<h3>Scenario 1: Server Failure</h3>
<ol>
<li><strong>Immediate</strong>: All clients have cached credentials (work offline)</li>
<li><strong>Short-term</strong>: Restore from backup to new server</li>
<li><strong>Long-term</strong>: Implement HA setup with failover</li>
</ol>
<h3>Scenario 2: Ransomware Attack</h3>
<ol>
<li><strong>Disconnect</strong>: Immediately isolate infected systems</li>
<li><strong>Assess</strong>: Determine extent of encryption</li>
<li><strong>Restore</strong>: Use offsite encrypted backups</li>
<li><strong>Verify</strong>: Check data integrity before going live</li>
</ol>
<h3>Scenario 3: Total Infrastructure Loss</h3>
<ol>
<li><strong>Emergency access</strong>: Bitwarden export file stored offline</li>
<li><strong>Rebuild</strong>: Deploy from scratch using backups</li>
<li><strong>Verify</strong>: Test logins and 2FA before production use</li>
</ol>
<h2>Lessons Learned</h2>
<p>Two years of self-hosting taught specific operational realities:</p>
<p><strong>1. Test backups monthly</strong>
I caught a corrupted backup during routine testing. That would have been catastrophic during real disaster recovery. Testing is not optional.</p>
<p><strong>2. Single server works for personal use</strong>
99.9% uptime without HA cluster. Good backups matter more than redundancy. Restoring from backup takes 15 minutes.</p>
<p><strong>3. Automate monitoring</strong>
Caught expiring SSL certificate via automated checks. Manual vigilance fails. Scripts catch problems at 3 AM.</p>
<p><strong>4. Security is about trade-offs</strong>
Perfect security makes systems unusable. Match security to your threat model, not theoretical maximums.</p>
<p><strong>5. Documentation saves time</strong>
2 AM outages require clear runbooks. Past-you writing documentation helps future-you during emergencies.</p>
<h2>Security Considerations</h2>
<p><strong>Risks I Accept:</strong></p>
<ul>
<li>Single server (mitigated by backups)</li>
<li>Self-signed internal CA (for internal services)</li>
<li>Home internet outage (have mobile backup)</li>
</ul>
<p><strong>Risks I Don't Accept:</strong></p>
<ul>
<li>Unencrypted backups</li>
<li>Weak master passwords</li>
<li>Missing 2FA</li>
<li><strong>Exposed admin panel</strong> (see Admin Panel Security section for mitigation)</li>
</ul>
<h2>Performance and Scaling</h2>
<p>Vaultwarden runs efficiently on minimal hardware:</p>
<ul>
<li><strong>RAM</strong>: ~15MB (Vaultwarden) + ~50MB (PostgreSQL)</li>
<li><strong>CPU</strong>: &lt;1% idle, ~5% during sync</li>
<li><strong>Storage</strong>: ~50MB database + attachments</li>
<li><strong>Network</strong>: &lt;50ms latency on local network</li>
</ul>
<p>Database holds 500+ passwords and 50+ shared items without performance degradation. Sync across 6 devices completes in &lt;2 seconds.</p>
<h2>Conclusion</h2>
<p>Self-hosting Bitwarden gave me complete password ownership. Two years of operation cost zero vendor fees and zero data breaches. The operational overhead is real but manageable.</p>
<p>For broader infrastructure security, explore <a href="/posts/2025-07-01-ebpf-security-monitoring-practical-guide">eBPF security monitoring</a> for kernel-level threat detection, or check out my <a href="/posts/2025-03-10-raspberry-pi-security-projects">Raspberry Pi security projects</a> for budget-friendly security solutions.</p>
<p>This approach works if you have technical skills and reliable infrastructure. Cloud services make more sense if you lack time or experience.</p>
<p>Start with basic Docker Compose deployment. Master operations first. Add advanced security and monitoring later. Your 500+ passwords are worth the effort.</p>
<hr>
<p><em>Self-hosting password managers? Share your setup, challenges, and lessons learned. Let's learn from each other's experiences!</em></p>

            </div>
            
            <!-- Related Posts -->
            
            
            
            
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
                
                    
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    
                        
                    
                
            
            
            
            
            <section aria-label="Content section" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Related Posts</h2>
                <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                    
                    
                    <article class="group">
                        <a href="/posts/promsketch-2-100x-faster-prometheus-queries-with-sketch-algorithms/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                PromSketch: 2-100x Faster Prometheus Queries with Sketch Algorithms
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Deploy PromSketch to optimize slow PromQL queries using sketch-based approximation. Homelab benchmar...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-11-19">
                                    November 19, 2025
                                </time>
                                <span>5 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/from-claude-in-your-terminal-to-robots-in-your-workshop-the-embodied-ai-revolution/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                From Claude in Your Terminal to Robots in Your Workshop: The Embodied AI Revolution
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Deploy Vision-Language-Action models for embodied AI robots—integrate physical world interaction wit...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-10-13">
                                    October 13, 2025
                                </time>
                                <span>8 min read</span>
                            </div>
                        </a>
                    </article>
                    
                    
                    <article class="group">
                        <a href="/posts/automated-security-scanning-pipeline-with-grype-and-osv/" class="block p-6 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200 hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100 group-hover:text-primary-600 dark:group-hover:text-primary-400 mb-2">
                                Automated Security Scanning Pipeline with Grype and OSV
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                                Build automated security scanning pipelines with Grype, OSV, and Trivy—integrate vulnerability detec...
                            </p>
                            <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
                                <time datetime="2025-10-06">
                                    October 6, 2025
                                </time>
                                <span>11 min read</span>
                            </div>
                        </a>
                    </article>
                    
                </div>
            </section>
            
            
            <footer role="contentinfo" aria-label="Site footer" class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
                <div class="flex items-center justify-between">
                    <a href="/posts/" class="inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-200">
                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        Back to all posts
                    </a>
                    
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-500 dark:text-gray-400">Share:</span>
                        
                        <!-- LinkedIn -->
                        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://williamzujkowski.github.io%2Fposts%2Fself-hosted-password-manager-migration-bitwarden-deep-dive%2F" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#0077b5] dark:hover:text-[#0077b5] transition-colors duration-200"
                           aria-label="Share on LinkedIn">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                            </svg>
                        </a>
                        
                        <!-- Hacker News -->
                        <a href="https://news.ycombinator.com/submitlink?u=https://williamzujkowski.github.io%2Fposts%2Fself-hosted-password-manager-migration-bitwarden-deep-dive%2F&t=Self-Hosted%20Password%20Manager%20Migration%3A%20Bitwarden%20Deep%20Dive" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff6600] dark:hover:text-[#ff6600] transition-colors duration-200"
                           aria-label="Share on Hacker News">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M0 0v24h24v-24h-24zm12.8 8.7l2.3-4.3h1.4l-3.1 5.5v3.5h-1.2v-3.5l-3-5.5h1.4l2.2 4.3z"/>
                            </svg>
                        </a>
                        
                        <!-- Reddit -->
                        <a href="https://reddit.com/submit?url=https://williamzujkowski.github.io%2Fposts%2Fself-hosted-password-manager-migration-bitwarden-deep-dive%2F&title=Self-Hosted%20Password%20Manager%20Migration%3A%20Bitwarden%20Deep%20Dive" 
                           target="_blank" 
                           rel="noopener noreferrer" 
                           class="text-gray-400 hover:text-[#ff4500] dark:hover:text-[#ff4500] transition-colors duration-200"
                           aria-label="Share on Reddit">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/>
                            </svg>
                        </a>
                        
                        <!-- Copy Link -->
                        <button onclick="copyToClipboard('https://williamzujkowski.github.io/posts/self-hosted-password-manager-migration-bitwarden-deep-dive/')" 
                                class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200"
                                aria-label="Copy link to clipboard">
                            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </footer>
        </div>
    </div>
</article>

<!-- Blog JavaScript Bundle (reading-progress, table-of-contents) -->
<script src="/assets/js/blog.min.js"></script>

<!-- Collapsible Code Blocks - loaded in base.njk -->
    </main>
    
    <!-- Footer -->
    <footer role="contentinfo" aria-label="Site footer" class="mt-auto border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- About -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">About</h3>
                    <p class="text-gray-600 dark:text-gray-400">
                        Personal website of William Zujkowski, exploring technology and sharing knowledge. All opinions and views expressed are my own and do not reflect those of my employer.
                    </p>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Quick Links</h3>
                    <ul class="space-y-2"><li><a href="/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Home</a></li>
<li><a href="/about/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">About</a></li>
<li><a href="/posts/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Posts</a></li>
<li><a href="/resources/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Resources</a></li>
<li><a href="/stats/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Stats</a></li>
<li><a href="/uses/" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">Uses</a></li></ul>
                </div>
                
                <!-- Connect -->
                <div>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 uppercase tracking-wider mb-4">Connect</h3>
                    <div class="flex space-x-4">
                        <a href="https://github.com/williamzujkowski" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="GitHub" rel="noopener noreferrer">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/in/williamzujkowski" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="LinkedIn" rel="noopener noreferrer">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                            </svg>
                        </a>
                        <a href="/feed.xml" class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200" aria-label="RSS Feed">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3.429 5.1v2.4c7.248 0 13.114 5.886 13.114 13.142h2.4C18.943 12.18 11.858 5.1 3.429 5.1zm0 4.8v2.4c3.924 0 7.114 3.206 7.114 7.142h2.4c0-5.256-4.276-9.542-9.514-9.542zM6.171 16.386c-.756 0-1.371.615-1.371 1.371 0 .756.615 1.371 1.371 1.371.756 0 1.371-.615 1.371-1.371 0-.756-.615-1.371-1.371-1.371z"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 pt-8 border-t border-gray-200 dark:border-gray-700">
                <p class="text-center text-sm text-gray-600 dark:text-gray-400">
                    &copy; 2025 William Zujkowski. All rights reserved.
                    Built with <a href="https://www.11ty.dev/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Eleventy</a>
                    and <a href="https://tailwindcss.com/" class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300">Tailwind CSS</a>.
                </p>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script>
        function toggleDarkMode() {
            const html = document.documentElement;
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                localStorage.theme = 'light';
                if (themeColorMeta) themeColorMeta.content = '#1e40af';
            } else {
                html.classList.add('dark');
                localStorage.theme = 'dark';
                if (themeColorMeta) themeColorMeta.content = '#111827';
            }
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Show success message
                showToast('Link copied to clipboard!');
            }, function(err) {
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-999999px";
                textArea.style.top = "-999999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('Link copied to clipboard!');
                } catch (err) {
                    showToast('Failed to copy link');
                }
                document.body.removeChild(textArea);
            });
        }
        
        function showToast(message) {
            // Create toast element
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-gray-800 dark:bg-gray-200 text-white dark:text-gray-800 px-4 py-2 rounded-lg shadow-lg transform transition-all duration-300 translate-y-full';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.classList.remove('translate-y-full');
                toast.classList.add('translate-y-0');
            }, 10);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('translate-y-0');
                toast.classList.add('translate-y-full');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }
    </script>
    
    <!-- Core JavaScript Bundle (ui-enhancements, back-to-top, code-collapse) -->
    <script src="/assets/js/core.min.js"></script>
    
    <!-- Mermaid Diagram Support -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        // Determine if dark mode is active
        const isDarkMode = document.documentElement.classList.contains('dark');
        
        // Initialize mermaid with proper settings
        mermaid.initialize({ 
            startOnLoad: false, // We'll manually init after DOM manipulation
            theme: isDarkMode ? 'dark' : 'default',
            themeVariables: isDarkMode ? {
                // Dark mode theme
                primaryColor: '#4f46e5',
                primaryTextColor: '#f3f4f6',
                primaryBorderColor: '#6366f1',
                lineColor: '#4b5563',
                secondaryColor: '#374151',
                tertiaryColor: '#1f2937',
                background: '#111827',
                mainBkg: '#1f2937',
                secondBkg: '#374151',
                tertiaryBkg: '#4b5563',
                primaryBorderColor: '#6366f1',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: true,
                nodeBkg: '#374151',
                nodeBorder: '#6366f1',
                clusterBkg: '#1f2937',
                clusterBorder: '#4b5563',
                defaultLinkColor: '#93bbfd',
                titleColor: '#f3f4f6',
                edgeLabelBackground: '#1f2937',
                actorBorder: '#6366f1',
                actorBkg: '#374151',
                actorTextColor: '#f3f4f6',
                actorLineColor: '#4b5563',
                signalColor: '#f3f4f6',
                signalTextColor: '#f3f4f6',
                labelBoxBkgColor: '#374151',
                labelBoxBorderColor: '#6366f1',
                labelTextColor: '#f3f4f6',
                loopTextColor: '#f3f4f6',
                noteBorderColor: '#6366f1',
                noteBkgColor: '#374151',
                noteTextColor: '#f3f4f6',
                activationBorderColor: '#6366f1',
                activationBkgColor: '#374151',
                sequenceNumberColor: '#111827'
            } : {
                // Light mode theme
                primaryColor: '#6366f1',
                primaryTextColor: '#fff',
                primaryBorderColor: '#4f46e5',
                lineColor: '#d1d5db',
                secondaryColor: '#e5e7eb',
                tertiaryColor: '#f3f4f6',
                background: '#ffffff',
                mainBkg: '#ffffff',
                secondBkg: '#f3f4f6',
                tertiaryBkg: '#e5e7eb',
                fontFamily: 'Inter, system-ui, sans-serif',
                fontSize: '16px',
                darkMode: false,
                nodeBkg: '#f3f4f6',
                nodeBorder: '#4f46e5',
                clusterBkg: '#e5e7eb',
                clusterBorder: '#9ca3af',
                defaultLinkColor: '#2563eb',
                titleColor: '#1f2937',
                edgeLabelBackground: '#ffffff',
                actorBorder: '#4f46e5',
                actorBkg: '#f3f4f6',
                actorTextColor: '#1f2937',
                actorLineColor: '#9ca3af',
                signalColor: '#1f2937',
                signalTextColor: '#1f2937',
                labelBoxBkgColor: '#f3f4f6',
                labelBoxBorderColor: '#4f46e5',
                labelTextColor: '#1f2937',
                loopTextColor: '#1f2937',
                noteBorderColor: '#4f46e5',
                noteBkgColor: '#f3f4f6',
                noteTextColor: '#1f2937',
                activationBorderColor: '#4f46e5',
                activationBkgColor: '#e5e7eb',
                sequenceNumberColor: '#ffffff'
            },
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
        
        // Process Mermaid diagrams and THEN initialize code-collapse
        window.addEventListener('DOMContentLoaded', async function() {
            // Step 1: Find and process all mermaid code blocks
            const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
            
            if (mermaidBlocks.length > 0) {
                // Processing Mermaid diagrams
                
                // Convert each mermaid code block to a diagram
                for (const element of mermaidBlocks) {
                    const graphDefinition = element.textContent;
                    const preElement = element.parentNode;
                    
                    // Create a container div for the mermaid diagram
                    const containerDiv = document.createElement('div');
                    containerDiv.className = 'mermaid-container';
                    containerDiv.setAttribute('data-mermaid', 'true');
                    
                    // Create the mermaid div
                    const graphDiv = document.createElement('div');
                    graphDiv.className = 'mermaid';
                    graphDiv.textContent = graphDefinition;
                    
                    // Replace the pre element with the container - this removes the code block entirely
                    preElement.parentNode.replaceChild(containerDiv, preElement);
                    containerDiv.appendChild(graphDiv);
                }
                
                // Step 2: Initialize all mermaid diagrams with error handling
                try {
                    await mermaid.run();
                    console.log(`✅ Successfully rendered ${mermaidBlocks.length} Mermaid diagram(s)`);
                } catch (error) {
                    console.error('❌ Mermaid rendering failed:', error);
                    // Log each diagram's content for debugging
                    document.querySelectorAll('.mermaid').forEach((div, index) => {
                        console.error(`Diagram ${index + 1} content:`, div.textContent);
                    });
                }

                // Diagrams are now styled via CSS, no need for inline styles
            }
            
            // Step 3: Code-collapse.js is already loaded and will handle remaining blocks
            // It checks for data-processed attribute to avoid duplicates
        });
    </script>
</body>
</html>